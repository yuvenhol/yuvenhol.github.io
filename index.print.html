<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0">
    <meta name="generator" content="Relearn 5.2.1+tip">
    <meta name="description" content="yuvenhol的技术苦旅">
    <meta name="author" content="yuvenhol">
    <title>content - yuvenhol的技术苦旅</title>
    <link href="/" rel="canonical" type="text/html" title="yuvenhol的技术苦旅">
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="yuvenhol的技术苦旅">
    <link href="/images/logo.svg?1671729343" rel="icon" type="image/svg+xml">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1671729343" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1671729343" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1671729343" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1671729343" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1671729343" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1671729343" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1671729343" rel="stylesheet">
    <link href="/css/nucleus.css?1671729343" rel="stylesheet">
    <link href="/css/fonts.css?1671729343" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1671729343" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1671729343" rel="stylesheet">
    <link href="/css/theme-relearn-light.css?1671729343" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1671729343" rel="stylesheet">
    <link href="/css/variant.css?1671729343" rel="stylesheet">
    <link href="/css/print.css?1671729343" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1671729343" rel="stylesheet">
    <script src="/js/variant.js?1671729343"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      var index_url="/index.json";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      // some further base stuff
      var baseUriFull='https:\/\/yuvenhol.github.io/';
      window.variants && variants.init( [ 'relearn-light', 'relearn-dark', 'learn', 'neon', 'blue', 'green', 'red' ] );
    </script>
    <script src="/js/jquery.min.js?1671729343" defer></script>
  </head>
  <body class="mobile-support print" data-url="/">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div class="navigation">
             <a class="nav nav-next" href="/dockerk8s/" title="docker&amp;k8s (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
             <span class="nav nav-prev"><i class="fa fa-chevron-left fa-fw"></i></span>
          </div>
          <div id="top-print-link">
            <a class="print-link" title='Print whole chapter (CTRL+ALT+p)' href="/index.print.html">
              <i class="fas fa-print fa-fw"></i>
            </a>
          </div>
          <div id="top-github-link">
            <a class="github-link" title='Edit (CTRL+ALT+e)' href="https://github.com/McShelby/hugo-theme-relearn/edit/main/exampleSite/content//_index.md" target="blank">
              <i class="fas fa-pen fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+m)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <meta itemprop="itemListOrder" content="Descending" />
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="1" /><a itemprop="item" href="/" aria-disabled="true"><span itemprop="name">content</span></a></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable home" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="home deprecated">


            <footer class="footline">
            </footer>
          </article>

              <section>
          <article class="default">
<h1>docker&amp;k8s</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>docker compose</h1>

<h2 id="简介">简介</h2>
<p>docker compose用于更加方便的管理docker容器，采用yml文件配置的方式代替，敲入docker命令，配置时更加清晰，也更适合多个节点配置。</p>
<p>hub.docker.com</p>
<h2 id="配置文件编写">配置文件编写</h2>
<p>stdin_open 保持标准输入，如果容器没有启动</p>
<h2 id="网络配置">网络配置</h2>
<h2 id="四类网络模式">四类网络模式</h2>
<p>Docker网络模式</p>
<p>配置</p>
<p>说明</p>
<p>host模式</p>
<p>–net=host</p>
<p>容器和宿主机共享Network namespace。</p>
<p>container模式</p>
<p>–net=container:NAME_or_ID</p>
<p>容器和另外一个容器共享Network namespace。 kubernetes中的pod就是多个容器共享一个Network namespace。</p>
<p>none模式</p>
<p>–net=none</p>
<p>容器有独立的Network namespace，但并没有对其进行任何网络设置，如分配veth pair 和网桥连接，配置IP等。</p>
<p>bridge模式</p>
<p>–net=bridge</p>
<p>（默认为该模式）</p>
<h3 id="host模式"><strong>host模式</strong></h3>
<p>如果启动容器的时候使用host模式，那么这个容器将不会获得一个独立的Network Namespace，而是和宿主机共用一个Network Namespace。容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。但是，容器的其他方面，如文件系统、进程列表等还是和宿主机隔离的。</p>
<p>使用host模式的容器可以直接使用宿主机的IP地址与外界通信，容器内部的服务端口也可以使用宿主机的端口，不需要进行NAT，host最大的优势就是网络性能比较好，但是docker host上已经使用的端口就不能再用了，网络的隔离性不好。</p>
<p>Host模式如下图所示：</p>
<p><img src="https://img.php.cn/upload/image/910/346/344/1637831714892342.png" alt="1.png" title="1637831714892342.png"></p>
<h3 id="container模式"><strong>container模式</strong></h3>
<p>这个模式指定新创建的容器和已经存在的一个容器共享一个 Network Namespace，而不是和宿主机共享。新创建的容器不会创建自己的网卡，配置自己的 IP，而是和一个指定的容器共享 IP、端口范围等。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。两个容器的进程可以通过 lo 网卡设备通信。</p>
<p>Container模式示意图：</p>
<p><img src="https://img.php.cn/upload/image/416/947/522/1637831720297867.png" alt="2.png" title="1637831720297867.png"></p>
<h3 id="none模式"><strong>none模式</strong></h3>
<p>使用none模式，Docker容器拥有自己的Network Namespace，但是，并不为Docker容器进行任何网络配置。也就是说，这个Docker容器没有网卡、IP、路由等信息。需要我们自己为Docker容器添加网卡、配置IP等。</p>
<p>这种网络模式下容器只有lo回环网络，没有其他网卡。none模式可以在容器创建时通过&ndash;network=none来指定。这种类型的网络没有办法联网，封闭的网络能很好的保证容器的安全性。</p>
<p>None模式示意图:</p>
<p><img src="https://img.php.cn/upload/image/810/838/167/1637831725992246.png" alt="3.png" title="1637831725992246.png"></p>
<h3 id="bridge模式"><strong>bridge模式</strong></h3>
<p>当Docker进程启动时，会在主机上创建一个名为docker0的虚拟网桥，此主机上启动的Docker容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中。</p>
<p>从docker0子网中分配一个IP给容器使用，并设置docker0的IP地址为容器的默认网关。在主机上创建一对虚拟网卡veth pair设备，Docker将veth pair设备的一端放在新创建的容器中，并命名为eth0（容器的网卡），另一端放在主机中，以vethxxx这样类似的名字命名，并将这个网络设备加入到docker0网桥中。可以通过brctl show命令查看。</p>
<p>bridge模式是docker的默认网络模式，不写&ndash;net参数，就是bridge模式。使用docker run -p时，docker实际是在iptables做了DNAT规则，实现端口转发功能。可以使用iptables -t nat -vnL查看。</p>
<p>bridge模式如下图所示：</p>
<p><img src="https://img.php.cn/upload/image/348/343/912/1637831739705649.png" alt="4.png" title="1637831739705649.png"></p>
<h2 id="示例">示例</h2>
<h3 id="rocketmq-cluster">rocketmq cluster</h3>
<p>注意docker要容器直接访问端口必须加ports，可以不指定宿主机端口，但是必须指定容器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.8&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namesrv1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">namesrv1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqnamesrv&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namesrv2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">namesrv2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqnamesrv&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namesrv3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">namesrv3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqnamesrv&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">broker1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">broker1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqbroker&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10911</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10909</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10912</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NAMESRV_ADDR=namesrv1:9876;namesrv2:9876;namesrv3:9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">broker2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">broker2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqbroker&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10911</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10909</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10912</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NAMESRV_ADDR=namesrv1:9876;namesrv2:9876;namesrv3:9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">broker3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">broker3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/home/rocketmq/rocketmq-4.9.4/bin/mqbroker&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10911</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10909</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">10912</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NAMESRV_ADDR=namesrv1:9876;namesrv2:9876;namesrv3:9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">test</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">apache/rocketmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NAMESRV_ADDR=namesrv1:9876;namesrv2:9876;namesrv3:9876</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">stdin_open</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>docker基础知识</h1>

<h1 id="docker">Docker</h1>
<ul>
<li>
<p>官方文档地址:<a href="https://www.docker.com/get-started" title="https://www.docker.com/get-started">https://www.docker.com/get-started</a></p>
</li>
<li>
<p>中文参考手册:https://docker_practice.gitee.io/zh-cn/</p>
</li>
</ul>
<hr>
<h2 id="1什么是-docker">1.什么是 Docker</h2>
<h3 id="11-官方定义">1.1 官方定义</h3>
<ul>
<li>最新官网首页</li>
</ul>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20201220213306128.png" alt=""></p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20201220214210994.png" alt="image-20201220214210994"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.官方介绍
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> We have a complete container solution for you - no matter who you are and where you are on your containerization journey.
</span></span><span class="line"><span class="cl"><span class="k">-</span> 翻译: 我们为你提供了一个完整的容器解决方案,不管你是谁,不管你在哪,你都可以开始容器的的旅程。
</span></span><span class="line"><span class="cl"><span class="k">-</span> 官方定义: docker是一个容器技术。
</span></span></code></pre></div><h3 id="12-docker的起源">1.2 Docker的起源</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">Docker 最初是 dotCloud 公司创始人 Solomon Hykes 在法国期间发起的一个公司内部项目，它是基于 dotCloud 公司多年云服务技术的一次革新，并于 2013 年 3 月以 Apache 2.0 授权协议开源，主要项目代码在 GitHub 上进行维护。Docker 项目后来还加入了 Linux 基金会，并成立推动 开放容器联盟（OCI）。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Docker 自开源后受到广泛的关注和讨论，至今其 GitHub 项目 已经超过 5 万 7 千个星标和一万多个 fork。甚至由于 Docker 项目的火爆，在 2013 年底，dotCloud 公司决定改名为 Docker。Docker 最初是在 Ubuntu 12.04 上开发实现的；Red Hat 则从 RHEL 6.5 开始对 Docker 进行支持；Google 也在其 PaaS 产品中广泛应用 Docker。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Docker 使用 Google 公司推出的 Go 语言 进行开发实现，基于 Linux 内核的 cgroup，namespace，以及 OverlayFS 类的 Union FS 等技术，对进程进行封装隔离，属于操作系统层面的虚拟化技术。由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。
</span></span></code></pre></div><h2 id="2为什么是docker">2.为什么是Docker</h2>
<ul>
<li>
<p><code>在开发的时候，在本机测试环境可以跑，生产环境跑不起来</code></p>
<p>这里我们拿java Web应用程序举例，我们一个java Web应用程序涉及很多东西，比如jdk、tomcat、mysql等软件环境。当这些其中某一项版本不一致的时候，可能就会导致应用程序跑不起来这种情况。Docker则将程序以及使用软件环境直接打包在一起，无论在那个机器上保证了环境一致。</p>
<p><strong>优势1: 一致的运行环境,更轻松的迁移</strong></p>
</li>
<li>
<p><code>服务器自己的程序挂了，结果发现是别人程序出了问题把内存吃完了，自己程序因为内存不够就挂了</code></p>
<p>这种也是一种比较常见的情况，如果你的程序重要性不是特别高的话，公司基本上不可能让你的程序独享一台服务器的，这时候你的服务器就会跟公司其他人的程序共享一台服务器，所以不可避免地就会受到其他程序的干扰，导致自己的程序出现问题。Docker就很好解决了环境隔离的问题，别人程序不会影响到自己的程序。</p>
<p><strong>优势2：对进程进行封装隔离,容器与容器之间互不影响,更高效的利用系统资源</strong></p>
</li>
<li>
<p><code>公司要弄一个活动，可能会有大量的流量进来，公司需要再多部署几十台服务器</code></p>
<p>在没有Docker的情况下，要在几天内部署几十台服务器，这对运维来说是一件非常折磨人的事，而且每台服务器的环境还不一定一样，就会出现各种问题，最后部署地头皮发麻。用Docker的话，我只需要将程序打包到镜像，你要多少台服务，我就给力跑多少容器，极大地提高了部署效率。</p>
<p><strong>优势3: 通过镜像复制N多个环境一致容器</strong></p>
</li>
</ul>
<hr>
<h2 id="3docker和虚拟机区别">3.Docker和虚拟机区别</h2>
<blockquote>
<p>关于Docker与虚拟机的区别，我在网上找到的一张图，非常直观形象地展示出来，话不多说，直接上图。</p>
</blockquote>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20201220222456675.png" alt="image-20201220222456675"></p>
<p><code>比较上面两张图，我们发现虚拟机是携带操作系统，本身很小的应用程序却因为携带了操作系统而变得非常大，很笨重</code>。Docker是不携带操作系统的，所以Docker的应用就非常的轻巧。另外在调用宿主机的CPU、磁盘等等这些资源的时候，拿内存举例，虚拟机是利用Hypervisor去虚拟化内存，整个调用过程是虚拟内存-&gt;虚拟物理内存-&gt;真正物理内存，但是Docker是利用Docker Engine去调用宿主的的资源，这时候过程是虚拟内存-&gt;真正物理内存。</p>
<p>传统虚拟机</p>
<p>Docker容器</p>
<p>磁盘占用</p>
<p>几个GB到几十个GB左右</p>
<p>几十MB到几百MB左右</p>
<p>CPU内存占用</p>
<p>虚拟操作系统非常占用CPU和内存</p>
<p>Docker引擎占用极低</p>
<p>启动速度</p>
<p>（从开机到运行项目）几分钟</p>
<p>（从开启容器到运行项目）几秒</p>
<p>安装管理</p>
<p>需要专门的运维技术</p>
<p>安装、管理方便</p>
<p>应用部署</p>
<p>每次部署都费时费力</p>
<p>从第二次部署开始轻松简捷</p>
<p>耦合性</p>
<p>多个应用服务安装到一起，容易互相影响</p>
<p>每个应用服务一个容器，达成隔离</p>
<p>系统依赖</p>
<p>无</p>
<p>需求相同或相似的内核，目前推荐是Linux</p>
<hr>
<h2 id="4docker的安装">4.Docker的安装</h2>
<h3 id="41-安装dockercentos7x">4.1 安装docker(centos7.x)</h3>
<ul>
<li>
<p>卸载原始docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ sudo yum remove docker <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-client <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-client-latest <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-common <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-latest <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-latest-logrotate <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-logrotate <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  docker-engine
</span></span></code></pre></div></li>
<li>
<p>安装docker依赖</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ sudo yum install -y yum-utils <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  device-mapper-persistent-data <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  lvm2
</span></span></code></pre></div></li>
<li>
<p>设置docker的yum源</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo yum-config-manager <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --add-repo <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    https://download.docker.com/linux/centos/docker-ce.repo
</span></span></code></pre></div></li>
<li>
<p>安装最新版的docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo yum install docker-ce docker-ce-cli containerd.io
</span></span></code></pre></div></li>
<li>
<p>指定版本安装docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ yum list docker-ce --showduplicates <span class="p">|</span> sort -r
</span></span><span class="line"><span class="cl">$ sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io
</span></span><span class="line"><span class="cl">$ sudo yum install docker-ce-18.09.5-3.el7 docker-ce-cli-18.09.5-3.el7 containerd.io
</span></span></code></pre></div></li>
<li>
<p>启动docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo systemctl <span class="nb">enable</span> docker
</span></span><span class="line"><span class="cl">$ sudo systemctl start docker
</span></span></code></pre></div></li>
<li>
<p>关闭docker</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo systemctl stop docker
</span></span></code></pre></div><ul>
<li>
<p>测试docker安装</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo docker run hello-world
</span></span></code></pre></div></li>
</ul>
<h3 id="42-bash安装通用所有平台">4.2 bash安装(通用所有平台)</h3>
<ul>
<li>
<p>在测试或开发环境中 Docker 官方为了简化安装流程，提供了一套便捷的安装脚本，CentOS 系统上可以使用这套脚本安装，另外可以通过 <code>--mirror</code> 选项使用国内源进行安装：执行这个命令后，脚本就会自动的将一切准备工作做好，并且把 Docker 的稳定(stable)版本安装在系统中。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -fsSL get.docker.com -o get-docker.sh
</span></span><span class="line"><span class="cl">$ sudo sh get-docker.sh --mirror Aliyun
</span></span></code></pre></div></li>
<li>
<p>启动docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo systemctl <span class="nb">enable</span> docker
</span></span><span class="line"><span class="cl">$ sudo systemctl start docker
</span></span></code></pre></div></li>
<li>
<p>创建docker用户组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo groupadd docker
</span></span></code></pre></div></li>
<li>
<p>将当前用户加入docker组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo usermod -aG docker <span class="nv">$USER</span>
</span></span></code></pre></div></li>
<li>
<p>测试docker安装是否正确</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run hello-world
</span></span></code></pre></div></li>
</ul>
<h2 id="5docker-的核心架构">5.Docker 的核心架构</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200404111908085-0291323.png" alt="image-20200404111908085"></p>
<ul>
<li><code>镜像:</code> 一个镜像代表一个应用环境,他是一个只读的文件,如 mysql镜像,tomcat镜像,nginx镜像等</li>
<li><code>容器:</code> 镜像每次运行之后就是产生一个容器,就是正在运行的镜像,特点就是可读可写</li>
<li><code>仓库:</code>用来存放镜像的位置,类似于maven仓库,也是镜像下载和上传的位置</li>
<li><code>dockerFile:</code>docker生成镜像配置文件,用来书写自定义镜像的一些配置</li>
<li><code>tar:</code>一个对镜像打包的文件,日后可以还原成镜像</li>
</ul>
<h2 id="6-docker-配置阿里镜像加速服务">6. Docker 配置阿里镜像加速服务</h2>
<h3 id="61-docker-运行流程">6.1 docker 运行流程</h3>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200404120356784.png" alt="image-20200404120356784"></p>
<h3 id="62-docker配置阿里云镜像加速">6.2 docker配置阿里云镜像加速</h3>
<ul>
<li><code>访问阿里云登录自己账号查看docker镜像加速服务</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo mkdir -p /etc/docker
</span></span><span class="line"><span class="cl">sudo tee /etc/docker/daemon.json <span class="s">&lt;&lt;-&#39;EOF&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">{
</span></span></span><span class="line"><span class="cl"><span class="s">  &#34;registry-mirrors&#34;: [&#34;https://lz2nib3q.mirror.aliyuncs.com&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">sudo systemctl daemon-reload
</span></span><span class="line"><span class="cl">sudo systemctl restart docker
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">  <span class="s2">&#34;registry-mirrors&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;https://m910xfnq.mirror.aliyuncs.com&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span></code></pre></div><ul>
<li><code>验证docker的镜像加速是否生效</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># docker info</span>
</span></span><span class="line"><span class="cl">		..........
</span></span><span class="line"><span class="cl">    127.0.0.0/8
</span></span><span class="line"><span class="cl">   Registry Mirrors:
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;https://lz2nib3q.mirror.aliyuncs.com/&#39;</span>
</span></span><span class="line"><span class="cl">   Live Restore Enabled: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">   Product License: Community Engine
</span></span></code></pre></div><hr>
<h2 id="7docker的入门应用">7.Docker的入门应用</h2>
<h3 id="71-docker-的第一个程序">7.1 docker 的第一个程序</h3>
<blockquote>
<p>docker run hello-world</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># docker run hello-world</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hello from Docker!
</span></span><span class="line"><span class="cl">This message shows that your installation appears to be working correctly.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To generate this message, Docker took the following steps:
</span></span><span class="line"><span class="cl"> 1. The Docker client contacted the Docker daemon.
</span></span><span class="line"><span class="cl"> 2. The Docker daemon pulled the <span class="s2">&#34;hello-world&#34;</span> image from the Docker Hub.
</span></span><span class="line"><span class="cl">    <span class="o">(</span>amd64<span class="o">)</span>
</span></span><span class="line"><span class="cl"> 3. The Docker daemon created a new container from that image which runs the
</span></span><span class="line"><span class="cl">    executable that produces the output you are currently reading.
</span></span><span class="line"><span class="cl"> 4. The Docker daemon streamed that output to the Docker client, which sent it
</span></span><span class="line"><span class="cl">    to your terminal.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To try something more ambitious, you can run an Ubuntu container with:
</span></span><span class="line"><span class="cl"> $ docker run -it ubuntu bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Share images, automate workflows, and more with a free Docker ID:
</span></span><span class="line"><span class="cl"> https://hub.docker.com/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For more examples and ideas, visit:
</span></span><span class="line"><span class="cl"> https://docs.docker.com/get-started/
</span></span></code></pre></div><hr>
<h2 id="8常用命令">8.常用命令</h2>
<h3 id="61-辅助命令">6.1 辅助命令</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.安装完成辅助命令
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker version	--------------------------	查看docker的信息
</span></span><span class="line"><span class="cl">		docker info		--------------------------	查看更详细的信息
</span></span><span class="line"><span class="cl">		docker --help	--------------------------	帮助命令
</span></span></code></pre></div><h3 id="62-images-镜像命令">6.2 Images 镜像命令</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.查看本机中所有镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker images	--------------------------	列出本地所有镜像
</span></span><span class="line"><span class="cl">		-a			列出所有镜像（包含中间映像层）
</span></span><span class="line"><span class="cl">  	-q			只显示镜像id
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.搜索镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker search [options] 镜像名	-------------------	去dockerhub上查询当前镜像
</span></span><span class="line"><span class="cl">		-s 指定值		列出收藏数不少于指定值的镜像
</span></span><span class="line"><span class="cl">  	--no-trunc	  显示完整的镜像信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.从仓库下载镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull 镜像名[:TAG|@DIGEST]	----------------- 下载镜像
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.删除镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker rmi 镜像名	--------------------------  删除镜像
</span></span><span class="line"><span class="cl">		-f		强制删除
</span></span><span class="line"><span class="cl"><span class="gh"># 5.查看镜像历史（ex docker file）
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker history 镜像名
</span></span></code></pre></div><h3 id="63-contrainer-容器命令">6.3 Contrainer 容器命令</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.运行容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run 镜像名	--------------------------	镜像名新建并启动容器
</span></span><span class="line"><span class="cl">    --name 					别名为容器起一个名字
</span></span><span class="line"><span class="cl">    -d							启动守护式容器（在后台启动容器）
</span></span><span class="line"><span class="cl">    -p 							映射端口号：原始端口号		 指定端口号启动
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	例：docker run -it --name myTomcat -p 8888:8080 tomcat
</span></span><span class="line"><span class="cl">   	 docker run -d --name myTomcat -P tomcat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.查看运行的容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker ps					--------------------------	列出所有正在运行的容器
</span></span><span class="line"><span class="cl">	-a			正在运行的和历史运行过的容器
</span></span><span class="line"><span class="cl">	-q			静默模式，只显示容器编号
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.停止|关闭|重启容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker start   容器名字或者容器id  --------------- 开启容器
</span></span><span class="line"><span class="cl">	docker restart 容器名或者容器id    --------------- 重启容器
</span></span><span class="line"><span class="cl">	docker stop  容器名或者容器id 	    ------------------ 正常停止容器运行
</span></span><span class="line"><span class="cl">	docker kill  容器名或者容器id      ------------------ 立即停止容器运行
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.删除容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker rm -f 容器id和容器名     
</span></span><span class="line"><span class="cl">	docker rm -f $(docker ps -aq)		--------------------------	删除所有容器
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.查看容器内进程
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker top 容器id或者容器名 ------------------ 查看容器内的进程
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 6.查看查看容器内部细节
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker inspect 容器id 		------------------ 查看容器内部细节
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 7.查看容器的运行日志
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker logs [OPTIONS] 容器id或容器名	------------------ 查看容器日志
</span></span><span class="line"><span class="cl">    -t			 加入时间戳
</span></span><span class="line"><span class="cl">    -f			 跟随最新的日志打印
</span></span><span class="line"><span class="cl">    --tail 	 数字	显示最后多少条
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 8.进入容器内部
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec [options] 容器id 容器内命令 ------------------ 进入容器执行命令
</span></span><span class="line"><span class="cl">		-i		以交互模式运行容器，通常与-t一起使用
</span></span><span class="line"><span class="cl">    -t		分配一个伪终端    shell窗口   bash 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 9.容器和宿主机之间复制文件
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker cp 文件|目录 容器id:容器路径           -----------------   将宿主机复制到容器内部
</span></span><span class="line"><span class="cl">	docker cp 容器id:容器内资源路径 宿主机目录路径  -----------------   将容器内资源拷贝到主机上
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 10.数据卷(volum)实现与宿主机共享目录
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -v 宿主机的路径|任意别名:/容器内的路径 镜像名
</span></span><span class="line"><span class="cl">		注意: 
</span></span><span class="line"><span class="cl">				1.如果是宿主机路径必须是绝对路径,宿主机目录会覆盖容器内目录内容
</span></span><span class="line"><span class="cl">				2.如果是别名则会在docker运行容器时自动在宿主机中创建一个目录,并将容器目录文件复制到宿主机中
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 11.打包镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker save 镜像名 -o  名称.tar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 12.载入镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker load -i   名称.tar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 13.容器打包成新的镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	  docker commit -m &#34;描述信息&#34; -a &#34;作者信息&#34;   （容器id或者名称）打包的镜像名称:标签
</span></span></code></pre></div><hr>
<h2 id="7docker的镜像原理">7.docker的镜像原理</h2>
<h3 id="71-镜像是什么">7.1 镜像是什么？</h3>
<blockquote>
<p>镜像是一种轻量级的，可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时所需的库、环境变量和配置文件。</p>
</blockquote>
<h3 id="72-为什么一个镜像会那么大">7.2 为什么一个镜像会那么大？</h3>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200404142950068.png" alt="image-20200404142950068"></p>
<p><code>镜像就是花卷</code></p>
<ul>
<li>
<p>UnionFS（联合文件系统）:</p>
<p>Union文件系统是一种分层，轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。Union文件系统是Docker镜像的基础。这种文件系统特性:就是一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录 。</p>
</li>
</ul>
<h3 id="73-docker镜像原理">7.3 Docker镜像原理</h3>
<blockquote>
<p><code>docker的镜像实际是由一层一层的文件系统组成。</code></p>
</blockquote>
<ul>
<li>
<p>bootfs（boot file system）主要包含bootloader和kernel，bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统。在docker镜像的最底层就是bootfs。这一层与Linux/Unix 系统是一样的，包含boot加载器（bootloader）和内核（kernel）。当boot加载完,后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时会卸载bootfs。</p>
</li>
<li>
<p>rootfs（root file system），在bootfs之上，包含的就是典型的linux系统中的/dev，/proc，/bin，/etc等标准的目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu/CentOS等等。</p>
</li>
<li>
<p>我们平时安装进虚拟机的centos都有1到几个GB，为什么docker这里才200MB？对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令，工具，和程序库就可以了，因为底层直接使用Host的Kernal，自己只需要提供rootfs就行了。由此可见不同的linux发行版，他们的bootfs是一致的，rootfs会有差别。因此不同的发行版可以共用bootfs。</p>
</li>
</ul>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/1567585172(1).jpg" alt=""></p>
<h3 id="74-为什么docker镜像要采用这种分层结构呢">7.4 为什么docker镜像要采用这种分层结构呢?</h3>
<blockquote>
<p><code>最大的一个好处就是资源共享</code></p>
</blockquote>
<ul>
<li>比如：有多个镜像都是从相同的base镜像构建而来的，那么宿主机只需在磁盘中保存一份base镜像。同时内存中也只需要加载一份base镜像，就可以为所有容器服务了。而且镜像的每一层都可以被共享。Docker镜像都是只读的。当容器启动时，一个新的可写层被加载到镜像的顶部。这一层通常被称为容器层，容器层之下都叫镜像层。</li>
</ul>
<hr>
<h2 id="8docker安装常用服务">8.Docker安装常用服务</h2>
<h3 id="81-安装mysql">8.1 安装mysql</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.拉取mysql镜像到本地
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull mysql:tag (tag不加默认最新版本)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="gh"># 2.运行mysql服务
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:tag  						  --没有暴露外部端口外部不能连接
</span></span><span class="line"><span class="cl">	docker run --name mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d  mysql:tag  --没有暴露外部端口
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.进入mysql容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec -it 容器名称|容器id bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.外部查看mysql日志
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker logs 容器名称|容器id
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.使用自定义配置参数
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -d mysql:tag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 6.将容器数据位置与宿主机位置挂载保证数据安全
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name mysql -v /root/mysql/data:/var/lib/mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:tag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 7.通过其他客户端访问 如在window系统|macos系统使用客户端工具访问
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	
</span></span><span class="line"><span class="cl"><span class="gh"># 8.将mysql数据库备份为sql文件
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec mysql|容器id sh -c &#39;exec mysqldump --all-databases -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出全部数据
</span></span><span class="line"><span class="cl">	docker exec mysql sh -c &#39;exec mysqldump --databases 库表 -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出指定库数据
</span></span><span class="line"><span class="cl">	docker exec mysql sh -c &#39;exec mysqldump --no-data --databases 库表 -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出指定库数据不要数据
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 9.执行sql文件到mysql中
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec -i mysql sh -c &#39;exec mysql -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; <span class="err">&lt;</span> /root/xxx.sql
</span></span></code></pre></div><h3 id="82-安装redis服务">8.2 安装Redis服务</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.在docker hub搜索redis镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker search redis
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.拉取redis镜像到本地
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull redis
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.启动redis服务运行容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name redis -d redis:tag (没有暴露外部端口)
</span></span><span class="line"><span class="cl">	docker run --name redis -p 6379:6379 -d redis:tag (暴露外部宿主机端口为6379进行连接) 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.查看启动日志
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker logs -t -f 容器id|容器名称
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.进入容器内部查看
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec -it 容器id|名称 bash  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 6.加载外部自定义配置启动redis容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	默认情况下redis官方镜像中没有redis.conf配置文件 需要去官网下载指定版本的配置文件
</span></span><span class="line"><span class="cl">	<span class="k">1.</span> wget http://download.redis.io/releases/redis-5.0.8.tar.gz  下载官方安装包
</span></span><span class="line"><span class="cl">	<span class="k">2.</span> 将官方安装包中配置文件进行复制到宿主机指定目录中如 /root/redis/redis.conf文件
</span></span><span class="line"><span class="cl">	<span class="k">3.</span> 修改需要自定义的配置
</span></span><span class="line"><span class="cl">		 bind 0.0.0.0 开启远程权限
</span></span><span class="line"><span class="cl">		 appenonly yes 开启aof持久化
</span></span><span class="line"><span class="cl">	<span class="k">4.</span> 加载配置启动
</span></span><span class="line"><span class="cl">	docker run --name redis -v /root/redis:/usr/local/etc/redis -p 6379:6379 -d redis redis-server /usr/local/etc/redis/redis.conf  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 7.将数据目录挂在到本地保证数据安全
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name redis -v /root/redis/data:/data -v /root/redis/redis.conf:/usr/local/etc/redis/redis.conf -p 6379:6379 -d redis redis-server 					/usr/local/etc/redis/redis.conf  
</span></span></code></pre></div><h3 id="83-安装nginx">8.3 安装Nginx</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.在docker hub搜索nginx
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker search nginx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.拉取nginx镜像到本地
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	[root@localhost ~]# docker pull nginx
</span></span><span class="line"><span class="cl">    Using default tag: latest
</span></span><span class="line"><span class="cl">    latest: Pulling from library/nginx
</span></span><span class="line"><span class="cl">    afb6ec6fdc1c: Pull complete 
</span></span><span class="line"><span class="cl">    b90c53a0b692: Pull complete 
</span></span><span class="line"><span class="cl">    11fa52a0fdc0: Pull complete 
</span></span><span class="line"><span class="cl">    Digest: sha256:30dfa439718a17baafefadf16c5e7c9d0a1cde97b4fd84f63b69e13513be7097
</span></span><span class="line"><span class="cl">    Status: Downloaded newer image for nginx:latest
</span></span><span class="line"><span class="cl">    docker.io/library/nginx:latest
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.启动nginx容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker run -p 80:80 --name nginx01 -d nginx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.进入容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker exec -it nginx01 /bin/bash
</span></span><span class="line"><span class="cl">		查找目录:  whereis nginx
</span></span><span class="line"><span class="cl">		配置文件:  /etc/nginx/nginx.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.复制配置文件到宿主机
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker cp nginx01(容器id|容器名称):/etc/nginx/nginx.conf 宿主机名录
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 6.挂在nginx配置以及html到宿主机外部
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>		docker run --name nginx02 -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/html:/usr/share/nginx/html -p 80:80 -d nginx		
</span></span></code></pre></div><hr>
<h3 id="84-安装tomcat">8.4 安装Tomcat</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.在docker hub搜索tomcat
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker search tomcat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.下载tomcat镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull tomcat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.运行tomcat镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -p 8080:8080 -d --name mytomcat tomcat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.进入tomcat容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec -it mytomcat /bin/bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.将webapps目录挂载在外部
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -p 8080:8080 -v /root/webapps:/usr/local/tomcat/webapps -d --name mytomcat tomcat
</span></span></code></pre></div><hr>
<h3 id="85-安装mongodb数据库">8.5 安装MongoDB数据库</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.运行mongDB
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -d -p 27017:27017 --name mymongo mongo  ---无须权限
</span></span><span class="line"><span class="cl">	docker logs -f mymongo --查看mongo运行日志
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.进入mongodb容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker exec -it mymongo /bin/bash
</span></span><span class="line"><span class="cl">		直接执行mongo命令进行操作
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.常见具有权限的容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run --name  mymongo  -p 27017:27017  -d mongo --auth
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.进入容器配置用户名密码
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	mongo
</span></span><span class="line"><span class="cl">	use admin 选择admin库
</span></span><span class="line"><span class="cl">	db.createUser({user:&#34;root&#34;,pwd:&#34;root&#34;,roles:[{role:&#39;root&#39;,db:&#39;admin&#39;}]})   //创建用户,此用户创建成功,则后续操作都需要用户认证
</span></span><span class="line"><span class="cl">	exit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 5.将mongoDB中数据目录映射到宿主机中
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -d -p 27017:27017 -v /root/mongo/data:/data/db --name mymongo mongo 
</span></span></code></pre></div><h3 id="86-安装elasticsearch">8.6 安装ElasticSearch</h3>
<ul>
<li><code>注意:</code><strong>调高JVM线程数限制数量</strong></li>
</ul>
<h4 id="0拉取镜像运行elasticsearch">0.拉取镜像运行elasticsearch</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.dockerhub 拉取镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull elasticsearch:6.4.2
</span></span><span class="line"><span class="cl"><span class="gh"># 2.查看docker镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker images
</span></span><span class="line"><span class="cl"><span class="gh"># 3.运行docker镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -p 9200:9200 -p 9300:9300 elasticsearch:6.4.2
</span></span></code></pre></div><ul>
<li>启动出现如下错误</li>
<li><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200602184321790.png" alt="image-20200602184321790"></li>
</ul>
<h4 id="1-预先配置">1. 预先配置</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.在centos虚拟机中，修改配置sysctl.conf
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	vim /etc/sysctl.conf
</span></span><span class="line"><span class="cl"><span class="gh"># 2.加入如下配置
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	vm.max_map_count=262144 
</span></span><span class="line"><span class="cl"><span class="gh"># 3.启用配置
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	sysctl -p
</span></span><span class="line"><span class="cl">	注：这一步是为了防止启动容器时，报出如下错误：
</span></span><span class="line"><span class="cl">	bootstrap checks failed max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144]
</span></span></code></pre></div><h4 id="2启动eleasticsearch容器">2.启动EleasticSearch容器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 0.复制容器中data目录到宿主机中
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker cp 容器id:/usr/share/share/elasticsearch/data /root/es
</span></span><span class="line"><span class="cl"><span class="gh"># 1.运行ES容器 指定jvm内存大小并指定ik分词器位置
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -d --name es -p 9200:9200 -p 9300:9300 -e ES_JAVA_OPTS=&#34;-Xms128m -Xmx128m&#34; -v /root/es/plugins:/usr/share/elasticsearch/plugins -v /root/es/data:/usr/share/elasticsearch/data elasticsearch:6.4.2
</span></span></code></pre></div><h4 id="3安装ik分词器">3.安装IK分词器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.下载对应版本的IK分词器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	wget https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.4.2/elasticsearch-analysis-ik-6.4.2.zip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.解压到plugins文件夹中
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	yum install -y unzip
</span></span><span class="line"><span class="cl">	unzip -d ik elasticsearch-analysis-ik-6.4.2.zip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 3.添加自定义扩展词和停用词
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	cd plugins/elasticsearch/config
</span></span><span class="line"><span class="cl">	vim IKAnalyzer.cfg.xml
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">properties</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="p">&lt;</span><span class="nt">comment</span><span class="p">&gt;</span>IK Analyzer 扩展配置<span class="p">&lt;/</span><span class="nt">comment</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!--用户可以在这里配置自己的扩展字典 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="p">&lt;</span><span class="nt">entry</span> <span class="na">key</span><span class="o">=</span><span class="s">&#34;ext_dict&#34;</span><span class="p">&gt;</span>ext_dict.dic<span class="p">&lt;/</span><span class="nt">entry</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!--用户可以在这里配置自己的扩展停止词字典--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="p">&lt;</span><span class="nt">entry</span> <span class="na">key</span><span class="o">=</span><span class="s">&#34;ext_stopwords&#34;</span><span class="p">&gt;</span>ext_stopwords.dic<span class="p">&lt;/</span><span class="nt">entry</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;/</span><span class="nt">properties</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 4.在ik分词器目录下config目录中创建ext_dict.dic文件   编码一定要为UTF-8才能生效
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	vim ext_dict.dic 加入扩展词即可
</span></span><span class="line"><span class="cl"><span class="gh"># 5. 在ik分词器目录下config目录中创建ext_stopword.dic文件 
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	vim ext_stopwords.dic 加入停用词即可
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 6.重启容器生效
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker restart 容器id
</span></span><span class="line"><span class="cl"><span class="gh"># 7.将此容器提交成为一个新的镜像
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker commit -a=&#34;xiaochen&#34; -m=&#34;es with IKAnalyzer&#34; 容器id xiaochen/elasticsearch:6.4.2
</span></span></code></pre></div><h4 id="4-安装kibana">4. 安装Kibana</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.下载kibana镜像到本地
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker pull kibana:6.4.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># 2.启动kibana容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	docker run -d --name kibana -e ELASTICSEARCH_URL=http://10.15.0.3:9200 -p 5601:5601 kibana:6.4.2
</span></span></code></pre></div><hr>
<h2 id="10docker中出现如下错误解决方案">10.Docker中出现如下错误解决方案</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="p">~]</span><span class="c"># docker search mysql 或者 docker pull 这些命令无法使用</span>
</span></span><span class="line"><span class="cl"><span class="n">Error</span> <span class="n">response</span> <span class="n">from</span> <span class="n">daemon</span><span class="err">:</span> <span class="n">Get</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">index</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">v1</span><span class="p">/</span><span class="n">search</span><span class="k">?</span><span class="n">q</span><span class="p">=</span><span class="n">mysql</span><span class="p">&amp;</span><span class="n">n</span><span class="p">=</span><span class="n">25</span><span class="err">:</span> <span class="n">x509</span><span class="err">:</span> <span class="n">certificate</span> <span class="n">has</span> <span class="n">expired</span> <span class="n">or</span> <span class="n">is</span> <span class="n">not</span> <span class="n">yet</span> <span class="n">valid</span>
</span></span></code></pre></div><p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200602183429286.png" alt="image-20200602183429286"></p>
<ul>
<li>注意:<strong>这个错误的原因在于是系统的时间和docker hub时间不一致,需要做系统时间与网络时间同步</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.安装时间同步
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	sudo yum -y install ntp ntpdate
</span></span><span class="line"><span class="cl"><span class="gh"># 2.同步时间
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	sudo ntpdate cn.pool.ntp.org
</span></span><span class="line"><span class="cl"><span class="gh"># 3.查看本机时间
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>	date
</span></span><span class="line"><span class="cl"><span class="gh"># 4.从新测试
</span></span></span></code></pre></div><p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200602183718623.png" alt="image-20200602183718623"></p>
<h2 id="9dockerfile">9.Dockerfile</h2>
<h3 id="91-什么是dockerfile">9.1 什么是Dockerfile</h3>
<p>Dockerfile可以认为是<strong>Docker镜像的描述文件，是由一系列命令和参数构成的脚本</strong>。主要作用是<strong>用来构建docker镜像的构建文件</strong>。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200404111908085.png" alt="image-20200404111908085"></p>
<ul>
<li><strong>通过架构图可以看出通过DockerFile可以直接构建镜像</strong></li>
</ul>
<h3 id="92-dockerfile解析过程">9.2 Dockerfile解析过程</h3>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200603181253804.png" alt="image-20200603181253804"></p>
<h3 id="93-dockerfile的保留命令">9.3 Dockerfile的保留命令</h3>
<p>官方说明:<a href="https://docs.docker.com/engine/reference/builder/" title="https://docs.docker.com/engine/reference/builder/">https://docs.docker.com/engine/reference/builder/</a></p>
<p>保留字</p>
<p>作用</p>
<p><strong>FROM</strong></p>
<p><strong>当前镜像是基于哪个镜像的</strong> <code>第一个指令必须是FROM</code></p>
<p>MAINTAINER</p>
<p>镜像维护者的姓名和邮箱地址</p>
<p><strong>RUN</strong></p>
<p><strong>构建镜像时需要运行的指令</strong></p>
<p><strong>EXPOSE</strong></p>
<p><strong>当前容器对外暴露出的端口号</strong></p>
<p><strong>WORKDIR</strong></p>
<p><strong>指定在创建容器后，终端默认登录进来的工作目录，一个落脚点</strong></p>
<p><strong>ENV</strong></p>
<p><strong>用来在构建镜像过程中设置环境变量</strong></p>
<p><strong>ADD</strong></p>
<p><strong>将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar包</strong></p>
<p><strong>COPY</strong></p>
<p><strong>类似于ADD，拷贝文件和目录到镜像中<br>
将从构建上下文目录中&lt;原路径&gt;的文件/目录复制到新的一层的镜像内的&lt;目标路径&gt;位置</strong></p>
<p><strong>VOLUME</strong></p>
<p><strong>容器数据卷，用于数据保存和持久化工作</strong></p>
<p><strong>CMD</strong></p>
<p><strong>指定一个容器启动时要运行的命令<br>
Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换</strong></p>
<p><strong>ENTRYPOINT</strong></p>
<p><strong>指定一个容器启动时要运行的命令<br>
ENTRYPOINT的目的和CMD一样，都是在指定容器启动程序及其参数</strong></p>
<h4 id="931-from-命令">9.3.1 FROM 命令</h4>
<ul>
<li>
<p>基于那个镜像进行构建新的镜像,在构建时会自动从docker hub拉取base镜像 必须作为Dockerfile的第一个指令出现</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s">  &lt;image&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s">  &lt;image&gt;[:&lt;tag&gt;]     使用版本不写为latest</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s">  &lt;image&gt;[@&lt;digest&gt;]  使用摘要</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="932-maintainer-命令">9.3.2 MAINTAINER 命令</h4>
<ul>
<li>
<p>镜像维护者的姓名和邮箱地址[废弃]</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">MAINTAINER</span><span class="s"> &lt;name&gt;</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="933-run-命令">9.3.3 RUN 命令</h4>
<ul>
<li>
<p>RUN指令将在当前映像之上的新层中执行任何命令并提交结果。生成的提交映像将用于Dockerfile中的下一步</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">RUN</span> &lt;command&gt; <span class="o">(</span>shell form, the <span class="nb">command</span> is run in a shell, which by default is /bin/sh -c on Linux or cmd /S /C on Windows<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> hello<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="o">[</span><span class="s2">&#34;executable&#34;</span>, <span class="s2">&#34;param1&#34;</span>, <span class="s2">&#34;param2&#34;</span><span class="o">]</span> <span class="o">(</span><span class="nb">exec</span> form<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="o">[</span><span class="s2">&#34;/bin/bash&#34;</span>, <span class="s2">&#34;-c&#34;</span>, <span class="s2">&#34;echo hello&#34;</span><span class="o">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="934-expose-命令">9.3.4 EXPOSE 命令</h4>
<ul>
<li>
<p>用来指定构建的镜像在运行为容器时对外暴露的端口</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">EXPOSE</span><span class="s"> 80/tcp  如果没有显示指定则默认暴露都是tcp</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 80/udp</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="935-cmd-命令">9.3.5 CMD 命令</h4>
<ul>
<li>
<p>用来为启动的容器指定执行的命令,在Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。</p>
</li>
<li>
<p>注意: <strong>Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。</strong></p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;executable&#34;</span><span class="p">,</span><span class="s2">&#34;param1&#34;</span><span class="p">,</span><span class="s2">&#34;param2&#34;</span><span class="p">]</span> <span class="o">(</span><span class="nb">exec</span> form, this is the preferred form<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;param1&#34;</span><span class="p">,</span><span class="s2">&#34;param2&#34;</span><span class="p">]</span> <span class="o">(</span>as default parameters to ENTRYPOINT<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="nb">command</span> param1 param2 <span class="o">(</span>shell form<span class="o">)</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="936-workdir-命令">9.3.6 WORKDIR 命令</h4>
<ul>
<li>
<p>用来为Dockerfile中的任何RUN、CMD、ENTRYPOINT、COPY和ADD指令设置工作目录。如果WORKDIR不存在，即使它没有在任何后续Dockerfile指令中使用，它也将被创建。</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">WORKDIR</span><span class="s"> /path/to/workdir</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /a</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> b</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> c</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="sb">`</span>注意:WORKDIR指令可以在Dockerfile中多次使用。如果提供了相对路径，则该路径将与先前WORKDIR指令的路径相对<span class="sb">`</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="937-env-命令">9.3.7 ENV 命令</h4>
<ul>
<li>
<p>用来为构建镜像设置环境变量。这个值将出现在构建阶段中所有后续指令的环境中。</p>
</li>
<li>
<p>语法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">ENV</span> &lt;key&gt; &lt;value&gt;<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> &lt;key&gt;<span class="o">=</span>&lt;value&gt; ...<span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="938-add-命令">9.3.8 ADD 命令</h4>
<ul>
<li>
<p>用来从context上下文复制新文件、目录或远程文件url，并将它们添加到位于指定路径的映像文件系统中。</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">ADD</span> hom* /mydir/       通配符添加多个文件<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> hom?.txt /mydir/   通配符添加<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> test.txt relativeDir/  可以指定相对路径<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> test.txt /absoluteDir/ 也可以指定绝对路径<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> url <span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="939-copy-命令">9.3.9 COPY 命令</h4>
<ul>
<li>
<p>用来将context目录中指定文件复制到镜像的指定目录中</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">COPY</span> src dest<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> <span class="o">[</span><span class="s2">&#34;&lt;src&gt;&#34;</span>,... <span class="s2">&#34;&lt;dest&gt;&#34;</span><span class="o">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="9310-volume-命令">9.3.10 VOLUME 命令</h4>
<ul>
<li>
<p>用来定义容器运行时可以挂在到宿主机的目录</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">VOLUME</span> <span class="p">[</span><span class="s2">&#34;/data&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="9311-entrypoint命令">9.3.11 ENTRYPOINT命令</h4>
<ul>
<li>
<p>用来指定容器启动时执行命令和CMD类似</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl">  <span class="o">[</span><span class="s2">&#34;executable&#34;</span>, <span class="s2">&#34;param1&#34;</span>, <span class="s2">&#34;param2&#34;</span><span class="o">]</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="nb">command</span> param1 param2<span class="err">
</span></span></span></code></pre></div><p>ENTRYPOINT指令，往往用于设置容器启动后的<strong>第一个命令</strong>，这对一个容器来说往往是固定的。 CMD指令，往往用于设置容器启动的第一个命令的<strong>默认参数</strong>，这对一个容器来说可以是变化的。</p>
</li>
</ul>
<h4 id="9311-entrypoint命令-1">9.3.11 ENTRYPOINT命令</h4>
<h3 id="94-dockerfile构建springboot项目部署">9.4 Dockerfile构建springboot项目部署</h3>
<h5 id="1准备springboot可运行项目">1.准备springboot可运行项目</h5>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200605172151266.png" alt="image-20200605172151266"></p>
<h5 id="2将可运行项目放入linux虚拟机中">2.将可运行项目放入linux虚拟机中</h5>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200605172340380.png" alt="image-20200605172340380"></p>
<h5 id="3编写dockerfile">3.编写Dockerfile</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> openjdk:8</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /ems</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> ems.jar /ems<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8989</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;java&#34;</span><span class="p">,</span><span class="s2">&#34;-jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;ems.jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><h5 id="4构建镜像">4.构建镜像</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ems<span class="o">]</span><span class="c1"># docker build -t ems .</span>
</span></span></code></pre></div><h5 id="5运行镜像">5.运行镜像</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ems<span class="o">]</span><span class="c1"># docker run -p 8989:8989 ems</span>
</span></span></code></pre></div><h5 id="6访问项目">6.访问项目</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">http://10.15.0.8:8989/ems/login.html
</span></span></span></code></pre></div><p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20200605173141636.png" alt="image-20200605173141636"></p>
<hr>
<h2 id="10高级网络配置">10.高级网络配置</h2>
<h3 id="101-说明">10.1 说明</h3>
<p>当 Docker 启动时，会自动在主机上创建一个 <code>docker0</code> 虚拟网桥，实际上是 Linux 的一个 bridge，可以理解为一个软件交换机。它会在挂载到它的网口之间进行转发。</p>
<p>同时，Docker 随机分配一个本地未占用的私有网段（在 <a href="https://tools.ietf.org/html/rfc1918" title="https://tools.ietf.org/html/rfc1918">RFC1918</a> 中定义）中的一个地址给 <code>docker0</code> 接口。比如典型的 <code>172.17.42.1</code>，掩码为 <code>255.255.0.0</code>。此后启动的容器内的网口也会自动分配一个同一网段（<code>172.17.0.0/16</code>）的地址。</p>
<p>当创建一个 Docker 容器的时候，同时会创建了一对 <code>veth pair</code> 接口（当数据包发送到一个接口时，另外一个接口也可以收到相同的数据包）。这对接口一端在容器内，即 <code>eth0</code>；另一端在本地并被挂载到 <code>docker0</code> 网桥，名称以 <code>veth</code> 开头（例如 <code>vethAQI2QT</code>）。通过这种方式，主机可以跟容器通信，容器之间也可以相互通信。Docker 就创建了在主机和所有容器之间一个虚拟共享网络。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20201125105847896.png" alt="image-20201125105847896"></p>
<h3 id="102-查看网络信息">10.2 查看网络信息</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># docker network ls
</span></span></span></code></pre></div><h3 id="103-创建一个网桥">10.3 创建一个网桥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># docker network create -d bridge 网桥名称
</span></span></span></code></pre></div><h3 id="104-删除一个网桥">10.4 删除一个网桥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># docker network rm 网桥名称
</span></span></span></code></pre></div><h3 id="105-容器之前使用网络通信">10.5 容器之前使用网络通信</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.查询当前网络配置
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> docker network ls
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">NETWORK ID          NAME                DRIVER              SCOPE
</span></span><span class="line"><span class="cl">8e424e5936b7        bridge              bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="cl">17d974db02da        docker_gwbridge     bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="cl">d6c326e433f7        host                host                <span class="nb">local</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 2.创建桥接网络
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> docker network create -d bridge info
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker network create -d bridge info</span>
</span></span><span class="line"><span class="cl">6e4aaebff79b1df43a064e0e8fdab08f52d64ce34db78dd5184ce7aaaf550a2f
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker network ls</span>
</span></span><span class="line"><span class="cl">NETWORK ID          NAME                DRIVER              SCOPE
</span></span><span class="line"><span class="cl">8e424e5936b7        bridge              bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="cl">17d974db02da        docker_gwbridge     bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="cl">d6c326e433f7        host                host                <span class="nb">local</span>
</span></span><span class="line"><span class="cl">6e4aaebff79b        info                bridge              <span class="nb">local</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 3.启动容器指定使用网桥
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> docker run -d -p 8890:80 --name nginx001 --network info nginx 
</span></span><span class="line"><span class="cl"><span class="k">-</span> docker run -d -p 8891:80 --name nginx002 --network info nginx 
</span></span><span class="line"><span class="cl">	<span class="sb">`注意:一旦指定网桥后--name指定名字就是主机名,多个容器指定在同一个网桥时,可以在任意一个容器中使用主机名与容器进行互通`</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -p 8890:80 --name nginx001 --network info nginx </span>
</span></span><span class="line"><span class="cl">c315bcc94e9ddaa36eb6c6f16ca51592b1ac8bf1ecfe9d8f01d892f3f10825fe
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -p 8891:80 --name nginx002 --network info nginx</span>
</span></span><span class="line"><span class="cl">f8682db35dd7fb4395f90edb38df7cad71bbfaba71b6a4c6e2a3a525cb73c2a5
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker ps</span>
</span></span><span class="line"><span class="cl">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
</span></span><span class="line"><span class="cl">f8682db35dd7        nginx               <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">3</span> seconds ago       Up <span class="m">2</span> seconds        0.0.0.0:8891-&gt;80/tcp   nginx002
</span></span><span class="line"><span class="cl">c315bcc94e9d        nginx               <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">7</span> minutes ago       Up <span class="m">7</span> minutes        0.0.0.0:8890-&gt;80/tcp   nginx001
</span></span><span class="line"><span class="cl">b63169d43792        mysql:5.7.19        <span class="s2">&#34;docker-entrypoint.s…&#34;</span>   <span class="m">7</span> minutes ago       Up <span class="m">7</span> minutes        3306/tcp               mysql_mysql.1.s75qe5kkpwwttyf0wrjvd2cda
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker exec -it f8682db35dd7 /bin/bash</span>
</span></span><span class="line"><span class="cl">root@f8682db35dd7:/# curl http://nginx001
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html&gt;
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">&lt;head&gt;
</span></span><span class="line"><span class="cl">&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span class="line"><span class="cl">.....
</span></span></code></pre></div><hr>
<h2 id="11高级数据卷配置">11.高级数据卷配置</h2>
<h3 id="111-说明">11.1 说明</h3>
<p><code>数据卷</code> 是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：</p>
<ul>
<li><code>数据卷</code> 可以在容器之间共享和重用</li>
<li>对 <code>数据卷</code> 的修改会立马生效</li>
<li>对 <code>数据卷</code> 的更新，不会影响镜像</li>
<li><code>数据卷</code> 默认会一直存在，即使容器被删除</li>
</ul>
<blockquote>
<p>注意：<code>数据卷</code> 的使用，类似于 Linux 下对目录或文件进行 mount，镜像中的被指定为挂载点的目录中的文件会复制到数据卷中（仅数据卷为空时会复制）。</p>
</blockquote>
<h3 id="112-创建数据卷">11.2 创建数据卷</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker volume create my-vol</span>
</span></span><span class="line"><span class="cl">my-vol
</span></span></code></pre></div><h3 id="113-查看数据卷">11.3 查看数据卷</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker volume inspect my-vol       </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;CreatedAt&#34;</span>: <span class="s2">&#34;2020-11-25T11:43:56+08:00&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Labels&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Mountpoint&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/my-vol/_data&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;my-vol&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Options&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><h3 id="114-挂载数据卷">11.4 挂载数据卷</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -P --name web  -v my-vol:/usr/share/nginx/html  nginx</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker inspect web</span>
</span></span><span class="line"><span class="cl">				<span class="s2">&#34;Mounts&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;volume&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;my-vol&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Source&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/my-vol/_data&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Destination&#34;</span>: <span class="s2">&#34;/usr/share/nginx/html&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Mode&#34;</span>: <span class="s2">&#34;z&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;RW&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Propagation&#34;</span>: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>,
</span></span></code></pre></div><h3 id="115-删除数据卷">11.5 删除数据卷</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker volume rm my-vol
</span></span></code></pre></div><hr>
<h2 id="12docker-compose">12.Docker Compose</h2>
<h3 id="121-简介">12.1 简介</h3>
<p><code>Compose</code> 项目是 Docker 官方的开源项目，负责实现对 Docker 容器集群的快速编排。从功能上看，跟 <code>OpenStack</code> 中的 <code>Heat</code> 十分类似。</p>
<p>其代码目前在 <a href="https://github.com/docker/compose" title="https://github.com/docker/compose">https://github.com/docker/compose</a> 上开源。</p>
<p><code>Compose</code> 定位是 「定义和运行多个 Docker 容器的应用（Defining and running multi-container Docker applications）」，其前身是开源项目 Fig。</p>
<p>通过第一部分中的介绍，我们知道使用一个 <code>Dockerfile</code> 模板文件，可以让用户很方便的定义一个单独的应用容器。然而，在日常工作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如要实现一个 Web 项目，除了 Web 服务容器本身，往往还需要再加上后端的数据库服务容器，甚至还包括负载均衡容器等。</p>
<p><code>Compose</code> 恰好满足了这样的需求。它允许用户通过一个单独的 <code>docker-compose.yml</code> 模板文件（YAML 格式）来定义一组相关联的应用容器为一个项目（project）。</p>
<p><code>Compose</code> 中有两个重要的概念：</p>
<ul>
<li>服务 (<code>service</code>)：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。</li>
<li>项目 (<code>project</code>)：由一组关联的应用容器组成的一个完整业务单元，在 <code>docker-compose.yml</code> 文件中定义。</li>
</ul>
<p><code>Compose</code> 的默认管理对象是项目，通过子命令对项目中的一组容器进行便捷地生命周期管理。</p>
<p><code>Compose</code> 项目由 Python 编写，实现上调用了 Docker 服务提供的 API 来对容器进行管理。因此，只要所操作的平台支持 Docker API，就可以在其上利用 <code>Compose</code> 来进行编排管理。</p>
<h3 id="122-安装与卸载">12.2 安装与卸载</h3>
<h6 id="1linux">1.linux</h6>
<ul>
<li>在 Linux 上的也安装十分简单，从 官方 GitHub Release 处直接下载编译好的二进制文件即可。例如，在 Linux 64 位系统上直接下载对应的二进制包。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo curl -L https://github.com/docker/compose/releases/download/1.25.5/docker-compose-<span class="sb">`</span>uname -s<span class="sb">`</span>-<span class="sb">`</span>uname -m<span class="sb">`</span> &gt; /usr/local/bin/docker-compose
</span></span><span class="line"><span class="cl">$ sudo chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></div><h6 id="2macoswindow">2.macos、window</h6>
<ul>
<li>Compose 可以通过 Python 的包管理工具 pip 进行安装，也可以直接下载编译好的二进制文件使用，甚至能够直接在 Docker 容器中运行。<code>Docker Desktop for Mac/Windows 自带 docker-compose 二进制文件，安装 Docker 之后可以直接使用</code>。</li>
</ul>
<h6 id="3bash命令补全">3.bash命令补全</h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ curl -L https://raw.githubusercontent.com/docker/compose/1.25.5/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose
</span></span></code></pre></div><h6 id="4卸载">4.卸载</h6>
<ul>
<li>如果是二进制包方式安装的，删除二进制文件即可。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ sudo rm /usr/local/bin/docker-compose
</span></span></code></pre></div><h6 id="5测试安装成功">5.测试安装成功</h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ docker-compose --version
</span></span><span class="line"><span class="cl"> docker-compose version 1.25.5, build 4667896b
</span></span></code></pre></div><h3 id="123-docker-compose使用">12.3 docker compose使用</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 1.相关概念
</span></span></span></code></pre></div><p>首先介绍几个术语。</p>
<ul>
<li>服务 (<code>service</code>)：一个应用容器，实际上可以运行多个相同镜像的实例。</li>
<li>项目 (<code>project</code>)：由一组关联的应用容器组成的一个完整业务单元。∂一个项目可以由多个服务（容器）关联而成，<code>Compose</code> 面向项目进行管理。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 2.场景
</span></span></span></code></pre></div><p>最常见的项目是 web 网站，该项目应该包含 web 应用和缓存。</p>
<ul>
<li>springboot应用</li>
<li>mysql服务</li>
<li>redis服务</li>
<li>elasticsearch服务</li>
<li>&hellip;&hellip;.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 3.docker-compose模板
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> 参考文档:https://docker_practice.gitee.io/zh-cn/compose/compose_file.html
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mysqldb</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:5.7.19</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/conf:/etc/mysql/conf.d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/logs:/logs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/data:/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ems</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">redis:4.0.14</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;6379:6379&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ems</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/root/redis/data:/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">redis-server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ems</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 4.通过docker-compose运行一组容器
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="k">-</span> 参考文档:https://docker_practice.gitee.io/zh-cn/compose/commands.html
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker-compose up    							//前台启动一组服务</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker-compose up -d 							//后台启动一组服务</span>
</span></span></code></pre></div><hr>
<h3 id="124-docker-compose-模板文件">12.4 docker-compose 模板文件</h3>
<p>模板文件是使用 <code>Compose</code> 的核心，涉及到的指令关键字也比较多。但大家不用担心，这里面大部分指令跟 <code>docker run</code> 相关参数的含义都是类似的。</p>
<p>默认的模板文件名称为 <code>docker-compose.yml</code>，格式为 YAML 格式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">examples/web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;/data&#34;</span><span class="w">
</span></span></span></code></pre></div><p>注意每个服务都必须通过 <code>image</code> 指令指定镜像或 <code>build</code> 指令（需要 Dockerfile）等来自动构建生成镜像。</p>
<p>如果使用 <code>build</code> 指令，在 <code>Dockerfile</code> 中设置的选项(例如：<code>CMD</code>, <code>EXPOSE</code>, <code>VOLUME</code>, <code>ENV</code> 等) 将会自动被获取，无需在 <code>docker-compose.yml</code> 中重复设置。</p>
<p>下面分别介绍各个指令的用法。</p>
<h4 id="build"><code>build</code></h4>
<p>指定 <code>Dockerfile</code> 所在文件夹的路径（可以是绝对路径，或者相对 docker-compose.yml 文件的路径）。 <code>Compose</code> 将会利用它自动构建这个镜像，然后使用这个镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">./dir</span><span class="w">
</span></span></span></code></pre></div><p>你也可以使用 <code>context</code> 指令指定 <code>Dockerfile</code> 所在文件夹的路径。</p>
<p>使用 <code>dockerfile</code> 指令指定 <code>Dockerfile</code> 文件名。</p>
<p>使用 <code>arg</code> 指令指定构建镜像时的变量。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./dir</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">Dockerfile-alternate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">buildno</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span></code></pre></div><h4 id="command"><code>command</code></h4>
<p>覆盖容器启动后默认执行的命令。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;hello world&#34;</span><span class="w">
</span></span></span></code></pre></div><h4 id="container_name"><code>container_name</code></h4>
<p>指定容器名称。默认将会使用 <code>项目名称_服务名称_序号</code> 这样的格式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">docker-web-container</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>注意: 指定容器名称后，该服务将无法进行扩展（scale），因为 Docker 不允许多个容器具有相同的名称。</p>
</blockquote>
<h4 id="depends_on"><code>depends_on</code></h4>
<p>解决容器的依赖、启动先后的问题。以下例子中会先启动 <code>redis</code> <code>db</code> 再启动 <code>web</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">db</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>注意：<code>web</code> 服务不会等待 <code>redis</code> <code>db</code> 「完全启动」之后才启动。</p>
</blockquote>
<h4 id="env_file"><code>env_file</code></h4>
<p>从文件中获取环境变量，可以为单独的文件路径或列表。</p>
<p>如果通过 <code>docker-compose -f FILE</code> 方式来指定 Compose 模板文件，则 <code>env_file</code> 中变量的路径会基于模板文件路径。</p>
<p>如果有变量名称与 <code>environment</code> 指令冲突，则按照惯例，以后者为准。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">env_file: .env
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">env_file:
</span></span><span class="line"><span class="cl">  - ./common.env
</span></span><span class="line"><span class="cl">  - ./apps/web.env
</span></span><span class="line"><span class="cl">  - /opt/secrets.env
</span></span></code></pre></div><p>环境变量文件中每一行必须符合格式，支持 <code>#</code> 开头的注释行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># common.env: Set development environment</span>
</span></span><span class="line"><span class="cl"><span class="nv">PROG_ENV</span><span class="o">=</span>development
</span></span></code></pre></div><h4 id="environment"><code>environment</code></h4>
<p>设置环境变量。你可以使用数组或字典两种格式。</p>
<p>只给定名称的变量会自动获取运行 Compose 主机上对应变量的值，可以用来防止泄露不必要的数据。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">RACK_ENV</span><span class="p">:</span><span class="w"> </span><span class="l">development</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">SESSION_SECRET</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">RACK_ENV=development</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">SESSION_SECRET</span><span class="w">
</span></span></span></code></pre></div><p>如果变量名称或者值中用到 <code>true|false，yes|no</code> 等表达 <a href="https://yaml.org/type/bool.html" title="https://yaml.org/type/bool.html">布尔</a> 含义的词汇，最好放到引号里，避免 YAML 自动解析某些内容为对应的布尔语义。这些特定词汇，包括</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">y<span class="p">|</span>Y<span class="p">|</span>yes<span class="p">|</span>Yes<span class="p">|</span>YES<span class="p">|</span>n<span class="p">|</span>N<span class="p">|</span>no<span class="p">|</span>No<span class="p">|</span>NO<span class="p">|</span>true<span class="p">|</span>True<span class="p">|</span>TRUE<span class="p">|</span>false<span class="p">|</span>False<span class="p">|</span>FALSE<span class="p">|</span>on<span class="p">|</span>On<span class="p">|</span>ON<span class="p">|</span>off<span class="p">|</span>Off<span class="p">|</span>OFF
</span></span></code></pre></div><h4 id="healthcheck"><code>healthcheck</code></h4>
<p>通过命令检查容器是否健康运行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">healthcheck</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;CMD&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;curl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;-f&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;http://localhost&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l">1m30s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span></code></pre></div><h4 id="image"><code>image</code></h4>
<p>指定为镜像名称或镜像 ID。如果镜像在本地不存在，<code>Compose</code> 将会尝试拉取这个镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">orchardup/postgresql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">a4bc65fd</span><span class="w">
</span></span></span></code></pre></div><h4 id="networks"><code>networks</code></h4>
<p>配置容器连接的网络。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">some-service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="l">some-network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="l">other-network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">some-network</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">other-network</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><h4 id="ports"><code>ports</code></h4>
<p>暴露端口信息。</p>
<p>使用宿主端口：容器端口 <code>(HOST:CONTAINER)</code> 格式，或者仅仅指定容器的端口（宿主将会随机选择端口）都可以。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="s2">&#34;3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="s2">&#34;8000:8000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="s2">&#34;49100:22&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="s2">&#34;127.0.0.1:8001:8001&#34;</span><span class="w">
</span></span></span></code></pre></div><p><em>注意：当使用 <code>HOST:CONTAINER</code> 格式来映射端口时，如果你使用的容器端口小于 60 并且没放到引号里，可能会得到错误结果，因为 <code>YAML</code> 会自动解析 <code>xx:yy</code> 这种数字格式为 60 进制。为避免出现这种问题，建议数字串都采用引号包括起来的字符串格式。</em></p>
<h4 id="sysctls"><code>sysctls</code></h4>
<p>配置容器内核参数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">sysctls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">net.core.somaxconn</span><span class="p">:</span><span class="w"> </span><span class="m">1024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">net.ipv4.tcp_syncookies</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">sysctls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">net.core.somaxconn=1024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">net.ipv4.tcp_syncookies=0</span><span class="w">
</span></span></span></code></pre></div><h4 id="ulimits"><code>ulimits</code></h4>
<p>指定容器的 ulimits 限制值。</p>
<p>例如，指定最大进程数为 65535，指定文件句柄数为 20000（软限制，应用可以随时修改，不能超过硬限制） 和 40000（系统硬限制，只能 root 用户提高）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ulimits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nproc</span><span class="p">:</span><span class="w"> </span><span class="m">65535</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nofile</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">soft</span><span class="p">:</span><span class="w"> </span><span class="m">20000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">hard</span><span class="p">:</span><span class="w"> </span><span class="m">40000</span><span class="w">
</span></span></span></code></pre></div><h4 id="volumes"><code>volumes</code></h4>
<p>数据卷所挂载路径设置。可以设置为宿主机路径(<code>HOST:CONTAINER</code>)或者数据卷名称(<code>VOLUME:CONTAINER</code>)，并且可以设置访问模式 （<code>HOST:CONTAINER:ro</code>）。</p>
<p>该指令中路径支持相对路径。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">cache/:/tmp/cache</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">~/configs:/etc/configs/:ro</span><span class="w">
</span></span></span></code></pre></div><p>如果路径为数据卷名称，必须在文件中配置数据卷。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">my_src</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:8.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">mysql_data:/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mysql_data</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><hr>
<h3 id="125-docker-compose-常用命令">12.5 docker-compose 常用命令</h3>
<h5 id="1-命令对象与格式">1. 命令对象与格式</h5>
<p>对于 Compose 来说，大部分命令的对象既可以是项目本身，也可以指定为项目中的服务或者容器。如果没有特别的说明，命令对象将是项目，这意味着项目中所有的服务都会受到命令影响。</p>
<p>执行 <code>docker-compose [COMMAND] --help</code> 或者 <code>docker-compose help [COMMAND]</code> 可以查看具体某个命令的使用格式。</p>
<p><code>docker-compose</code> 命令的基本的使用格式是</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose <span class="o">[</span>-f<span class="o">=</span>&lt;arg&gt;...<span class="o">]</span> <span class="o">[</span>options<span class="o">]</span> <span class="o">[</span>COMMAND<span class="o">]</span> <span class="o">[</span>ARGS...<span class="o">]</span>
</span></span></code></pre></div><h5 id="2-命令选项">2. 命令选项</h5>
<ul>
<li><code>-f, --file FILE</code> 指定使用的 Compose 模板文件，默认为 <code>docker-compose.yml</code>，可以多次指定。</li>
<li><code>-p, --project-name NAME</code> 指定项目名称，默认将使用所在目录名称作为项目名。</li>
<li><code>--x-networking</code> 使用 Docker 的可拔插网络后端特性</li>
<li><code>--x-network-driver DRIVER</code> 指定网络后端的驱动，默认为 <code>bridge</code></li>
<li><code>--verbose</code> 输出更多调试信息。</li>
<li><code>-v, --version</code> 打印版本并退出。</li>
</ul>
<h5 id="3命令使用说明">3.命令使用说明</h5>
<h5 id="up"><code>up</code></h5>
<p>格式为 <code>docker-compose up [options] [SERVICE...]</code>。</p>
<ul>
<li>
<p>该命令十分强大，它将尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一系列操作。</p>
</li>
<li>
<p>链接的服务都将会被自动启动，除非已经处于运行状态。</p>
</li>
<li>
<p>可以说，大部分时候都可以直接通过该命令来启动一个项目。</p>
</li>
<li>
<p>默认情况，<code>docker-compose up</code> 启动的容器都在前台，控制台将会同时打印所有容器的输出信息，可以很方便进行调试。</p>
</li>
<li>
<p>当通过 <code>Ctrl-C</code> 停止命令时，所有容器将会停止。</p>
</li>
<li>
<p>如果使用 <code>docker-compose up -d</code>，将会在后台启动并运行所有的容器。一般推荐生产环境下使用该选项。</p>
</li>
<li>
<p>默认情况，如果服务容器已经存在，<code>docker-compose up</code> 将会尝试停止容器，然后重新创建（保持使用 <code>volumes-from</code> 挂载的卷），以保证新启动的服务匹配 <code>docker-compose.yml</code> 文件的最新内容</p>
</li>
</ul>
<hr>
<h5 id="down"><code>down</code></h5>
<ul>
<li>此命令将会停止 <code>up</code> 命令所启动的容器，并移除网络</li>
</ul>
<hr>
<h5 id="exec"><code>exec</code></h5>
<ul>
<li>进入指定的容器。</li>
</ul>
<hr>
<h5 id="ps"><code>ps</code></h5>
<p>格式为 <code>docker-compose ps [options] [SERVICE...]</code>。</p>
<p>列出项目中目前的所有容器。</p>
<p>选项：</p>
<ul>
<li><code>-q</code> 只打印容器的 ID 信息。</li>
</ul>
<hr>
<h5 id="restart"><code>restart</code></h5>
<p>格式为 <code>docker-compose restart [options] [SERVICE...]</code>。</p>
<p>重启项目中的服务。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 指定重启前停止容器的超时（默认为 10 秒）。</li>
</ul>
<hr>
<h5 id="rm"><code>rm</code></h5>
<p>格式为 <code>docker-compose rm [options] [SERVICE...]</code>。</p>
<p>删除所有（停止状态的）服务容器。推荐先执行 <code>docker-compose stop</code> 命令来停止容器。</p>
<p>选项：</p>
<ul>
<li><code>-f, --force</code> 强制直接删除，包括非停止状态的容器。一般尽量不要使用该选项。</li>
<li><code>-v</code> 删除容器所挂载的数据卷。</li>
</ul>
<hr>
<h5 id="start"><code>start</code></h5>
<p>格式为 <code>docker-compose start [SERVICE...]</code>。</p>
<p>启动已经存在的服务容器。</p>
<hr>
<h5 id="stop"><code>stop</code></h5>
<p>格式为 <code>docker-compose stop [options] [SERVICE...]</code>。</p>
<p>停止已经处于运行状态的容器，但不删除它。通过 <code>docker-compose start</code> 可以再次启动这些容器。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 停止容器时候的超时（默认为 10 秒）。</li>
</ul>
<hr>
<h5 id="top"><code>top</code></h5>
<p>查看各个服务容器内运行的进程。</p>
<hr>
<h5 id="unpause"><code>unpause</code></h5>
<p>格式为 <code>docker-compose unpause [SERVICE...]</code>。</p>
<p>恢复处于暂停状态中的服务。</p>
<hr>
<h2 id="13docker可视化工具">13.docker可视化工具</h2>
<h4 id="131-安装portainer">13.1 安装Portainer</h4>
<p>官方安装说明：<a href="http://www.yunweipai.com/go?_=8fe4813824aHR0cHM6Ly93d3cucG9ydGFpbmVyLmlvL2luc3RhbGxhdGlvbi8=" title="http://www.yunweipai.com/go?_=8fe4813824aHR0cHM6Ly93d3cucG9ydGFpbmVyLmlvL2luc3RhbGxhdGlvbi8=">https://www.portainer.io/installation/</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker pull  portainer/portainer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker volume create portainer_data</span>
</span></span><span class="line"><span class="cl">portainer_data
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</span>
</span></span><span class="line"><span class="cl">20db26b67b791648c2ef6aee444a5226a9c897ebcf0160050e722dbf4a4906e3
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker ps </span>
</span></span><span class="line"><span class="cl">CONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                                            NAMES
</span></span><span class="line"><span class="cl">20db26b67b79        portainer/portainer   <span class="s2">&#34;/portainer&#34;</span>        <span class="m">5</span> seconds ago       Up <span class="m">4</span> seconds        0.0.0.0:8000-&gt;8000/tcp, 0.0.0.0:9000-&gt;9000/tcp   portainer
</span></span></code></pre></div><h4 id="132-登录和使用portainer">13.2 登录和使用Portainer</h4>
<blockquote>
<p>用浏览器访问：<code>http://localhost:9000</code></p>
</blockquote>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/image-20201223231707738.png" alt="image-20201223231707738"></p>
<hr>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>docker设置</h1>

<p>镜像加速：
我自己的阿里云镜像仓库：</p>
<pre tabindex="0"><code></code></pre>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>Excalidraw</h1>


            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>golang</h1>


            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>interview</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>简历</h1>

<h1 id="个人信息">个人信息</h1>
<ul>
<li>
<p>于文浩/男/1994</p>
</li>
<li>
<p>本科/泰山学院自动化专业</p>
</li>
<li>
<p>籍贯：山东</p>
</li>
<li>
<p>住址：朝阳-酒仙桥</p>
</li>
<li>
<p>工作年限：5年</p>
</li>
<li>
<p>求职方向：java服务端开发</p>
</li>
<li>
<p>手机：18612836421</p>
</li>
<li>
<p>Email: <a href="mailto:yuvenhol@email.cn">yuvenhol@email.cn</a></p>
</li>
</ul>
<h1 id="技能清单">技能清单</h1>
<ul>
<li>
<p>后端框架：Spring Boot +Spring Cloud</p>
</li>
<li>
<p>开发环境：Linux、Windows、MacOS</p>
</li>
<li>
<p>消息队列：Kafka</p>
</li>
<li>
<p>数据库：MySQL/ES/MongoDB/Redis</p>
</li>
<li>
<p>版本管理：Svn/Git</p>
</li>
<li>
<p>其他语言：Python、GO</p>
</li>
</ul>
<h1 id="个人优点">个人优点</h1>
<p>有着良好的团队精神，积极参与需求讨论，能从用户角度考虑问题，并给予技术实现方案。</p>
<p>能够主动承担任务，有较强执行力，及时为运营解决问题，与产品探讨优化方案，保证又快又好上线。</p>
<h1 id="工作经历">工作经历</h1>
<h2 id="完美世界控股集团有限公司--2018年8月--至今-">完美世界控股集团有限公司 （ 2018年8月 ~ 至今 ）</h2>
<h3 id="全未来项目20203至今">全未来项目（2020.3~至今）</h3>
<h4 id="所用技术">所用技术：</h4>
<p>SpringCloud、MySQL、ElasticSearch、Kafka、Redis</p>
<h4 id="项目介绍">项目介绍：</h4>
<p>全未来项目是一个为用户提供安排未来生活的资讯平台，包括剧本杀、密室逃脱等活动的组团约玩，演唱会、脱口秀、漫展、特殊影厅等活动门票售卖，以及线上线下的抽奖活动。基于SpringCloud，分为客户端主服务、社区服务、商城主服务、商城后台、运营后台、以及第三方服务等几个微服务系统。主要业务数据存储于MySQL中，复杂查询、基于位置信息查询、大文本的数据从MySQL中抽取聚合再刷到ES中，使用Redis做缓存和分布式锁，Kafka做消息队列对复杂处理削峰。</p>
<h4 id="工作内容">工作内容：</h4>
<p>主要负责app、小程序和中台接口的开发，第三方接口对接，以及工作任务的安排。</p>
<p>app&amp;小程序:首页、附近页、详情页、客户端内容生产、发帖与评论相关接口。</p>
<p>内容生成平台：主体内容生产、机器审核、人工审核，权限校验，个人信息与社区内容的审核。</p>
<p>内容管理平台：运营工具、数据分发标签，地区、场所、商圈、品牌等基础数据管理，后台用户权限管理。</p>
<p>商城后台：商品管理、订单管理、商家管理、用户权限管理。</p>
<h4 id="收获">收获：</h4>
<p>在这个项目中，我提升了视野，学会了从团队的角度思考问题。通过对业务的深度参与得到了更深的理解，这有助于对更精准的抽象数据结构和写出贴合实际的业务代码，减少与产品反复沟通，提高整体团队效率。我因此受益匪浅，也赢得了产品和领导们的一致好评。</p>
<h3 id="全历史项目2018820203">全历史项目（2018.8~2020~3）</h3>
<h4 id="所用技术-1">所用技术：</h4>
<p>SpringCloud、MySQL、MongoDB、ElasticSearch、Kafka、Redis</p>
<h4 id="项目介绍-1">项目介绍：</h4>
<p>全历史是一个为历史爱好者学习交流分享的平台，包含关系图谱、疆域变迁、历史规律、各种专业史、以及艺术作品等。项目基于SpringCloud，大文本和爬虫数据存住在MongoDB中，业务数据主要存住在MySQL，有复杂查询需求会同步数据到ES中，频繁访问以及处理时间较长的数据使用Redis做缓存，使用Kafka做消息队列对复杂处理削峰。</p>
<h4 id="工作内容-1">工作内容：</h4>
<p>我主要负责app和中台接口的开发，以及数据的爬取和清洗。项目的数据由运营人员编写和网络抓取数据组成。在爬虫开发资源不够的时候，我负责了网络数据爬取解析存储。后来开发了科技史、战争史、美术史等专业史的内容生产平台、外包审核系统、app端接口，以及一些文字转语音、音视频拼接、地理位置信息查询等第三方服务的对接。项目起初是单体服务，随着业务的发展逐渐显得过于臃肿对开发调试部署都带来了不便，我接手以后率先进行了微服务改造，梳理可拆分业务，旧服务代码剥离，切换到新服务。</p>
<h4 id="收获-1">收获：</h4>
<p>上手掌握了SpringCloud相关技术栈，养成了较良好的开发习惯，与各端开发人员、产品运营形成了默契的配合。</p>
<h2 id="北京康健德科技有限公司--2018年4月--2018年8月-">北京康健德科技有限公司 （ 2018年4月 ~ 2018年8月 ）</h2>
<h3 id="健康评估项目">健康评估项目</h3>
<h4 id="所用技术-2">所用技术：</h4>
<p>SpringCloud、MySQL、Redis</p>
<h4 id="项目介绍-2">项目介绍：</h4>
<p>与各大体检机构合作，对用户历年体检数据进行比对得到结合专业医师对用户身体发展状况进行评估，根据评估结果推送相关产品。项目是基于SpringBoot单体应用，使用mysql作为数据库，redis做缓存。</p>
<h4 id="工作内容-2">工作内容：</h4>
<p>数据评估工具开发，计算身体状况得分，推荐对应商品。</p>
<h2 id="浩鸿达科技发展股份公司--2016年7月--2018年3月-">浩鸿达科技发展股份公司 （ 2016年7月 ~ 2018年3月 ）</h2>
<h3 id="电子会计档案系统">电子会计档案系统：</h3>
<h4 id="项目介绍-3">项目介绍：</h4>
<p>开发专业具有收集归档、档案管理、保管、检索利⽤、鉴定销毁、统计、系统管理等模块 在内的功能完善的会计档案系统。并针不同财务系统开发数据抽取接口，对数据进行ETL，整理到档案系统⽣成PDF⽂件，加盖数字签章。</p>
<h4 id="工作内容-3">工作内容：</h4>
<p>针对各财务系统对接接口开发，数据库设计，⽂档维护，数据进行ETL，生成PDF文件加盖数字签章。</p>
<p>&mdash;      </p>
<h1 id="致谢">致谢</h1>
<p>感谢您花时间阅读我的简历，期待能有机会和您共事。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>面试题整理</h1>

<h1 id="redis">Redis</h1>
<h2 id="缓存雪崩缓存击穿缓存穿透的概念和解决方案">缓存雪崩、缓存击穿、缓存穿透的概念和解决方案</h2>
<h3 id="缓存雪崩">缓存雪崩：</h3>
<p><em>描述：</em>
大量缓存集中失效，查询数据量很大，引起数据库压力过大。
<em>解决方案：</em></p>
<ol>
<li>缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。</li>
<li>设置热点数据永远不过期。</li>
</ol>
<h3 id="缓存击穿">缓存击穿：</h3>
<p><em>描述:</em>
缓存击穿是指缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力
<em>解决方案：</em></p>
<ol>
<li>设置热点数据永远不过期。</li>
<li>加互斥锁，解锁后重入。</li>
</ol>
<h3 id="缓存穿透">缓存穿透：</h3>
<p><em>描述</em>
大量访问数据库中不存在缓存中也不存在的数据，导致数据库压力过大，也是攻击的一种手段。
<em>解决方案：</em></p>
<ol>
<li>接口层增加校验，如用户鉴权校验，id做基础校验，id&lt;=0的直接拦截；</li>
<li>从缓存取不到的数据，在数据库中也没有取到，这时也可以将key-value对写为key-null，缓存有效时间可以设置短点，如30秒（设置太长会导致正常情况也没法使用）。这样可以防止攻击用户反复用同一个id暴力攻击</li>
</ol>
<h1 id="如何实现接口幂等">如何实现接口幂等</h1>
<h2 id="token方式">token方式</h2>
<p>先下发token，完成之后再清除token</p>
<h2 id="乐观锁">乐观锁</h2>
<p>基于乐观锁来控制版本</p>
<h2 id="分布式事务">分布式事务</h2>
<p>1、2pc</p>
<h1 id="死锁">死锁</h1>
<p>如果在一个系统中以下四个条件同时成立，那么就能引起死锁：</p>
<ol>
<li>互斥：至少有一个资源必须处于非共享模式，即一次只有一个进程可使用。如果另一进程申请该资源，那么申请进程应等到该资源释放为止。</li>
<li>占有并等待：—个进程应占有至少一个资源，并等待另一个资源，而该资源为其他进程所占有。</li>
<li>非抢占：资源不能被抢占，即资源只能被进程在完成任务后自愿释放。</li>
<li>循环等待：有一组等待进程 {P0，P1，…，Pn}，P0 等待的资源为 P1 占有，P1 等待的资源为 P2 占有，……，Pn-1 等待的资源为 Pn 占有，Pn 等待的资源为 P0 占有。</li>
</ol>
<p>解决死锁：
1、打破四个必要条件之一即可，比如检测是否会产生循环，长时间获取不到资源就失败等等
2、在产生死锁后，检测然后回复。</p>
<p>大多数程序都不会考虑死锁问题</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>java</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>classpath</h1>

<p>#classpath
#java基础
搬运：https://stackoverflow.com/questions/2396493/what-is-a-classpath-and-how-do-i-set-it/2396759#2396759</p>
<h2 id="什么是classpath">什么是classpath</h2>
<p>当我们在写java程序的时候，常常会引用其他的class文件，ex：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.javaguy.coolframework.MyClass</span><span class="o">;</span>
</span></span></code></pre></div><p>当解析到，使用到饮用的class时，JVM将会根据import找到你编译以后的class文件。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">MyClass</span> <span class="n">mine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyClass</span><span class="o">();</span>
</span></span></code></pre></div><p>当然VM不可能搜索所有你电脑上的文件，所以你需要提供一个路径的列表给VM去搜索。classpath就是提供一个jar file或者文件夹列表。</p>
<h2 id="如何设置classpath">如何设置classpath</h2>
<p>假设目前我们要引入一个==lib/CoolFramework.jar==的jar包，我们可以怎么做呢。</p>
<p>我们可以通过环境变量，像这样来搞定。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLASSPATH</span><span class="o">=</span>/home/myaccount/myproject/lib/CoolFramework.jar
</span></span></code></pre></div><p>但是环境变量是全局的，经常会引起冲突等等问题，所以这并不是一个好的方案。</p>
<p>我们也可以在command内指定引入的包。ex：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">java -cp <span class="s2">&#34;/home/myaccount/myproject/lib/CoolFramework.jar:/home/myaccount/myproject/output/&#34;</span>  MyMainClass
</span></span></code></pre></div><p>当然这样也很麻烦，我们在使用spring boot时，打成一个jar包，而jar包内则描述好了，classpath。</p>
<pre tabindex="0"><code>Manifest-Version: 1.0
Spring-Boot-Classpath-Index: BOOT-INF/classpath.idx
Built-By: sczyh30
Spring-Boot-Layers-Index: BOOT-INF/layers.idx
Start-Class: com.alibaba.csp.sentinel.dashboard.DashboardApplication
Spring-Boot-Classes: BOOT-INF/classes/
Spring-Boot-Lib: BOOT-INF/lib/
Spring-Boot-Version: 2.5.12
Created-By: Apache Maven 3.8.1
Build-Jdk: 1.8.0_152
Main-Class: org.springframework.boot.loader.JarLauncher
</code></pre>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>java的引用类型</h1>

<p>强引用(FinalReference)：
普通引用
JVM停止运行时终止
软引用(SoftReference)：
在类似于浏览器访问页面缓存的场景，比如点击回退，如果缓存了页面就直接展示，缓存被清除了再加载也没事。
内存不足时终止
弱引用(WeakReference)：
gc运行后终止
ThreadLocalMap的key，为了减少内存泄漏，在对象只有虚引用的时候，gc了就被清除了。
虚引用(PhantomReference)：
任何时候都可能</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>JSR</h1>

<p>Java Specification Requests
Pluggable Annotation Processing API</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>jvm</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>gc日志分析</h1>

<h2 id="开启gc日志">开启GC日志</h2>
<p>打开gc日志：-XX:+PrintGCDetails
指定输入位置：-Xloggc:$LOGS_DIR/gc.log</p>
<h2 id="分析日志">分析日志</h2>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220209110659.png" alt=""></p>
<p>GC (Allocation Failure)造成的young gc。</p>
<table>
<thead>
<tr>
<th>gc日志头</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>GC (Allocation Failure)</td>
<td>Allocation Failure表示向young generation(eden)给新对象申请空间，但是young generation(eden)剩余的合适空间不够所需的大小导致的minor gc。</td>
</tr>
<tr>
<td>Full GC (Ergonomics)</td>
<td>默认使用 UseParallelGC 垃圾回收器，该垃圾回收器默认启动了 AdaptiveSizePolicy。</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>java启动参数</h1>


            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>java程序的启动</h1>

<p>G1 GC收集器
-XX:MaxGCPauseMillis
期望的最大GC暂停时间，默认为：200ms。
-XX:ParallelGCThreads
默认根据运行JVM计算机的可用线程数决定
-XX:G1NewSizePercent
新生代初大小，默认为：5%。
-XX:G1MaxNewSizePercent
新生代最大大小，默认为：60%。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>jvm内存分析：</h1>

<h2 id="查看程序中对象数量">查看程序中对象数量</h2>
<p>jmap -histo pid |head -20</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>TLAB&amp;栈上分配</h1>

<p>栈上分配
为什么需要栈上分配</p>
<p>在我们的应用程序中，其实有很多的对象的作用域都不会逃逸出方法外，也就是说该对象的生命周期会随着方法的调用开始而开始，方法的调用结束而结束，对于这种对象，是不是该考虑将对象不在分配在堆空间中呢？
我们通过JVM内存分配可以知道JAVA中的对象都是在堆上进行分配，当对象没有被引用的时候，需要依靠GC进行回收内存，如果对象数量较多的时候，会给GC带来较大压力，也间接影响了应用的性能。</p>
<p>什么是栈上分配</p>
<p>所以,栈上分配是JVM提出的一种调优方案,JVM通过逃逸分析确定该对象不会被外部访问,如果不会逃逸可以将该对象在栈上分配内存，每个方法或者说每个线程都有属于自己独立的栈帧,随着方法的调用结束,这样该对象所占用的内存空间就可以随栈帧出栈而销毁，就减轻了垃圾回收的压力。</p>
<p>对象逃逸分析：就是分析对象动态作用域，当一个对象在方法中被定义后，它可能被外部方法所引用，例如作为调用参数传递到其他地方中。</p>
<p>分析如下案例:</p>
<p>public User test1(){
User user = new User();
user.setId(1);
user.setName(&ldquo;1&rdquo;);
return user;
}</p>
<p>public void test2(){
User user = new User();
user.setId(1);
user.setName(&ldquo;1&rdquo;);</p>
<pre><code>//保存数据库
//userMapper.save(user);
</code></pre>
<p>}
很显然test1方法中的user对象被返回了，这个对象的作用域范围不确定，test2方法中的user对象我们可以确定当方法结束这个对象就可以认为是无效对象了，对于这样的对象我们其实可以将其分配在栈内存里，让其在方法结束时跟随栈内存一起被回收掉。</p>
<p>JVM对于这种情况可以通过开启逃逸分析参数(-XX:+DoEscapeAnalysis)来优化对象内存分配位置，使其通过标量替换优先分配在栈上(栈上分配)，JDK7之后默认开启逃逸分析，如果要关闭使用参数(-XX:-DoEscapeAnalysis)</p>
<p>标量替换：通过逃逸分析确定该对象不会被外部访问，并且对象可以被进一步分解时，JVM不会创建该对象，而是将该对象成员变量分解若干个被这个方法使用的成员变量所代替，这些代替的成员变量在栈帧或寄存器上分配空间，这样就不会因为没有一大块连续空间导致对象内存不够分配。开启标量替换参数(-XX:+EliminateAllocations)，JDK7之后默认开启。</p>
<p>栈上分配的优点:</p>
<p>1.可以在方法调用结束后自行销毁对象,无需垃圾回收器的介入,有效减小JVM的GC压力
2.栈上分配速度很快,有效提高程序性能</p>
<p>栈上分配的缺点:</p>
<p>1.栈的空间是有限的,栈空间存放不了大对象,遇到大对象的创建则还是会存放在堆空间中</p>
<p>TLAB
可能很多人会有疑惑，已经提供了栈上分配，为什么还要有什么TLAB，甚至混淆了两者之间的差别，包括我自己，之前也存在很多疑惑，下面为大家揭开原因
全名: 本地线程分配缓冲(Thread Local Allocation Buffer,TLAB)，这是一个线程专用的内存分配区域。</p>
<p>为什么需要TLAB</p>
<p>在线程初始化时，同时也会申请一块指定大小的内存，只给当前线程使用，这样每个线程都单独拥有一个空间，如果需要分配内存，就在自己的空间上分配，这样就不存在竞争的情况，可以大大提升分配效率。</p>
<p>如何开启TLAB</p>
<p>JVM默认开启了TLAB功能，也可以使用-XX: +UseTLAB 显示开启</p>
<p>如何观察TLAB使用情况</p>
<p>JVM提供了-XX:+PrintTLAB 参数打开跟踪TLAB的使用情况</p>
<p>如何调整TLAB默认大小
-XX:TLABSize 通过该参数指定分配给每一个线程的TLAB空间的大小</p>
<p>简单理解</p>
<p>为了避免多线程情况下抢占空间,每个线程会提前在EDEN区中,额外划分一块内存区域,指定对象直接进入区域使用, jdk8默认开启</p>
<p>TLAB的缺点:</p>
<p>1.TLAB空间一般不会很大(占用了Eden区),所以大对象也无法在TLAB上进行分配,遇到大对象最终也只能分配到堆空间中</p>
<p>如下图:对象分配流程图</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220627210526.png" alt=""></p>
<p>最后栈上分配和TLAB的对比</p>
<p>名称	针对点	处于对象分配流程的位置
栈上分配	减少GC的负担	1
TLAB	加速堆上对象分配速度	2</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>类加载</h1>

<h2 id="java类加载过程">java类加载过程</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212212238466.png" alt="截屏2022-12-21 22.37.57.png">
其中loadClass的类加载过程有如下几步:<br>
加载 &raquo; 验证 &raquo; 准备 &raquo; 解析 &raquo; 初始化 &raquo; 使用 &raquo; 卸载</p>
<p>加载:在硬盘上查找并通过IO读入字节码文件，使用到类时才会加载，例如调用类的 main()方法，new对象等等，在加载阶段会在内存中生成一个代表这个类的 java.lang.Class对象，作为方法区这个类的各种数据的访问入口</p>
<p>验证:校验字节码文件的正确性 准备:给类的静态变量分配内存，并赋予默认值</p>
<p>解析:将符号引用替换为直接引用，该阶段会把一些静态方法(符号引用，比如main()方法)替换为指向数据所存内存的指针或句柄等(直接引用)，这是所谓的静态链接过 程(类加载期间完成)，动态链接是在程序运行期间完成的将符号引用替换为直接引用</p>
<p>初始化:对类的静态变量初始化为指定的值，执行静态代码块</p>
<p>类被加载到方法区中后主要包含 运行时常量池、类型信息、字段信息、方法信息、类加载器的 引用、对应class实例的引用等信息。</p>
<h2 id="classloader">ClassLoader</h2>
<p>所有类加载器的基类，它是抽象的，定义了类加载最核心的操作。所有继承与classloader的加载器，都会优先判断是否被父类加载器加载过，防止多次加载，防止加载冲突。看一下核心代码loadClass</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">protected</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">loadClass</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">resolve</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">    <span class="kd">throws</span> <span class="n">ClassNotFoundException</span>  
</span></span><span class="line"><span class="cl"><span class="o">{</span>  
</span></span><span class="line"><span class="cl">	<span class="c1">// 加锁防止重复加载
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">getClassLoadingLock</span><span class="o">(</span><span class="n">name</span><span class="o">))</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="c1">// First, check if the class has already been loaded  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">findLoadedClass</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="kt">long</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                    <span class="n">c</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="na">loadClass</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	                <span class="c1">//找不到父classLoader就是最顶级的classLoader：bootstrapClassLoader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">c</span> <span class="o">=</span> <span class="n">findBootstrapClassOrNull</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="o">}</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// ClassNotFoundException thrown if class not found  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// from the non-null parent class loader           
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// If still not found, then invoke findClass in order  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// to find the class.                
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="kt">long</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">                <span class="n">c</span> <span class="o">=</span> <span class="n">findClass</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">                <span class="c1">// this is the defining class loader; record the stats  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">sun</span><span class="o">.</span><span class="na">misc</span><span class="o">.</span><span class="na">PerfCounter</span><span class="o">.</span><span class="na">getParentDelegationTime</span><span class="o">().</span><span class="na">addTime</span><span class="o">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">sun</span><span class="o">.</span><span class="na">misc</span><span class="o">.</span><span class="na">PerfCounter</span><span class="o">.</span><span class="na">getFindClassTime</span><span class="o">().</span><span class="na">addElapsedTimeFrom</span><span class="o">(</span><span class="n">t1</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">sun</span><span class="o">.</span><span class="na">misc</span><span class="o">.</span><span class="na">PerfCounter</span><span class="o">.</span><span class="na">getFindClasses</span><span class="o">().</span><span class="na">increment</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">resolve</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">resolveClass</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">c</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="bootstrapclassloader">BootStrapClassLoader</h2>
<p>位于java.lang.classload，所有的classload都要经过这个classload判断是否已经被加载过，采用native code实现，是JVM的一部分，主要加载JVM自身工作需要的类，如java.lang.、java.uti.等； 这些类位于$JAVA_HOME/jre/lib/rt.jar。Bootstrap ClassLoader不继承自ClassLoader，因为它不是一个普通的Java类，底层由C++编写，已嵌入到了JVM内核当中，当JVM启动后，Bootstrap ClassLoader也随着启动，负责加载完核心类库后，并构造Extension ClassLoader和App ClassLoader类加载器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Returns a class loaded by the bootstrap class loader; * or return null if not found. */</span><span class="kd">private</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">findBootstrapClassOrNull</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl"><span class="o">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(!</span><span class="n">checkName</span><span class="o">(</span><span class="n">name</span><span class="o">))</span> <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">findBootstrapClass</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>  
</span></span><span class="line"><span class="cl"><span class="c1">// 这里就是native了
</span></span></span><span class="line"><span class="cl"><span class="c1">// return null if not found  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">private</span> <span class="kd">native</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">findBootstrapClass</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">);</span>
</span></span></code></pre></div><h2 id="secureclassloader">SecureClassLoader</h2>
<p>继承了ClassLoader，主要是对ClassLoader进行了限制，只允许加载指定路径下的class</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221221112308.png" alt="image.png"></p>
<h2 id="urlclassloader">URLClassLoader</h2>
<p>继承自secureClassLoader，这个类加载器用于从引用JAR文件和目录的url的搜索路径加载类和资源。任何以“/”结尾的URL都被认为指向目录。否则，URL被假定为引用一个JAR文件，该文件将在需要时打开。 创建URLClassLoader实例的线程的AccessControlContext将在随后加载类和资源时使用。 默认情况下，被加载的类只被授予访问创建URLClassLoader时指定的url的权限。</p>
<h2 id="打破双亲委派">打破双亲委派</h2>
<p>tomcat</p>
<blockquote>
<p>相关资料：
<a href="https://blog.csdn.net/weixin_50020236/article/details/124098698">https://blog.csdn.net/weixin_50020236/article/details/124098698</a></p>
</blockquote>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>lib</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>cglib</h1>

<p>操作字节码生成代理类</p>
<p>Class UserServiceProxy extends UserService{
public void test(){
//切面逻辑
super.test()
}
//切面逻辑
}</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>hibernate-validator 校验器</h1>

<p><a href="https://docs.jboss.org/hibernate/validator/6.2/reference/en-US/html_single/#validator-gettingstarted">https://docs.jboss.org/hibernate/validator/6.2/reference/en-US/html_single/#validator-gettingstarted</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>MapStruct-类型安全的bean转换工具</h1>

<h1 id="简介">简介</h1>
<p>mapStruct 是一个类型安全的bean转换工具，基于 <a href="http://www.jcp.org/en/jsr/detail?id=269">JSR 269</a> ，也同样可以使用命令行构建。</p>
<blockquote>
<p>详细文档：https://mapstruct.org/documentation/stable/reference/html/#customizing-mappings-with-before-and-after</p>
</blockquote>
<h1 id="依赖引入">依赖引入</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;org.mapstruct.version&gt;</span>1.5.2.Final<span class="nt">&lt;/org.mapstruct.version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.mapstruct<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>mapstruct<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>${org.mapstruct.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 如果和lombok 结合可能有贬义冲突，需要配置如下 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>3.8.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;source&gt;</span>1.8<span class="nt">&lt;/source&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;target&gt;</span>1.8<span class="nt">&lt;/target&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;annotationProcessorPaths&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;path&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;groupId&gt;</span>org.mapstruct<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;artifactId&gt;</span>mapstruct-processor<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;version&gt;</span>${org.mapstruct.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;/path&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/annotationProcessorPaths&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></div><h1 id="使用">使用</h1>
<h2 id="基础">基础</h2>
<h3 id="定义一个基础mapping">定义一个基础mapping</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CarMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;manufacturer&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;make&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;seatCount&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;numberOfSeats&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">CarDto</span> <span class="nf">carToCarDto</span><span class="o">(</span><span class="n">Car</span> <span class="n">car</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;fullName&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">PersonDto</span> <span class="nf">personToPersonDto</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>mapStruct会再在编译期生成对应的映射方法，依赖于get set方法，所以需要提前写好get&amp;set方法。</p>
<h3 id="映射编排-mapping-composition">映射编排 Mapping Composition</h3>
<p>可以定义一个注解，组合编排mapping</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">ignore</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;creationDate&#34;</span><span class="o">,</span> <span class="n">expression</span> <span class="o">=</span> <span class="s">&#34;java(new java.util.Date())&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;groupName&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ToEntity</span> <span class="o">{</span> <span class="o">}</span>
</span></span></code></pre></div><h3 id="自定义方法">自定义方法</h3>
<p>如果有一些需要手写的方法，可以自定义一个方法，再Mapping方法中如果用到了类型转转，会自动使用我们自定义的方法。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CarMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(...)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">CarDto</span> <span class="nf">carToCarDto</span><span class="o">(</span><span class="n">Car</span> <span class="n">car</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="n">PersonDto</span> <span class="nf">personToPersonDto</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//hand-written mapping logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="使用sourcetarget参数">使用source&amp;target参数</h3>
<p>如果source和target不能通过变量名自动转化，那么可以使用注解手动映射。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AddressMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;description&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;person.description&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;houseNumber&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;address.houseNo&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">DeliveryAddressDto</span> <span class="nf">personAndAddressToDeliveryAddressDto</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">,</span> <span class="n">Address</span> <span class="n">address</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="嵌套nestedbean映射">嵌套（nested）bean映射</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomerMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="nd">@Mapping</span><span class="o">(</span> <span class="n">target</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;record.name&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">     <span class="nd">@Mapping</span><span class="o">(</span> <span class="n">target</span> <span class="o">=</span> <span class="s">&#34;.&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;record&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">     <span class="nd">@Mapping</span><span class="o">(</span> <span class="n">target</span> <span class="o">=</span> <span class="s">&#34;.&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;account&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">Customer</span> <span class="nf">customerDtoToCustomer</span><span class="o">(</span><span class="n">CustomerDto</span> <span class="n">customerDto</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div><p>其中 <mark>&quot;.&quot;</mark> 代表this对象</p>
<h3 id="更新已经创建的bean">更新已经创建的bean</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CarMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">updateCarFromDto</span><span class="o">(</span><span class="n">CarDto</span> <span class="n">carDto</span><span class="o">,</span> <span class="nd">@MappingTarget</span> <span class="n">Car</span> <span class="n">car</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="没有getset-但是是public修饰时">没有get/set 但是是public修饰时</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//getters and setter omitted for brevity
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomerDto</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="n">customerName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomerMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">CustomerMapper</span> <span class="n">INSTANCE</span> <span class="o">=</span> <span class="n">Mappers</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span> <span class="n">CustomerMapper</span><span class="o">.</span><span class="na">class</span> <span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;customerName&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Customer</span> <span class="nf">toCustomer</span><span class="o">(</span><span class="n">CustomerDto</span> <span class="n">customerDto</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@InheritInverseConfiguration</span>
</span></span><span class="line"><span class="cl">    <span class="n">CustomerDto</span> <span class="nf">fromCustomer</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="支持builderconstructor创建影射对象">支持builder&amp;constructor创建影射对象</h3>
<h3 id="支持map结构映射">支持map结构映射</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//getters and setter omitted for brevity
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomerMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Mapping</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&#34;customerName&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Customer</span> <span class="nf">toCustomer</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>META-INF和WEB-INFO</h1>

<h2 id="meta-inf">META-INF</h2>
<h2 id="the-meta-inf-directory">The META-INF directory</h2>
<p>The following files/directories in the META-INF directory are recognized and interpreted by the Java 2 Platform to configure applications, extensions, class loaders and services:</p>
<ul>
<li><code>MANIFEST.MF</code></li>
</ul>
<p>The manifest file that is used to define extension and package related data.
主要的清单文件，包括版本等信息
比如下面这个asm的MF文件</p>
<pre tabindex="0"><code>Manifest-Version: 1.0  
Ant-Version: Apache Ant 1.6.5  
Created-By: 1.6.0_02-b05 (Sun Microsystems Inc.)  
Implementation-Title: ASM  
Implementation-Version: 3.1  
Implementation-Vendor: France Telecom R&amp;D
</code></pre><ul>
<li><code>INDEX.LIST</code></li>
</ul>
<p>This file is generated by the new &ldquo;<code>-i</code>&rdquo; option of the jar tool, which contains location information for packages defined in an application or extension. It is part of the JarIndex implementation and used by class loaders to speed up their class loading process.</p>
<ul>
<li><code>x.SF</code></li>
</ul>
<p>The signature file for the JAR file. &lsquo;x&rsquo; stands for the base file name.</p>
<ul>
<li><code>x.DSA</code></li>
</ul>
<p>The signature block file associated with the signature file with the same base file name. This file stores the digital signature of the corresponding signature file.</p>
<ul>
<li><code>services/</code></li>
</ul>
<p>This directory stores all the service provider configuration files.</p>
<p>SPI和springAutoConfig等都会使用这个路径</p>
<h2 id="web-inf">WEB-INF</h2>
<p>servlet技术使用文件夹，经常会放置一些网页和web.xml等配置</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>内存结构</h1>

<p>逻辑划分：</p>
<p>Hot spot 实现</p>
<p>虚拟机栈：</p>
<p>每个方法被执行事会生成一个栈桢（Stack   Frame）用于存储局部变量表，操作数栈、动态链接、方法出口等</p>
<p>本地方法栈：</p>
<p>与虚拟机栈功能相似，服务于native方法。Hot-spot把本地方法栈与虚拟机栈合二为一。</p>
<p>堆：</p>
<p>对象存储的地方，有些对象存储在栈上，依靠内存逃逸。</p>
<p>方法区：</p>
<p>存放类的信息，常量、静态变量、及时编译后的代码缓存。</p>
<p>运行时常量池：</p>
<p>Java程序要运行时，需要编译器先将源代码文件编译成字节码（.class)文件，然后在由JVM解释执行。</p>
<p>class文件中除了有类的版本、字段、方法、接口等描述信息外,还有一项信息是常量池(Constant pool table)，用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入运行时常量池中存放。</p>
<p>静态常量池就是上面说的class文件中的常量池。class常量池是在编译时每个class文件中都存在。不同的符号信息放置在不同标志的常量表中。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>并发编程</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>Future、CompletableFuture</h1>

<h2 id="future模式和callable模式">Future模式和Callable模式</h2>
<p>创建线程的方式只有两种：继承Thread或者实现Runnable接口。 但是这两种方法都存在一个缺陷，没有返回值，也就是说我们无法得知线程执行结果。虽然简单场景下已经满足，但是当我们需要返回值的时候怎么办呢？ Java 1.5 以后的Callable和Future接口就解决了这个问题，我们可以通过向线程池提交一个Callable来获取一个包含返回值的Future对象，从此，我们的程序逻辑就不再是同步顺序。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221202161648.png" alt="">
上图中，A为Callable模式、B为Future模式。当然他们并不是互斥的，Future通常使用的时候要配置Callable。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221202191402.png" alt=""></p>
<h2 id="future相关">Future相关</h2>
<h3 id="future接口">Future接口：</h3>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221202165155.png" alt=""></p>
<ul>
<li>cancel（boolean） 暂停任务，参数为true则如果任务已经拿到线程开始执行了，仍然可以中断Interrupt任务。</li>
<li>isCanncelled()配合cancel（boolean）</li>
<li>isDone() 任务是否已经结束，如果被cancel 则返回True。</li>
<li>get() throws InterruptedException, ExecutionException;同步等待获取任务结果</li>
<li>get(long,TimeUinit) throws InterruptedException, ExecutionException, TimeoutException;设置同步等待时间，如果超时返回TimeoutException。</li>
</ul>
<h3 id="future的实现类之一-futuretask">Future的实现类之一 ：FutureTask</h3>
<p>类图：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212031735119.png" alt=""></p>
<p>简单使用一下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FutureTask</span><span class="o">&lt;&gt;(()</span> <span class="o">-&gt;</span> <span class="s">&#34;run a task&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl"><span class="n">Executors</span><span class="o">.</span><span class="na">newSingleThreadExecutor</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="n">future</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;futureResult: &#34;</span> <span class="o">+</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</span></span></code></pre></div><h2 id="future的局限性">Future的局限性</h2>
<p>从本质上说，Future表示一个异步计算的结果。它提供了isDone()来检测计算是否已经完成， 并且在计算结束后，可以通过get()方法来获取计算结果。在异步计算中，Future确实是个非常 优秀的接口。但是，它的本身也确实存在着许多限制：</p>
<ul>
<li>并发执行多任务：Future只提供了get()方法来获取结果，并且是阻塞的。所以，除 了等待你别无他法；</li>
<li>无法对多个任务进行链式调用：如果你希望在计算任务完成后执行特定动作，比如 发邮件，但Future却没有提供这样的能力；</li>
<li>无法组合多个任务：如果你运行了10个任务，并期望在它们全部执行结束后执行特 定动作，那么在Future中这是无能为力的；</li>
<li>没有异常处理：Future接口中没有关于异常处理的方法；</li>
</ul>
<h2 id="completablefuture-完善的future">CompletableFuture 完善的Future</h2>
<p>Future并不完善，所以在后续版本中又推出了CompletableFuture，客服了Future的局限。</p>
<h3 id="常用api">常用API</h3>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212032042074.png" alt=""></p>
<h3 id="来个例子">来个例子</h3>
<p>著名数学家华罗庚先生在《统筹方法》这篇文章里介绍了一个烧水泡茶的例子，文中提到最优的工序应该是下面这样：</p>
<p><img src="https://note.youdao.com/yws/public/resource/0e961b20b4e7a0b21fab4ed9f88c1ac5/xmlnote/FC145BB4E0E14E96B1AF81AF6F47F103/1939" alt="0">
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212032043808.png" alt="">
对于烧水泡茶这个程序，一种最优的分工方案：用两个线程 T1 和 T2 来完成烧水泡茶程序，T1 负责洗水壶、烧开水、泡茶这三道工序，T2 负责洗茶壶、洗茶杯、拿茶叶三道工序，其中 T1 在执行泡茶这道工序时需要等待 T2 完成拿茶叶的工序。</p>
<p>基于Future实现</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FutureTaskDemo3</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ExecutionException</span><span class="o">,</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建任务T2的FutureTask
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ft2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FutureTask</span><span class="o">&lt;&gt;(</span><span class="k">new</span> <span class="n">T2Task</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建任务T1的FutureTask
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ft1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FutureTask</span><span class="o">&lt;&gt;(</span><span class="k">new</span> <span class="n">T1Task</span><span class="o">(</span><span class="n">ft2</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 线程T1执行任务ft1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Thread</span> <span class="n">T1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ft1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">T1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 线程T2执行任务ft2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Thread</span> <span class="n">T2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ft2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">T2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 等待线程T1执行结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ft1</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// T1Task需要执行的任务：
</span></span></span><span class="line"><span class="cl"><span class="c1">// 洗水壶、烧开水、泡茶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">class</span> <span class="nc">T1Task</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ft2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// T1任务需要T2任务的FutureTask
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">T1Task</span><span class="o">(</span><span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ft2</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">ft2</span> <span class="o">=</span> <span class="n">ft2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:洗水壶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:烧开水...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">15</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 获取T2线程的茶叶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span> <span class="n">tf</span> <span class="o">=</span> <span class="n">ft2</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:拿到茶叶:&#34;</span><span class="o">+</span><span class="n">tf</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:泡茶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;上茶:&#34;</span> <span class="o">+</span> <span class="n">tf</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>基于CompletableFuture实现</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompletableFutureDemo2</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//任务1：洗水壶-&gt;烧开水
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">CompletableFuture</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">runAsync</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:洗水壶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:烧开水...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">15</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//任务2：洗茶壶-&gt;洗茶杯-&gt;拿茶叶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">CompletableFuture</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">supplyAsync</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T2:洗茶壶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T2:洗茶杯...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T2:拿茶叶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="s">&#34;龙井&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//任务3：任务1和任务2完成后执行：泡茶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">f3</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="na">thenCombine</span><span class="o">(</span><span class="n">f2</span><span class="o">,</span> <span class="o">(</span><span class="n">__</span><span class="o">,</span> <span class="n">tf</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:拿到茶叶:&#34;</span> <span class="o">+</span> <span class="n">tf</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T1:泡茶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="s">&#34;上茶:&#34;</span> <span class="o">+</span> <span class="n">tf</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//等待任务3执行结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f3</span><span class="o">.</span><span class="na">join</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">		<span class="c1">//当然这里也可以
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">CompletableFuture</span><span class="o">.</span><span class="na">allOf</span><span class="o">(</span><span class="n">f1</span><span class="o">,</span><span class="n">f2</span><span class="o">).</span><span class="na">join</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;拿到茶叶:&#34;</span> <span class="o">+</span> <span class="n">tf</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;泡茶...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>注释</h1>

<p>学习一手spring的注视，不再抓瞎。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Return the auto-configuration class names that should be considered. By default * this method will load candidates using {@link SpringFactoriesLoader} with  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * {@link #getSpringFactoriesLoaderFactoryClass()}.  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param metadata the source metadata  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param attributes the {@link #getAttributes(AnnotationMetadata) annotation  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * attributes} * @return a list of candidate configurations  
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>office</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>excel公式</h1>

<h2 id="统计字符出现个数">统计字符出现个数</h2>
<p>=LEN(G13)-LEN(SUBSTITUTE(G13,&quot;、&quot;,&quot;&quot;))+1</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>python</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>python语法知识</h1>

<h1 id="类型">类型</h1>
<h2 id="标准数据类型">标准数据类型</h2>
<p>Python3 中有六个标准的数据类型：</p>
<p>**不可变数据（3 个）</p>
<ul>
<li>Number（数字）
<ul>
<li> <strong>int、float、bool、complex</strong>。其中bool是int的子类。False == 0</li>
</ul>
</li>
<li>String（字符串）</li>
<li>Tuple（元组）</li>
</ul>
<p>**可变数据（3 个）</p>
<ul>
<li>List（列表）</li>
<li>Set（集合）</li>
<li>Dictionary（字典）
Python3 的六个标准数据类型中：</li>
</ul>
<h3 id="列表">列表</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 简单浅拷贝</span>
</span></span><span class="line"><span class="cl"> <span class="n">squares</span><span class="p">[:]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 合并</span>
</span></span><span class="line"><span class="cl"><span class="n">squares1</span><span class="o">+</span><span class="n">squares2</span>
</span></span></code></pre></div><h4 id="列表推导">列表推导</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">char_list</span><span class="o">=</span><span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;ABC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
</span></span></code></pre></div><h4 id="生成器表达式">生成器表达式</h4>
<p>虽然也可以用列表推导来初始化元组、数组或其他序列类型，但是生成器表达式是更好的选择。这是因为生成器表达式背后遵守了迭代器协议，可以逐个地产出元素，而不是先建立一个完整的列表，然后再把这个列表传递到某个构造函数里。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">tshirt</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colors</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="n">tshirt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">black</span> <span class="n">S</span>
</span></span><span class="line"><span class="cl"><span class="n">black</span> <span class="n">M</span>
</span></span><span class="line"><span class="cl"><span class="n">black</span> <span class="n">L</span>
</span></span><span class="line"><span class="cl"><span class="n">white</span> <span class="n">S</span>
</span></span><span class="line"><span class="cl"><span class="n">white</span> <span class="n">M</span>
</span></span><span class="line"><span class="cl"><span class="n">white</span> <span class="n">L</span>
</span></span></code></pre></div><h4 id="元组">元组</h4>
<p>元组和记录元组其实是对数据的记录：元组中的每个元素都存放了记录中一个字段的数据，外加这个字段的位置。正是这个位置信息给数据赋予了意义。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">city</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">chg</span><span class="p">,</span> <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Tokyo&#39;</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">32450</span><span class="p">,</span> <span class="mf">0.66</span><span class="p">,</span> <span class="mi">8014</span><span class="p">)</span>  
</span></span></code></pre></div><h2 id="对象">对象</h2>
<h3 id="python对象三要素">python对象三要素</h3>
<p>id（对象地址）、type、value</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">l1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">l2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 调用对象__eq__()</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span><span class="n">l1</span><span class="o">==</span><span class="n">l2</span>
</span></span><span class="line"><span class="cl"><span class="n">true</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 对比内存地址</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span><span class="n">l1</span> <span class="ow">is</span> <span class="n">l2</span>
</span></span><span class="line"><span class="cl"><span class="n">false</span>
</span></span></code></pre></div><h3 id="赋值浅拷贝copy深拷贝deepcopy">赋值(=)、浅拷贝(copy())、深拷贝(deepcopy()</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#赋值</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#浅拷贝</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="o">=</span><span class="n">copy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#深拷贝</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="运算">运算</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#除法运算</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mf">2.5</span>
</span></span><span class="line"><span class="cl"><span class="c1">#除法&amp;向上取整</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span><span class="mi">5</span><span class="o">//</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 从左到右连续运算</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&lt;=</span><span class="mi">3</span><span class="o">!=</span><span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="kc">True</span>
</span></span></code></pre></div><p>向上取整: 5//2= 2</p>
<h2 id="集合框架">集合框架</h2>
<h3 id="collections">collections</h3>
<p>这个模块实现了特定目标的容器，以提供Python标准内建容器 <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#dict" title="dict"><code>dict</code></a> , <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#list" title="list"><code>list</code></a> , <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#set" title="set"><code>set</code></a> , 和 <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#tuple" title="tuple"><code>tuple</code></a> 的替代选择。</p>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td>namedtuple()</td>
<td>创建命名元组子类的工厂函数</td>
</tr>
<tr>
<td>deque</td>
<td>类似列表(list)的容器，实现了在两端快速添加(append)和弹出(pop)</td>
</tr>
<tr>
<td>chainMap</td>
<td>类似字典(dict)的容器类，将多个映射集合到一个视图里面</td>
</tr>
<tr>
<td>Counter</td>
<td>字典的子类，提供了可哈希对象的计数功能</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.deque" title="collections.deque"><code>deque</code></a></p>
<p>类似列表(list)的容器，实现了在两端快速添加(append)和弹出(pop)</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.ChainMap" title="collections.ChainMap"><code>ChainMap</code></a></p>
<p>类似字典(dict)的容器类，将多个映射集合到一个视图里面</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.Counter" title="collections.Counter"><code>Counter</code></a></p>
<p>字典的子类，提供了可哈希对象的计数功能</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.OrderedDict" title="collections.OrderedDict"><code>OrderedDict</code></a></p>
<p>字典的子类，保存了他们被添加的顺序</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.defaultdict" title="collections.defaultdict"><code>defaultdict</code></a></p>
<p>字典的子类，提供了一个工厂函数，为字典查询提供一个默认值</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.UserDict" title="collections.UserDict"><code>UserDict</code></a></p>
<p>封装了字典对象，简化了字典子类化</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.UserList" title="collections.UserList"><code>UserList</code></a></p>
<p>封装了列表对象，简化了列表子类化</p>
<p><a href="https://docs.python.org/zh-cn/3/library/collections.html#collections.UserString" title="collections.UserString"><code>UserString</code></a></p>
<p>封装了字符串对象，简化了字符串子类化</p>
<h2 id="循环">循环</h2>
<p>python的for循环只能使用迭代模式
for w in words:
pass</p>
<h3 id="range">range</h3>
<p>如果需要index需要配合range()函数</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mary&#39;</span><span class="p">,</span> <span class="s1">&#39;had&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="s1">&#39;lamb&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span></code></pre></div><h3 id="enumerate">enumerate</h3>
<p>但是多数情况下enumerate更加方便</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;tic&#39;</span><span class="p">,</span> <span class="s1">&#39;tac&#39;</span><span class="p">,</span> <span class="s1">&#39;toe&#39;</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> 
</span></span></code></pre></div><h3 id="zip">zip</h3>
<p>如果需要同时遍历多个数组可以使用zip</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">questions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;quest&#39;</span><span class="p">,</span> <span class="s1">&#39;favorite color&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">answers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lancelot&#39;</span><span class="p">,</span> <span class="s1">&#39;the holy grail&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">questions</span><span class="p">,</span> <span class="n">answers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;What is your </span><span class="si">{0}</span><span class="s1">?  It is </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">What</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">name</span><span class="err">?</span>  <span class="n">It</span> <span class="ow">is</span> <span class="n">lancelot</span><span class="o">.</span>
</span></span></code></pre></div><h2 id="小技巧">小技巧</h2>
<h3 id="提前给数组分配内容">提前给数组分配内容</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>时间处理</h1>

<h1 id="datetime-包">datetime 包</h1>
<h2 id="datetime类">datetime类</h2>
<h3 id="根据string-生成datetime">根据String 生成datetime</h3>
<pre tabindex="0"><code>datetime.datetime.strptime(&#39;2017-3-22 15:25&#39;,&#39;%Y-%m-%d %H:%M&#39;)
</code></pre><p><a href="https://docs.python.org/3/library/datetime.html#examples-of-usage-datetime">https://docs.python.org/3/library/datetime.html#examples-of-usage-datetime</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>绘图库matplotlib</h1>

<h1 id="基础信息">基础信息</h1>
<p>名字解释
mat = matrix (矩阵) 制图时常常需要使用到运算，同理matlab中的mat也是这个意思。
plot= 绘制</p>
<p>官方网站：
<a href="https://matplotlib.org/stable/index.html">https://matplotlib.org/stable/index.html</a></p>
<h1 id="概念">概念：</h1>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220910213337.png" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></div><h2 id="figure">figure</h2>
<p>画板，包含多个axes和artists</p>
<p>fig = plt.figure()  # an empty figure with no Axes</p>
<p>fig, ax = plt.subplots()  # a figure with a single Axes
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/%E6%88%AA%E5%B1%8F2022-09-10%2021.52.35.png" alt="">
fig, axs = plt.subplots(2, 2)  # a figure with a 2x2 grid of Axes
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/%E6%88%AA%E5%B1%8F2022-09-10%2021.55.47.png" alt=""></p>
<h2 id="axes">axes</h2>
<p>轴集合, 可以是x轴y轴，3d的会有z轴。</p>
<h2 id="axis">axis</h2>
<p>轴</p>
<h2 id="artist">artist</h2>
<p>everything visible on the Figure is an Artist</p>
<h1 id="相关问题">相关问题</h1>
<h2 id="中文显示问题">中文显示问题</h2>
<p>1、先输出所有字体，找到中文字体</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.font_manager</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">ttflist</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></div><p>2、设置对应字体</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&#34;font.sans-serif&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Songti SC&#34;</span><span class="p">]</span> <span class="c1"># 设置字体</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>spring</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>@Configuration</h1>

<p>@Configuration+@Bean</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="n">JDBCTempalte</span> <span class="nf">t1</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="n">TranslationManager</span> <span class="nf">transactionManager</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="n">DataSource</span> <span class="nf">dataSource</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">		<span class="n">xxx</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>@Bean 修饰方法后，方法名作为beanname 加入叫spring容器
被Configuration修饰以后，该对象将变成代理对象，在获取bean修饰的方法时，如果spring容器有bean则会直接返回，没有会执行并生成bean</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>aop</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>AOP使用</h1>


            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>mvc</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>异步模式</h1>

<p><a href="https://blog.51cto.com/u_3631118/3121421">https://blog.51cto.com/u_3631118/3121421</a></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>spring bean</h1>

<h1 id="生命周期">生命周期</h1>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/springbean%E6%B5%81%E7%A8%8B.png" alt="">
补充：
@PostConstruct 代表bean构建完成后置处理，在属性注入之后，基于初始化前实现 beanPostProcessor .beforeInitlazation。</p>
<h1 id="循环依赖">循环依赖</h1>
<h2 id="三级缓存">三级缓存</h2>
<h3 id="singletonfactories">singletonFactories</h3>
<p>对象工厂，表示用来创建早期bean对象的工厂,存放的就是个Function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">addSingletonFactory</span><span class="o">(</span><span class="n">beanName</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">getEarlyBeanReference</span><span class="o">(</span><span class="n">beanName</span><span class="o">,</span> <span class="n">mbd</span><span class="o">,</span> <span class="n">bean</span><span class="o">));</span>
</span></span></code></pre></div><p>getEarlyBeanReference 默认不会做任何处理，如果需要aop会生成代理类。</p>
<h3 id="earlysingletonobjects">earlySingletonObjects</h3>
<p>早期bean，未完成依赖注入，但是已经经过AOP。</p>
<h3 id="singletonobjects">singletonObjects</h3>
<p>依赖注入完成的bean</p>
<h2 id="存放顺序">存放顺序</h2>
<p>singletonFactories&ndash;&gt;earlySingletionObjects&ndash;&gt;singletonObjects</p>
<h2 id="读取顺序">读取顺序</h2>
<p>singletonObjects&ndash;&gt;earlySingletionObjects&ndash;&gt;singletonFactories</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>Spring cache</h1>

<p>spring cache是spring对各种cache的一种抽象管理，可以使用redis、caffeine等。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;--</span> <span class="err">必要</span> <span class="err">--</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-cache<span class="nt">&lt;/artifactId&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>2.2.5.RELEASE<span class="nt">&lt;/version&gt;</span>  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;--</span> <span class="err">缓存中一种</span> <span class="err">--</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.github.ben-manes.caffeine<span class="nt">&lt;/groupId&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>caffeine<span class="nt">&lt;/artifactId&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>2.9.2<span class="nt">&lt;/version&gt;</span>  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>  
</span></span></code></pre></div><p>在使用缓存之前，需要创建一个CacheManager</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="nd">@Bean</span>  
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">CacheManager</span> <span class="nf">cacheManager</span><span class="o">()</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">CaffeineCacheManager</span> <span class="n">caffeineCacheManager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CaffeineCacheManager</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">    <span class="n">caffeineCacheManager</span><span class="o">.</span><span class="na">setCaffeine</span><span class="o">(</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Caffeine</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">()</span>  
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">expireAfterWrite</span><span class="o">(</span><span class="n">10</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">maximumSize</span><span class="o">(</span><span class="n">10_000</span><span class="o">));</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">caffeineCacheManager</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p><a href="http://t.zoukankan.com/hager-p-13197673.html">http://t.zoukankan.com/hager-p-13197673.html</a></p>
<p><a href="https://www.freesion.com/article/401730391/">https://www.freesion.com/article/401730391/</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>spring Context</h1>

<p>BeanFactory
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220830152458.png" alt=""></p>
<p>ApplicationContext
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220830152510.png" alt=""></p>
<p>ApplicationContext 也实现了beanFactory，实际上具体实现依靠获取Context内的BeanFacoty实例<strong>DefaultListableBeanFactory</strong> 来实现功能的。</p>

<div class="mermaid" align="center">graph TD

10[ContextLoaderListener.contextInitialized]

--创建WebApplicationContext-->15[ContextLoader.initWebApplicationContext]

--> 18[configureAndRefreshWebApplicationContext]

--初始化context-->20

subgraph refresh

20[ConfigurableApplicationContext.refresh]

--prepareRefresh-->21[准备刷新:包括spring环境等]

-- obtainFreshBeanFactory-->22[创建bean工厂]

-- prepareBeanFactory-->23[bean工厂初始化配置]

-- postProcessBeanFactory -->24[添加beanFactory的后置护理器]

-- invokeBeanFactoryPostProcessors -->25[调用beanFactory后置处理器.bean扫描是在这一步操作的]

-- registerBeanPostProcessors -->26[注册bean后置处理器,这里添加autowired等后置处理器]

-- initMessageSource -->27[国际化等]

-- initApplicationEventMulticaster-->28[创基一个事件广播器来处理事件]

-- onRefresh -->29[初始化前添加特殊bean 默认啥都不干]

-- registerListeners --> 30[注册event listener]

-- finishBeanFactoryInitialization -->31[初始化剩余的bean,普通的bean会在这一部进行createBean操作]

-- finishRefresh-->32[主要是发送ContextRefreshedEvent 通知完成refresh]

end</div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>spring mvc</h1>

<p>Spring Web MVC是基于Servlet API构建的原始Web框架，从一开始就已包含在Spring框架中。正式名 称“ Spring Web MVC”来自其源模块的名称(spring-webmvc)，但它通常被称为“ Spring MVC”。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220823154550.png" alt=""></p>
<ol>
<li>xml下配置servlet的映射非常麻烦 开发效率低</li>
<li>必须要继承父类、重写方法 侵入性强</li>
<li>如果想在一个Servlet中处理同一业务模块的的功能分发给不同方法进行处理非常麻烦</li>
<li>参数解析麻烦:单个参数（转换类型）&mdash;&gt;pojo对象 Json文本&mdash;&gt;pojo对象</li>
<li>数据响应麻烦:pojo对象&mdash;&gt;json &hellip; Content-type</li>
<li>跳转页面麻烦, 对path的控制、 如果使用其他模板也很麻烦 、设置编码麻烦&hellip;等等&hellip;</li>
</ol>
<p>所以SpringMVC 就是在Servlet的基础上进行了封装，帮我把这些麻烦事都给我们做了。</p>
<p>核心方法在 DispatcherServlet::doDispatch</p>
<h2 id="需要了解的类和方法">需要了解的类和方法</h2>
<h3 id="requestmappinghandler">RequestMappingHandler</h3>
<p>请求映射处理器，用于将一个request和一个handler给映射起来。有好多种形式进行映射，常见的是BeanNameUrlHandlerMapping（bean name和url映射）和DefaultAnnotationHandlerMapping（RequestMapping等注解映射），一般都用DefaultAnnotationHandlerMapping,mvc使用<a href="mvc:annotation-driven">mvc:annotation-driven</a>开启。</p>
<h3 id="requestmappinghandlermapping">RequestMappingHandlerMapping</h3>
<p>,</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220823154557.png" alt=""></p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/26943.png" alt=""></p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220912173443.png" alt=""></p>
<p>dispatcherServlet是核心分分发器，其核心方法时doDispatch()。
根据请求路径</p>
<p>Handler（具体的Controller 方法）
HandlerMapping（根据request定为到对应的HandlerExecutionChain）
HandlerExecutionChain（handler的执行链，包含了拦截器和HandlerMethod）
HandlerMethod(包装了Handler)
HandlerAdapter()</p>
<p>HandlerMethodReturnValueHandlerComposite
HandlerMethodReturnValueHandler</p>
<p>HandlerMethodArgumentResolverComposite
HandlerMethodArgumentResolver</p>
<p>messageConverter （依赖 HandlerMethodReturnValueHandler和HandlerMethodArgumentResolver 处理请求前后 ）</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>springboot</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>为什么SpringBoot可以直接运行 jar 包？</h1>

<p><a href="https://zhuanlan.zhihu.com/p/476222316">https://zhuanlan.zhihu.com/p/476222316</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>启动</h1>

<p><a href="https://zhuanlan.zhihu.com/p/476222316">https://zhuanlan.zhihu.com/p/476222316</a></p>
<h2 id="嵌套jar包nested-jars">嵌套jar包:Nested JARs</h2>
<p>java 没有提供给任何标准方式加载嵌套的jar文件（嵌套jar文件，就是跟jar包里面还有jar包，spring boot项目常常打成一个jar包就能启动，这是spring为我们提供给的便利），如果需要命令行运行一个不需要解包就可以运行的自包含应用程序会遇到麻烦。
为了解决这个问题，许多开发者使用“影子”jar。影子jar包包含了所有jar包的所有classes，是一个超级就jar包（uber jar）。但是使用影子 jar将会很难分别哪个jar包实际在使用。并且如果不同jar包有相同文件名的文件，也会有问题。springboot 使用了不同的放解决嵌套jar包的问题。</p>
<h3 id="jar文件结构">jar文件结构</h3>
<pre tabindex="0"><code>example.jar
 |
 +-META-INF
 |  +-MANIFEST.MF
 +-org
 |  +-springframework
 |     +-boot
 |        +-loader
 |           +-&lt;spring boot loader classes&gt;
 +-BOOT-INF
    +-classpath.idx
    +-layers.idx
    +-classes  项目的class文件
    |  +-mycompany
    |     +-project
    |        +-YourClasses.class
    +-lib  依赖的jar包
       +-dependency1.jar
       +-dependency2.jar
</code></pre><h3 id="索引文件">索引文件</h3>
<p>classpath.idx 提供了jar添加到classpath的顺序，对jar和war包都支持
layer.idx jar包内的文件清单，只对jar包支持</p>
<h2 id="spring-boots-jarfile-class">Spring Boot’s “JarFile” Class</h2>
<p>支持加载嵌套jar的核心类是org.springframework.boot.loader.jar.JarFile，他让你可以从标准的jar文件和子jar文件加载数据。当第一次加载时，会形成一个带offset物理映射，就像下面这样。</p>
<pre tabindex="0"><code>myapp.jar
+-------------------+-------------------------+
| /BOOT-INF/classes | /BOOT-INF/lib/mylib.jar |
|+-----------------+||+-----------+----------+|
||     A.class      |||  B.class  |  C.class ||
|+-----------------+||+-----------+----------+|
+-------------------+-------------------------+
 ^                    ^           ^
 0063                 3452        3980
</code></pre><p>通过这种方式我们可以不必解开归档的文件加载嵌套实体，我们也不必把所有数据加载到内存里。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>自动配置</h1>

<h2 id="spring-boot-27之前">spring boot 2.7之前</h2>
<p>依赖 @SpringBootApplication&ndash;&gt;@EnableAutoConfiguration，
而EnableAutoConfiguration 又@Import({AutoConfigurationImportSelector.class})，所以主要看AutoConfigurationImportSelector。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">protected</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getCandidateConfigurations</span><span class="o">(</span><span class="n">AnnotationMetadata</span> <span class="n">metadata</span><span class="o">,</span> <span class="n">AnnotationAttributes</span> <span class="n">attributes</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">configurations</span> <span class="o">=</span> <span class="n">SpringFactoriesLoader</span><span class="o">.</span><span class="na">loadFactoryNames</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getSpringFactoriesLoaderFactoryClass</span><span class="o">(),</span> <span class="k">this</span><span class="o">.</span><span class="na">getBeanClassLoader</span><span class="o">());</span>  
</span></span><span class="line"><span class="cl">    <span class="n">Assert</span><span class="o">.</span><span class="na">notEmpty</span><span class="o">(</span><span class="n">configurations</span><span class="o">,</span> <span class="s">&#34;No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">configurations</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>可以看到，所以主要看AutoConfigurationImportSelector 扫描了jar包下的META-INF/spring.factories。把autoConfig的类取出来然后执行。</p>
<h2 id="spring-boot-27以后">spring boot 2.7以后</h2>
<p>更加标准的使用spi的方式，按照/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports，层级创建文件，文件内添加autoConfig的类即可。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>单元测试</h1>

<h1 id="保证测试用例顺序">保证测试用例顺序</h1>
<p>@FixMethodOrder(MethodSorters.NAME_ASCENDING)</p>
<h1 id="mvc">MVC</h1>
<p>1、使用ContextConfiguration 指定spring 配置文件
2、在spring配置文件内配置自己需要加载的bean</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl"><span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">locations</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;classpath:spring-test-config.xml&#34;</span><span class="o">})</span>  
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DrugGuidelineRepositoryTest</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;beans</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>  
</span></span><span class="line"><span class="cl">       <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>  
</span></span><span class="line"><span class="cl">       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans  
</span></span></span><span class="line"><span class="cl"><span class="s">        http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span class="nt">&gt;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&#34;classpath*:spring-datasource.xml&#34;</span><span class="nt">/&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&#34;classpath*:spring-bean.xml&#34;</span><span class="nt">/&gt;</span>  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/beans&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>  
</span></span><span class="line"><span class="cl">       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>  
</span></span><span class="line"><span class="cl">       <span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>  
</span></span><span class="line"><span class="cl">       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans  
</span></span></span><span class="line"><span class="cl"><span class="s">       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd       http://www.springframework.org/schema/context        http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span class="nt">&gt;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.benmu.mts.baseinfo.domain.drugguideline&#34;</span><span class="nt">&gt;</span>  
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/context:component-scan&gt;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/beans&gt;</span>
</span></span></code></pre></div><h1 id="spring-boot">Spring boot</h1>
<p>@RunWith(SpringRunner.class)
@ActiveProfiles(&ldquo;justdb&rdquo;)<br>
@SpringBootTest(classes = DrugTestApp.class, webEnvironment = SpringBootTest.WebEnvironment.NONE)</p>
<p>SpringRunner is alias  for the SpringJUnit4ClassRunner.</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>条件加载</h1>

<h2 id="conditional--condition">@Conditional &amp; Condition</h2>
<p>@Conditional是Spring4新提供的注解，它的作用是按照一定的条件进行判断，满足条件给容器注册bean。
@Conditional 注解允许引入多个Condition</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl"><span class="nd">@Target</span><span class="o">({</span><span class="n">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">})</span>  
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Conditional</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">    * All {@link Condition}s that must {@linkplain Condition#matches match}  
</span></span></span><span class="line"><span class="cl"><span class="cm">    * in order for the component to be registered.    */</span>   
</span></span><span class="line"><span class="cl">    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Condition</span><span class="o">&gt;[]</span> <span class="nf">value</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>我们可以根据自己的需求实现Condition，满足条件时bean才会被加载，同时如果bean上添加了@Import和@ComponentScan时，在满足条件后才会加载</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Condition</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="n">ConditionContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="spring-boot时代">spring boot时代</h2>
<p>spring boot 时代，扩展了@Conditional的功能，并在springboot内部大力使用。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221220161631.png" alt=""></p>
<h3 id="conditionalonmissingclass--conditionalonclass">@ConditionalOnMissingClass &amp; @ConditionalOnClass</h3>
<p>就拿比常用的@ConditionalOnMissingClass举例子</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Target</span><span class="o">({</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">METHOD</span> <span class="o">})</span>  
</span></span><span class="line"><span class="cl"><span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl"><span class="nd">@Documented</span>  
</span></span><span class="line"><span class="cl"><span class="nd">@Conditional</span><span class="o">(</span><span class="n">OnClassCondition</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ConditionalOnMissingClass</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">    * The names of the classes that must not be present.    * @return the names of the classes that must not be present    */</span>   
</span></span><span class="line"><span class="cl">    <span class="n">String</span><span class="o">[]</span> <span class="nf">value</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>使用了@Conditional注解，使用的condition是OnClassCondition，那我们就来看一下onClassCondition
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221220165644.png" alt="image.png">
其中springBootCondition实现了matches，其核心是getMatchOutcome方法，其实现是在OnClassCondition内。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Override</span>  
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">ConditionOutcome</span> <span class="nf">getMatchOutcome</span><span class="o">(</span><span class="n">ConditionContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">   <span class="n">ClassLoader</span> <span class="n">classLoader</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">   <span class="n">ConditionMessage</span> <span class="n">matchMessage</span> <span class="o">=</span> <span class="n">ConditionMessage</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">   <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">onClasses</span> <span class="o">=</span> <span class="n">getCandidates</span><span class="o">(</span><span class="n">metadata</span><span class="o">,</span> <span class="n">ConditionalOnClass</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span><span class="n">onClasses</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">      <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">missing</span> <span class="o">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">onClasses</span><span class="o">,</span> <span class="n">ClassNameFilter</span><span class="o">.</span><span class="na">MISSING</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">(!</span><span class="n">missing</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="n">ConditionOutcome</span><span class="o">.</span><span class="na">noMatch</span><span class="o">(</span><span class="n">ConditionMessage</span><span class="o">.</span><span class="na">forCondition</span><span class="o">(</span><span class="n">ConditionalOnClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">               <span class="o">.</span><span class="na">didNotFind</span><span class="o">(</span><span class="s">&#34;required class&#34;</span><span class="o">,</span> <span class="s">&#34;required classes&#34;</span><span class="o">).</span><span class="na">items</span><span class="o">(</span><span class="n">Style</span><span class="o">.</span><span class="na">QUOTE</span><span class="o">,</span> <span class="n">missing</span><span class="o">));</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">      <span class="n">matchMessage</span> <span class="o">=</span> <span class="n">matchMessage</span><span class="o">.</span><span class="na">andCondition</span><span class="o">(</span><span class="n">ConditionalOnClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">found</span><span class="o">(</span><span class="s">&#34;required class&#34;</span><span class="o">,</span> <span class="s">&#34;required classes&#34;</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">items</span><span class="o">(</span><span class="n">Style</span><span class="o">.</span><span class="na">QUOTE</span><span class="o">,</span> <span class="n">filter</span><span class="o">(</span><span class="n">onClasses</span><span class="o">,</span> <span class="n">ClassNameFilter</span><span class="o">.</span><span class="na">PRESENT</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">));</span>  
</span></span><span class="line"><span class="cl">   <span class="o">}</span>  
</span></span><span class="line"><span class="cl">   <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">onMissingClasses</span> <span class="o">=</span> <span class="n">getCandidates</span><span class="o">(</span><span class="n">metadata</span><span class="o">,</span> <span class="n">ConditionalOnMissingClass</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span><span class="n">onMissingClasses</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">      <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">present</span> <span class="o">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">onMissingClasses</span><span class="o">,</span> <span class="n">ClassNameFilter</span><span class="o">.</span><span class="na">PRESENT</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">(!</span><span class="n">present</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="n">ConditionOutcome</span><span class="o">.</span><span class="na">noMatch</span><span class="o">(</span><span class="n">ConditionMessage</span><span class="o">.</span><span class="na">forCondition</span><span class="o">(</span><span class="n">ConditionalOnMissingClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">               <span class="o">.</span><span class="na">found</span><span class="o">(</span><span class="s">&#34;unwanted class&#34;</span><span class="o">,</span> <span class="s">&#34;unwanted classes&#34;</span><span class="o">).</span><span class="na">items</span><span class="o">(</span><span class="n">Style</span><span class="o">.</span><span class="na">QUOTE</span><span class="o">,</span> <span class="n">present</span><span class="o">));</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">      <span class="n">matchMessage</span> <span class="o">=</span> <span class="n">matchMessage</span><span class="o">.</span><span class="na">andCondition</span><span class="o">(</span><span class="n">ConditionalOnMissingClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">didNotFind</span><span class="o">(</span><span class="s">&#34;unwanted class&#34;</span><span class="o">,</span> <span class="s">&#34;unwanted classes&#34;</span><span class="o">)</span>  
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">items</span><span class="o">(</span><span class="n">Style</span><span class="o">.</span><span class="na">QUOTE</span><span class="o">,</span> <span class="n">filter</span><span class="o">(</span><span class="n">onMissingClasses</span><span class="o">,</span> <span class="n">ClassNameFilter</span><span class="o">.</span><span class="na">MISSING</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">));</span>  
</span></span><span class="line"><span class="cl">   <span class="o">}</span>  
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">ConditionOutcome</span><span class="o">.</span><span class="na">match</span><span class="o">(</span><span class="n">matchMessage</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>其中关键的是ClassNameFilter类。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">protected</span> <span class="kd">enum</span> <span class="n">ClassNameFilter</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="n">PRESENT</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">      <span class="nd">@Override</span>  
</span></span><span class="line"><span class="cl">      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">classLoader</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="n">isPresent</span><span class="o">(</span><span class="n">className</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="o">},</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="n">MISSING</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">      <span class="nd">@Override</span>  
</span></span><span class="line"><span class="cl">      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">classLoader</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="o">!</span><span class="n">isPresent</span><span class="o">(</span><span class="n">className</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="o">};</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isPresent</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">classLoader</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">(</span><span class="n">classLoader</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="n">classLoader</span> <span class="o">=</span> <span class="n">ClassUtils</span><span class="o">.</span><span class="na">getDefaultClassLoader</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">      <span class="k">try</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="n">forName</span><span class="o">(</span><span class="n">className</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">      <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">   <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="kd">static</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">forName</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">classLoader</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ClassNotFoundException</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">(</span><span class="n">classLoader</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="n">classLoader</span><span class="o">.</span><span class="na">loadClass</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">      <span class="o">}</span>  
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">   <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>dicing世纪是使用ClassLoader尝试加载类，根据异常情况返回是否存在。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>中间件</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>kafka</h1>

<p>![][https://note.youdao.com/yws/public/resource/e5863162eca29c2b31e8b59c9707817d/xmlnote/317C13052E514DA9B6229368DD48EDB5/105252]</p>
<h2 id="kafka核心总控制器controller">Kafka核心总控制器Controller</h2>
<p>在Kafka集群中会有一个或者多个broker，其中有一个broker会被选举为控制器(Kafka Controller)，它负责管理整个 集群中所有分区和副本的状态。</p>
<ul>
<li>当某个分区的leader副本出现故障时，由控制器负责为该分区选举新的leader副本。</li>
<li>当检测到某个分区的ISR集合发生变化时，由控制器负责通知所有broker更新其元数据信息。</li>
<li>当使用kafka-topics.sh脚本为某个topic增加分区数量时，同样还是由控制器负责让新分区被其他节点感知到。</li>
</ul>
<h3 id="controller选举机制">Controller选举机制</h3>
<p>在kafka集群启动的时候，会自动选举一台broker作为controller来管理整个集群，选举的过程是集群中每个broker都会 尝试在<strong>zookeeper上创建一个 /controller 临时节点</strong>，zookeeper会保证有且仅有一个broker能创建成功，这个broker就会成为集群的总控器controller。</p>
<p>当这个controller角色的broker宕机了，此时zookeeper临时节点会消失，集群里其他broker会一直订阅这个临时节点，发现临时节点消失了，就竞争再次创建临时节点，就是我们上面说的选举机制，zookeeper又会保证有一个broker 成为新的controller。<br>
具备控制器身份的broker需要比其他普通的broker多一份职责，具体细节如下:</p>
<ol>
<li>
<p>监听broker相关的变化。为Zookeeper中的/brokers/ids/节点添加BrokerChangeListener，用来处理broker 增减的变化。</p>
</li>
<li>
<p>监听topic相关的变化。为Zookeeper中的/brokers/topics节点添加TopicChangeListener，用来处理topic增减 的变化;为Zookeeper中的/admin/delete_topics节点添加TopicDeletionListener，用来处理删除topic的动作。</p>
</li>
<li>
<p>从Zookeeper中读取获取当前所有与topic、partition以及broker有关的信息并进行相应的管理。对于所有topic 所对应的Zookeeper中的/brokers/topics/topic节点添加PartitionModificationsListener，用来监听topic中的 分区分配变化。</p>
</li>
<li>
<p>更新集群的元数据信息，同步到其他普通的broker节点中。</p>
</li>
</ol>
<h3 id="partition副本选举leader机制">Partition副本选举Leader机制</h3>
<p>controller感知到分区leader所在的broker挂了(controller监听了很多zk节点可以感知到broker存活)，controller会从 ISR列表(参数unclean.leader.election.enable=false的前提下)里挑第一个broker作为leader(第一个broker最先放进ISR 列表，可能是同步数据最多的副本)，如果参数unclean.leader.election.enable为true，代表在ISR列表里所有副本都挂 了的时候可以在ISR列表以外的副本中选leader，这种设置，可以提高可用性，但是选出的新leader有可能数据少很多。 副本进入ISR列表有两个条件:</p>
<ol>
<li>副本节点不能产生分区，必须能与zookeeper保持会话以及跟leader副本网络连通</li>
<li>副本能复制leader上的所有写操作，并且不能落后太多。(与leader副本同步滞后的副本，是由 replica.lag.time.max.ms 配置决定的，超过这个时间都没有跟leader同步过的一次的副本会被移出ISR列表)</li>
</ol>
<p>消费者消费消息的offset记录机制 每个consumer会定期将自己消费分区的offset提交给kafka内部topic:__consumer_offsets，提交过去的时候，key是 consumerGroupId+topic+分区号，value就是当前offset的值，kafka会定期清理topic里的消息，最后就保留最新的 那条数据</p>
<p>因为__consumer_offsets可能会接收高并发的请求，kafka默认给其分配50个分区(可以通过 offsets.topic.num.partitions设置)，这样可以通过加机器的方式抗大并发。</p>
<p>消费者Rebalance机制 rebalance就是说如果消费组里的消费者数量有变化或消费的分区数有变化，kafka会重新分配消费者消费分区的关系。 比如consumer group中某个消费者挂了，此时会自动把分配给他的分区交给其他的消费者，如果他又重启了，那么又会 把一些分区重新交还给他。 注意:rebalance只针对subscribe这种不指定分区消费的情况，如果通过assign这种消费方式指定了分区，kafka不会进 行rebanlance。<br>
如下情况可能会触发消费者rebalance</p>
<ol>
<li>消费组里的consumer增加或减少了 2. 动态给topic增加了分区</li>
<li>消费组订阅了更多的topic</li>
</ol>
<p>rebalance过程中，消费者无法从kafka消费消息，这对kafka的TPS会有影响，如果kafka集群内节点较多，比如数百 个，那重平衡可能会耗时极多，所以应尽量避免在系统高峰期的重平衡发生。</p>
<h3 id="kafka在redis中存的内容">kafka在redis中存的内容</h3>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220104215924.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>mysql</h1>

<h2 id="mysql-逻辑框架图">mysql 逻辑框架图</h2>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220322115620.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>redis</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>redis基础知识</h1>

<p>官网命令介绍
<a href="https://redis.io/commands/">https://redis.io/commands/</a>
<a href="https://pdai.tech/md/db/nosql-redis/db-redis-x-redis-ds.html">https://pdai.tech/md/db/nosql-redis/db-redis-x-redis-ds.html</a></p>
<h1 id="数据结构">数据结构</h1>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220908103730.png" alt="">
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006174307.png" alt="">
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006174325.png" alt=""></p>
<h2 id="字符串">字符串</h2>
<p>常用命令：
SET
GET
MSET（json的key）
MGET
SETNX（分布式锁）
INCR（原子操作）
INCRYBY （批量）
GET</p>
<h2 id="hash结构">hash结构</h2>
<h3 id="hash常用操作">Hash常用操作</h3>
<p>HSET key field value //存储一个哈希表key的键值
HSETNX key field value //存储一个不存在的哈希表key的键值
HMSET key field value [field value &hellip;] //在一个哈希表key中存储多个键值对
HGET key field //获取哈希表key对应的field键值
HMGET key field [field &hellip;] //批量获取哈希表key中多个field键值
HDEL key field [field &hellip;] //删除哈希表key中的field键值
HLEN key //返回哈希表key中field的数量
HGETALL  key //返回哈希表key中所有的键值
HINCRBY key field increment //为哈希表key中field键的值加上增量increment</p>
<h3 id="相比较string">相比较String</h3>
<ul>
<li>优点</li>
</ul>
<ol>
<li>同类数据归类整合储存，方便数据管理</li>
<li>相比string操作消耗内存与cpu更小</li>
<li>相比string储存更节省空间</li>
</ol>
<ul>
<li>缺点</li>
</ul>
<ol>
<li>过期功能不能使用在field上，只能用在key上</li>
<li>Redis集群架构下不适合大规模使用。大key容易造成数据分布不均匀</li>
</ol>
<h2 id="list结构">List结构</h2>
<p>队列结构，最大2^32-1个元素，主要用于头尾添加访问元素。
LPUSH
RPUSH
LPOP
RPOP
LRANGE 返回获取
BLPOP Block LPOP，会阻塞
BRPOP</p>
<h4 id="应用">应用</h4>
<p>stack=LPUSH+LPOP
queue=LPUSH+RPOP
blocking queue=LPUSH+BRPOP</p>
<h3 id="set结构">SET结构</h3>
<h4 id="基础命令">基础命令</h4>
<p>SADD
SREM 删除元素
SMEMBERS 查看全部元素
SRANDMEMBER key count 随机从key中抽取count个元素
SPOP 随机从key中抽取count个元素，并排除 pop··
SISMEMBER 是否包含
SCARD获取总数</p>
<h4 id="集合命令">集合命令</h4>
<p>SINTER 求交集
SUNION 并集
SDIFF 查集（第一个集合，在后续集合中不存在的元素）</p>
<h4 id="应用-1">应用</h4>
<p>抽奖
关注模型</p>
<ul>
<li>共同关注的人 SINTER</li>
<li>我关注的人也关注了他 SISMEMBER</li>
<li>可能喜欢 SDIFF</li>
</ul>
<h3 id="zset-有序集合">ZSET 有序集合</h3>
<p>常用操作：
ZADD key score
ZRANGE key start stop 排序
ZREVRANGE 倒序
ZUNIONSTORE 并集并放入一个key</p>
<p>应用：
排行榜</p>
<h2 id="redis注意事项">redis注意事项</h2>
<p>redis最应该避免大key，不要一个key里面存太多数据。</p>
<h1 id="常见面试问题">常见面试问题</h1>
<h2 id="redis的单线程和高性能--redis是单线程吗">Redis的单线程和高性能  Redis是单线程吗?</h2>
<p>Redis 的单线程主要是指 Redis 的网络 IO 和键值对读写是由一个线程来完成的，这也是 Redis 对外 提供键值存储服务的主要流程。但 Redis 的其他功能，比如持久化、异步删除、集群数据同步等，其实是由额外的线程执行的。<br>
Redis 单线程为什么还能这么快? 因为它所有的数据都在内存中，所有的运算都是内存级别的运算，而且单线程避免了多线程的切换性 能损耗问题。正因为 Redis 是单线程，所以要小心使用 Redis 指令，对于那些耗时的指令(比如 keys)，一定要谨慎使用，一不小心就可能会导致 Redis 卡顿。<br>
Redis 单线程如何处理那么多的并发客户端连接? Redis的IO多路复用:redis利用epoll来实现IO多路复用，将连接信息和事件放到队列中，依次放到 文件事件分派器，事件分派器将事件分发给事件处理器。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220908103836.png" alt=""></p>
<p>redis 一个命令过来大体分四步
1、建立连接
2、读取数据
3、执行命令
4、应答
连接建立优化先入队列，数据接收完成以后，传给事件处理器，不过需要注意命令的执行仍然会按照入队的顺序执行，只不过优化减少了IO时间。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>布隆过滤器</h1>

<h1 id="场景">场景：</h1>
<p>库里有10亿手机号，如何快速判断一个手机号是否在数据库中。
首先对这些数据进行缓存是肯定的，有没有什么更经济的方式缓存呢，这时候布隆举着盾牌就出现了。</p>
<h1 id="布隆过滤器">布隆过滤器</h1>
<p>布隆过滤器（Bloom Filter）是由布隆在<code>1970</code>年提出的。它实际上是一个很长的二进制向量（位图）和一系列随机映射函数（哈希函数）。<br>
布隆过滤器可以用于检索一个元素是否在一个集合中。
优点：空间效率和查询时间都比一般的算法要好的多。<br>
缺点有2个：</p>
<ol>
<li>在判断元素在集合中有误差，只有判断元素不在集合中是准确的</li>
<li>删除比较困难</li>
</ol>
<h2 id="位图bitmap">位图（Bitmap）</h2>
<p><code>Redis</code>当中有一种数据结构就是位图，布隆过滤器其中重要的实现就是位图的实现，也就是位数组，并且在这个数组中每一个位置只有<code>0</code>和<code>1</code>两种状态，每个位置只占用<code>1</code>个 bit，其中<code>0</code>表示没有元素存在，<code>1</code>表示有元素存在。</p>
<p>如下图所示就是一个简单的布隆过滤器示例（<strong>一个<code>key</code>值经过哈希运算和位运算就可以得出应该落在哪个位置</strong>）：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220818183544.png" alt=""></p>
<h2 id="哈希">哈希</h2>
<p>上面我们发现，<code>lonely</code>和<code>wolf</code>落在了同一个位置，这种不同的<code>key</code>值经过哈希运算后得到相同值的现象就称之为<strong>哈希碰撞</strong>。发生哈希碰撞之后再经过位运算，那么最后肯定会落在同一个位置。</p>
<p>如果发生过多的哈希碰撞，就会影响到判断的准确性，所以为了减少哈希碰撞，我们一般会综合考虑以下<code>2</code>个因素：</p>
<ul>
<li>增大位图数组的大小（位图数组越大，占用的内存越大）。</li>
<li>增加哈希函数的次数（同一个<code>key</code>值经过<code>1</code>个函数相等了，那么经过<code>2</code>个或者更多个哈希函数的计算，都得到相等结果的概率就自然会降低了）。</li>
</ul>
<p>上面两个方法我们需要综合考虑：比如增大位数组，那么就需要消耗更多的空间，而经过越多的哈希计算也会消耗<code>cpu</code>影响到最终的计算时间，所以位数组到底多大，哈希函数次数又到底需要计算多少次合适需要具体情况具体分析。</p>
<h2 id="删除元素">删除元素</h2>
<p>布隆过滤器判断一个元素存在就是判断对应位置是否为<code>1</code>来确定的，但是如果要删除掉一个元素是不能直接把<code>1</code>改成<code>0</code>的，因为这个位置可能存在其它元素，所以如果要支持删除，那我们应该怎么做呢？</p>
<p>最简单的做法就是加一个计数器，就是说位数组的每个位如果不存在就是<code>0</code>，存在几个元素就存具体的数字，而不仅仅只是存<code>1</code>。那么这就有一个问题，本来存<code>1</code>就是一位就可以满足了，但是如果要存具体的数字比如说<code>2</code>，那就需要<code>2</code>位了，所以<strong>带有计数器的布隆过滤器会占用更大的空间</strong>。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>缓存雪崩、缓存击穿、缓存穿透</h1>

<h2 id="缓存雪崩">缓存雪崩</h2>
<p>原因：</p>
<p>大量缓存数据同时失效，导致某一瞬间之后，相当于没有缓存。</p>
<p>解决：</p>
<ol>
<li>缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。</li>
<li>设置热点数据永远不过期。</li>
</ol>
<h2 id="缓存击穿">缓存击穿</h2>
<p>原因：</p>
<p>从击穿这个字眼上来看，是有瞬间大量的请求过来，访问同一资源。这时候会有大量请求直接访问db。</p>
<p>解决：</p>
<ol>
<li>设置热点数据永远不过期。</li>
<li>加互斥锁。</li>
</ol>
<h2 id="缓存穿透">缓存穿透</h2>
<p>原因：</p>
<p>大量请求绕过缓存访问db里面不存在的数据，例如访问id=-1的数据，这时候也会给db造成较大压力。</p>
<p>解决：</p>
<ol>
<li>接口对参数进行基本的校验id&gt;0</li>
<li>短时间缓存null值数据</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>rocketmq</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>rocketmq基本概念</h1>

<p><a href="https://www.cnblogs.com/ciel717/p/16180055.html">https://www.cnblogs.com/ciel717/p/16180055.html</a></p>
<p>produceGroup:
用于事物消息，在一个producerGroup内的节点中，如果某个producer down了，那么会找另一个producer重新发送。</p>
<h2 id="面试常问的问题">面试常问的问题：</h2>
<h3 id="使用rocketmq如何保证消息不丢失">使用RocketMQ如何保证消息不丢失？</h3>
<p>这个是在面试时，关于MQ，面试官最喜欢问的问题。这个问题是所有MQ都需要面 对的一个共性问题。大致的解决思路都是一致的，但是针对不同的MQ产品又有不同 的解决方案。分析这个问题要从以下几个角度入手：</p>
<h4 id="1哪些环节会有丢消息的可能">1、哪些环节会有丢消息的可能？</h4>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202211262217356.png" alt=""></p>
<p>我们考虑一个通用的MQ场景：
其中，1，2，4三个场景都是跨网络的，而跨网络就肯定会有丢消息的可能。
然后关于3这个环节，通常MQ存盘时都会先写入操作系统的缓存page cache中，然 后再由操作系统异步的将消息写入硬盘。这个中间有个时间差，就可能会造成消息 丢失。如果服务挂了，缓存中还没有来得及写入硬盘的消息就会丢失。 这个是MQ场景都会面对的通用的丢消息问题。那我们看看用RocketMQ时要如何 解决这个问题</p>
<p>topicQueue 数量过多会有性能问题</p>
<p>集群消费由brocker管理
广播消费由consumer管理</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>RocketMQ</h1>

<h1 id="参考资料">参考资料</h1>
<p>RocketMQ 消息积压了，增 加消费者有用吗？：https://www.pudn.com/news/62f766f45425817ffc3eae52.html</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>中间件的定义</h1>

<p>中间件是为应用提供通用服务和功能的软件。数据管理、应用服务、消息传递、身份验证和 API 管理通常都要通过中间件。</p>
<p>中间件可以帮助开发人员更有效地构建应用。它就如同是应用、数据与用户之间的纽带。</p>
<p>对于具有多云和容器化环境的企业而言，中间件可以助您大规模、经济高效地开发和运行应用。
一般而言中间件和<a href="https://so.csdn.net/so/search?q=%E6%A1%86%E6%9E%B6&amp;spm=1001.2101.3001.7020">框架</a>的区别是，中间件是独立运行的用于处理某项专门业务的CS程序，会有配套的客户端和服务端，框架虽然也是处理某个专门业务的但是它不是独立程序，是寄宿在宿主程序进程内的一套类库。
作者：阿里巴巴淘系技术<br>
链接：https://www.zhihu.com/question/19730582/answer/1663627873<br>
来源：知乎<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="常用基础中间件">常用基础中间件</h2>
<ul>
<li>
<p><a href="https://www.zhihu.com/search?q=%E8%B7%AF%E7%94%B1%E4%B8%8Eweb%E6%9C%8D%E5%8A%A1%E5%99%A8&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A1663627873%7D">路由与web服务器</a>：处理和转发其他服务器通信数据的服务器。 如被业界广泛使用的阿里基于 Nginx 研发的 Tengine、阿里内部的集中式路由服务 VipServer</p>
</li>
<li>
<p>RPC框架：微服务时代的远程服务调用框架。如grpc, Thrift, 阿里的 HSF, Dubbo, SOFA-RPC</p>
</li>
<li>
<p><a href="https://www.zhihu.com/search?q=%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A1663627873%7D">消息中间件</a>：支持在分布式系统之间发送和接收消息的软件。 如 Apache kafka, Apache RabbitMQ, NSQ, 阿里孵化开源的 Apache RocketMQ</p>
</li>
<li>
<p>缓存服务: 分布式的高速数据存储层，一般是内存存储。如 阿里 Tair，业界的 Redis, Memcached, Ehcache</p>
</li>
<li>
<p>配置中心：用来统一管理各个项目中所有配置的系统。如 阿里 Nacos、携程 Apollo、百度 Disconf</p>
</li>
<li>
<p>分布式事务：事务的参与者、支持事务的服务器、资源服务器以及事务管理器分别位于不同的分布式系统的不同节点之上。 如 <a href="https://www.zhihu.com/search?q=%E9%98%BF%E9%87%8C+seata&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A1663627873%7D">阿里 seata</a>、腾讯 DTF</p>
</li>
<li>
<p>任务调度：分布式环境下提供定时、任务编排、分布式跑批等功能的系统。如 阿里 SchedulerX、业界 xxl-job、当当 elastic-job、有赞 TSP</p>
</li>
<li>
<p>数据库层 用于支持弹性扩容和分库分表的 TDDL，数据库连接池 Driud, Binlog 同步的 Canal 等。</p>
</li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>分布式</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>dubbo</h1>


            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>zookeeper</h1>

<h2 id="什么是zookeeper">什么是zookeeper</h2>
<p>它是一个分布式协调框架，是Apache Hadoop 的一个子项目，它主要是用来解决分布式应用中经常遇到的一些数据管理问题，如:统一命名服务、状态同 步服务、集群管理、分布式应用配置项的管理等。</p>
<h2 id="核心概念">核心概念</h2>
<p>简单的理解Zookeeper 是一个用于存储少量数据的基于内存 的数据库，主要有如下两个核心的概念:</p>
<ol>
<li>文件系统数据结构</li>
<li>监听通知机制。</li>
</ol>
<h3 id="文件系统数据结构">文件系统数据结构</h3>
<p>Zookeeper维护一个类似文件系统的数据结构:
<img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/%E6%88%AA%E5%B1%8F2022-01-06%20%E4%B8%8B%E5%8D%883.31.20.png" alt=""></p>
<p>每个子目录项都被称作为 znode(目录节点)，和文件系统类似，我们能够自由的增加、删除 znode，在一个znode下增加、删除子znode。<br>
有四种类型的znode:</p>
<ol>
<li>
<p>PERSISTENT­持久化目录节点 客户端与zookeeper断开连接后，该节点依旧存在，只要不手动删除该节点，他将永远存在</p>
</li>
<li>
<p>PERSISTENT_SEQUENTIAL­持久化顺序编号目录节点 客户端与zookeeper断开连接后，该节点依旧存在，只是Zookeeper给该节点名称进行顺序编号</p>
</li>
<li>
<p>EPHEMERAL­临时目录节点 客户端与zookeeper断开连接后，该节点被删除(和sessionId绑定的，session断开或者超时会被删除)</p>
</li>
<li>
<p>EPHEMERAL_SEQUENTIAL­临时顺序编号目录节点 客户端与zookeeper断开连接后，该节点被删除，只是Zookeeper给该节点名称进行顺序编号</p>
</li>
<li>
<p>Container 节点(3.5.3 版本新增，如果Container节点下面没有子节点，则Container节点 在未来会被Zookeeper自动清除,定时任务默认60s 检查一次)</p>
</li>
<li>
<p>TTL 节点( Time To Live 默认禁用，只能通过系统配置 zookeeper.extendedTypesEnabled=true 开启，不稳定)</p>
</li>
</ol>
<h3 id="监听通知机制">监听通知机制</h3>
<p>客户端注册监听它关心的任意节点，或者目录节点及递归子目录节点</p>
<ol>
<li>如果注册的是对某个节点的监听，则当这个节点被删除，或者被修改时，对应的客户端将被通知</li>
<li>如果注册的是对某个目录的监听，则当这个目录有子节点被创建，或者有子节点被删除，对应的客户端将被通知</li>
<li>如果注册的是对某个目录的递归子节点进行监听，则当这个目录下面的任意子节点有目录结构 的变化(有子节点被创建，或被删除)或者根节点有数据变化时，对应的客户端将被通知。</li>
</ol>
<p>get -w /xxx
监听只会监听当前节点，子节点修改不会被监听
注意:所有的通知都是一次性的，及无论是对节点还是对目录进行的监听，一旦触发，对应的监 听即被移除。递归子节点，监听是对所有子节点的，所以，每个子节点下面的事件同样只会被触发一次。</p>
<h3 id="应用场景">应用场景</h3>
<ol>
<li>分布式配置中心</li>
<li>分布式注册中心</li>
<li>分布式锁</li>
<li>分布式队列</li>
<li>集群选举</li>
<li>分布式屏障</li>
<li>发布/订阅</li>
</ol>
<h2 id="节点元数据">节点元数据</h2>
<p>可以通过stat命令，或者get -s
cZxid:创建znode的事务ID(Zxid的值)。
mZxid:最后修改znode的事务ID。
pZxid:最后添加或删除子节点的事务ID(子节点列表发生变化才会发生改变)。 ctime:znode创建时间。
mtime:znode最近修改时间。<br>
dataVersion:znode的当前数据版本。
cversion:znode的子节点结果集版本(一个节点的子节点增加、删除都会影响这个版本）。
aclVersion：znode的acl版本
ephemeralOwner:znode是临时znode时，表示znode所有者的 session ID。 如果
znode不是临时znode，则该字段设置为零。 dataLength:znode数据字段的长度。
numChildren:znode的子znode的数量。</p>
<h2 id="acl-权限控制-access-control-list-">ACL 权限控制( Access Control List )</h2>
<p>Zookeeper 的ACL 权限控制,可以控制节点的读写操作,保证数据的安全性，Zookeeper ACL 权 限设置分为 3 部分组成，分别是:权限模式(Scheme)、授权对象(ID)、权限信息 (Permission)。最终组成一条例如“scheme:id:permission”格式的 ACL 请求信息。</p>
<p>Scheme(权限模式):用来设置 ZooKeeper 服务器进行权限验证的方式。ZooKeeper 的权限 验证方式大体分为两种类型:</p>
<p>一种是范围验证。所谓的范围验证就是说 ZooKeeper 可以针对一个 IP 或者一段 IP 地址授予某 种权限。比如我们可以让一个 IP 地址为“ip:192.168.0.110”的机器对服务器上的某个数据节 点具有写入的权限。或者也可以通过“ip:192.168.0.1/24”给一段 IP 地址的机器赋权。</p>
<p>另一种权限模式就是口令验证，也可以理解为用户名密码的方式。在 ZooKeeper 中这种验证方 式是 Digest 认证，而 Digest 这种认证方式首先在客户端传送“username:password”这种形 式的权限表示符后，ZooKeeper 服务端会对密码 部分使用 SHA-1 和 BASE64 算法进行加密， 以保证安全性。</p>
<p>还有一种Super权限模式, Super可以认为是一种特殊的 Digest 认证。具有 Super 权限的客户端 可以对 ZooKeeper 上的任意数据节点进行任意操作。</p>
<p>授权对象(ID)<br>
授权对象就是说我们要把权限赋予谁，而对应于 4 种不同的权限模式来说，如果我们选择采用 IP 方式，使用的授权对象可以是一个 IP 地址或 IP 地址段;而如果使用 Digest 或 Super 方式，则 对应于一个用户名。如果是 World 模式，是授权系统中所有的用户。</p>
<p>权限信息(Permission)<br>
权限就是指我们可以在数据节点上执行的操作种类，如下所示:在 ZooKeeper 中已经定义好的 权限有 5 种:</p>
<p>数据节点(c: create)创建权限，授予权限的对象可以在数据节点下创建子节点; 数据节点(w: wirte)更新权限，授予权限的对象可以更新该数据节点;<br>
数据节点(r: read)读取权限，授予权限的对象可以读取该节点的内容以及子节点的列表信息; 数据节点(d: delete)删除权限，授予权限的对象可以删除该数据节点的子节点; 数据节点(a: admin)管理者权限，授予权限的对象可以对该数据节点体进行 ACL 权限设置。</p>
<p>命令:<br>
getAcl:获取某个节点的acl权限信息<br>
setAcl:设置某个节点的acl权限信息<br>
addauth: 输入认证授权信息，相当于注册用户信息，注册时输入明文密码，zk将以密文的形式存 储</p>
<p>可以通过系统参数zookeeper.skipACL=yes进行配置，默认是no,可以配置为true, 则配置过的 ACL将不再进行权限检测
ex：
setAcl /test auth:yuvenhol:pwd:rwcd
create /test xxdataxx ip:192.168.109.130:rw</p>
<h2 id="数据结构">数据结构</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//DataNode 是Zookeeper存储节点数据的最小单位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DataNode</span> <span class="kd">implements</span> <span class="n">Record</span><span class="o">{</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">byte</span> <span class="n">data</span><span class="o">[];</span>  
</span></span><span class="line"><span class="cl">	<span class="n">Long</span> <span class="n">acl</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="n">StatPersisted</span> <span class="n">stat</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">private</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DataTree</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">private</span> <span class="kd">final</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">DataNode</span><span class="o">&gt;</span> <span class="n">nodes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">DataNode</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">final</span> <span class="n">WatchManager</span> <span class="n">dataWatches</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WatchManager</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">final</span> <span class="n">WatchManager</span> <span class="n">childWatches</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WatchManager</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="事务日志数据快照">事务日志&amp;数据快照</h2>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220106225039.png" alt="">
格式化后效果
<img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220106225433.png" alt=""></p>
<p>事务日志：
针对每一次客户端的事务操作，Zookeeper都会将他们记录到事务日志中，当然，Zookeeper也 会将数据变更应用到内存数据库中。我们可以在zookeeper的主配置文件zoo.cfg 中配置内存中 的数据持久化目录，也就是事务日志的存储路径 dataLogDir. 如果没有配置dataLogDir(非必 填), 事务日志将存储到dataDir (必填项)目录
数据快照：
用于记录Zookeeper服务器上某一时刻的全量数据，并将其写入到指定的磁盘文件中。 可以通过配置snapCount配置每间隔事务请求个数，生成快照，数据存储在dataDir 指定的目录中</p>
<p>事务日志文件名为: log.&lt;当时最大事务ID&gt;，应为日志文件时顺序写入的，所以这个最大事务 ID也将是整个事务日志文件中，最小的事务ID，日志满了即进行下一次事务日志文件的创建</p>
<p>快照事务日志文件名为: snapshot.&lt;当时最大事务ID&gt;，日志满了即进行下一次事务日志文件的 创建</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>分布式事务</h1>

<blockquote>
<p>事务基本概念[[事务]]</p>
</blockquote>
<h1 id="分布式事务">分布式事务</h1>
<p>在分布式服务环境下的事务处理机制。</p>
<h1 id="cap理论">CAP理论</h1>
<p>分布式计算领域所公认的著名定理。这个定理里描述了一个分布式的系统中，涉及共享数据问题时，以下三个特性最多只能同时满足其中两个：</p>
<ul>
<li><strong>一致性</strong>（<strong>C</strong>onsistency）：代表数据在任何时刻、任何分布式节点中所看到的都是符合预期的。一致性在分布式研究中是有严肃定义、有多种细分类型的概念，以后讨论分布式共识算法时，我们还会再提到一致性，那种面向副本复制的一致性与这里面向数据库状态的一致性严格来说并不完全等同，具体差别我们将在后续分布式共识算法中再作探讨。</li>
<li><strong>可用性</strong>（<strong>A</strong>vailability）：代表系统不间断地提供服务的能力，理解可用性要先理解与其密切相关两个指标：可靠性（Reliability）和可维护性（Serviceability）。可靠性使用平均无故障时间（Mean Time Between Failure，MTBF）来度量；可维护性使用平均可修复时间（Mean Time To Repair，MTTR）来度量。可用性衡量系统可以正常使用的时间与总时间之比，其表征为：A=MTBF/（MTBF+MTTR），即可用性是由可靠性和可维护性计算得出的比例值，譬如 99.9999%可用，即代表平均年故障修复时间为 32 秒。</li>
<li><strong>分区容忍性</strong>（<strong>P</strong>artition Tolerance）：代表分布式环境中部分节点因网络原因而彼此失联后，即与其他节点形成“网络分区”时，系统仍能正确地提供服务的能力。</li>
</ul>
<p>对C、A、P三者的取舍，会产生不同取向的。</p>
<ul>
<li><strong>如果放弃分区容忍性</strong>（CA without P），意味着我们将假设节点之间通信永远是可靠的。永远可靠的通信在分布式系统中必定不成立的，这不是你想不想的问题，而是只要用到网络来共享数据，分区现象就会始终存在。在现实中，最容易找到放弃分区容忍性的例子便是传统的关系数据库集群，这样的集群虽然依然采用由网络连接的多个节点来协同工作，但数据却不是通过网络来实现共享的。以 Oracle 的 RAC 集群为例，它的每一个节点均有自己独立的 SGA、重做日志、回滚日志等部件，但各个节点是通过共享存储中的同一份数据文件和控制文件来获取数据的，通过共享磁盘的方式来避免出现网络分区。因而 Oracle RAC 虽然也是由多个实例组成的数据库，但它并不能称作是分布式数据库。</li>
<li><strong>如果放弃可用性</strong>（CP without A），意味着我们将假设一旦网络发生分区，节点之间的信息同步时间可以无限制地延长，此时，问题相当于退化到前面“全局事务”中讨论的一个系统使用多个数据源的场景之中，我们可以通过 2PC/3PC 等手段，同时获得分区容忍性和一致性。在现实中，选择放弃可用性的 CP 系统情况一般用于对数据质量要求很高的场合中，除了 DTP 模型的分布式数据库事务外，著名的 HBase 也是属于 CP 系统，以 HBase 集群为例，假如某个 RegionServer 宕机了，这个 RegionServer 持有的所有键值范围都将离线，直到数据恢复过程完成为止，这个过程要消耗的时间是无法预先估计的。</li>
<li><strong>如果放弃一致性</strong>（AP without C），意味着我们将假设一旦发生分区，节点之间所提供的数据可能不一致。选择放弃一致性的 AP 系统目前是设计分布式系统的主流选择，因为 P 是分布式网络的天然属性，你再不想要也无法丢弃；而 A 通常是建设分布式的目的，如果可用性随着节点数量增加反而降低的话，很多分布式系统可能就失去了存在的价值，除非银行、证券这些涉及金钱交易的服务，宁可中断也不能出错，否则多数系统是不能容忍节点越多可用性反而越低的。目前大多数 NoSQL 库和支持分布式的缓存框架都是 AP 系统，以 Redis 集群为例，如果某个 Redis 节点出现网络分区，那仍不妨碍各个节点以自己本地存储的数据对外提供缓存服务，但这时有可能出现请求分配到不同节点时返回给客户端的是不一致的数据。</li>
</ul>
<p>“选择放弃一致性的 AP 系统目前是设计分布式系统的主流选择”，“事务”原本的目的就是获得“一致性”，而在分布式环境中，“一致性”却不得不成为通常被牺牲、被放弃的那一项属性。但无论如何，我们建设信息系统，终究还是要确保操作结果至少在最终交付的时候是正确的，这句话的意思是允许数据在中间过程出错（不一致），但应该在输出时被修正过来。为此，人们又重新给一致性下了定义，将前面我们在 CAP、ACID 中讨论的一致性称为“<a href="https://en.wikipedia.org/wiki/Strong_consistency">强一致性</a>”（Strong Consistency），有时也称为“<a href="https://en.wikipedia.org/wiki/Linearizability">线性一致性</a>”（Linearizability，通常是在讨论<a href="https://icyfenix.cn/distribution/consensus/">共识算法</a>的场景中），而把牺牲了 C 的 AP 系统又要尽可能获得正确的结果的行为称为追求“弱一致性”。不过，如果单纯只说“弱一致性”那其实就是“不保证一致性”的意思……人类语言这东西真的是博大精深。在弱一致性里，人们又总结出了一种稍微强一点的特例，被称为“<a href="https://en.wikipedia.org/wiki/Eventual_consistency">最终一致性</a>”（Eventual Consistency），它是指：如果数据在一段时间之内没有被另外的操作所更改，那它最终将会达到与强一致性过程相同的结果，有时候面向最终一致性的算法也被称为“乐观复制算法”。</p>
<p>在本节讨论的主题“分布式事务”中，目标同样也不得不从之前三种事务模式追求的强一致性，降低为追求获得“最终一致性”。由于一致性的定义变动，“事务”一词的含义其实也同样被拓展了，人们把使用 ACID 的事务称为“刚性事务”，而把笔者下面将要介绍几种分布式事务的常见做法统称为“柔性事务”。</p>
<h1 id="实现柔性事务的方案">实现柔性事务的方案</h1>
<h2 id="可靠事件队列">可靠事件队列</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220920155848.png" alt=""></p>
<h2 id="tcc">TCC</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220920203220.png" alt=""></p>
<h2 id="saga">SAGA</h2>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>分布式算法</h1>

<h2 id="选举算法">选举算法：</h2>
<h3 id="paxos">paxos:</h3>
<p>角色</p>
<p>Paxos将系统中的角色分为提议者 (Proposer)，决策者 (Acceptor)，和最终决策学习者 (Learner):</p>
<p>• Proposer: 提出提案 (Proposal)。Proposal信息包括提案编号 (Proposal ID) 和提议的值 (Value)。</p>
<p>• Acceptor: 参与决策，回应Proposers的提案。收到Proposal后可以接受提案，若Proposal获得多数Acceptors的接受，则称该Proposal被批准。</p>
<p>• Learner: 不参与决策，从Proposers/Acceptors学习最新达成一致的提案(Value)。</p>
<p>在多副本状态机中，每个副本同时具有Proposer、Acceptor、Learner三种角色。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220824160428.png" alt="">
三只蓝军攻打一只强大的红军</p>
<p>第一阶段: Prepare阶段</p>
<p>Proposer向Acceptors发出Prepare请求，Acceptors针对收到的Prepare请求进行Promise承诺。</p>
<p>• Prepare: Proposer生成全局唯一且递增的Proposal ID (可使用时间戳加Server ID)，向所有Acceptors发送Prepare请求，这里无需携带提案内容，只携带Proposal ID即可。</p>
<p>• Promise: Acceptors收到Prepare请求后，做出“两个承诺，一个应答”。</p>
<p>○ 承诺1: 不再接受Proposal ID小于等于(注意: 这里是&lt;= )当前请求的Prepare请求;</p>
<p>○ 承诺2: 不再接受Proposal ID小于(注意: 这里是&lt; )当前请求的Propose请求;</p>
<p>○ 应答: 不违背以前作出的承诺下，回复已经Accept过的提案中Proposal ID最大的那个提案的Value和Proposal ID，没有则返回空值。</p>
<p>¶ 第二阶段: Accept阶段</p>
<p>Proposer收到多数Acceptors承诺的Promise后，向Acceptors发出Propose请求，Acceptors针对收到的Propose请求进行Accept处理。</p>
<p>• Propose: Proposer 收到多数Acceptors的Promise应答后，从应答中选择Proposal ID最大的提案的Value，作为本次要发起的提案。如果所有应答的提案Value均为空值，则可以自己随意决定提案Value。然后携带当前Proposal ID，向所有Acceptors发送Propose请求。</p>
<p>• Accept: Acceptor收到Propose请求后，在不违背自己之前作出的承诺下，接受并持久化当前Proposal ID和提案Value。</p>
<p>¶ 第三阶段: Learn阶段</p>
<p>Proposer在收到多数Acceptors的Accept之后，标志着本次Accept成功，决议形成，将形成的决议发送给所有Learners。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220824160439.png" alt=""></p>
<h2 id="一致性协议算法">一致性协议算法：</h2>
<h3 id="zab">ZAB：</h3>
<p><a href="https://pdai.tech/md/algorithm/alg-domain-distribute-x-zab.html">https://pdai.tech/md/algorithm/alg-domain-distribute-x-zab.html</a></p>
<h2 id="负载均衡算法">负载均衡算法</h2>
<h3 id="一致性hash">一致性hash</h3>
<p><a href="https://blog.csdn.net/gonghaiyu/article/details/108375298">https://blog.csdn.net/gonghaiyu/article/details/108375298</a></p>
<h4 id="传统hash算法的弊端">传统hash算法的弊端</h4>
<p>资源数据分布通常有哈希分区和顺序分区两种方式</p>
<ol>
<li>顺序分布：数据分散度易倾斜、键值业务相关、可顺序访问、不支持批量操作。</li>
<li>哈希分布：数据分散度高、键值分布业务无关、无法顺序访问、支持批量操作。</li>
</ol>
<p>顺序分区</p>
<p>顺序分区通常指顺序访问某个资源，如在RocketMQ中，Topic(消息主题)可能对应多个实际的消息队列，消息投递时，如果有5个消息，只有三个队列，消息按照1-2-3-1-2这样的投递顺序。</p>
<p>哈希分区-节点取余分区</p>
<p>对特定数据采用hash算法得到一个整数，再通过整数对分区数取余就可以得到资源的存储路由。如redis的键或用户ID，再根据节点数量N使用公式：hash(key)%N计算出哈希值，用来决定数据映射到哪个分区节点。</p>
<ol>
<li>优点<br>
这种方式的突出优点就是简单，且常用于数据库的分库分表。如京东某系统中采用shardingjdbc，用这种方式进行分库分表路由处理。</li>
<li>缺点<br>
当节点数量发生变化时，如扩容或收缩节点（没有遇到过），数据节点关系需要重新计算，会导致数据的重新迁移。所以扩容通常采用翻倍扩容，避免数据映射全部打乱而全部迁移，翻倍迁移只发生50%的数据迁移。如果不翻倍缩扩容，如某一台机器宕机，那么应该落在该机器的请求就无法得到正确的处理，这时需要将宕掉的服务器使用算法去除，此时候会有(N-1)/N的服务器的缓存数据需要重新进行计算；如果新增一台机器，会有N /(N+1)的服务器的缓存数据需要进行重新计算。对于系统而言，这通常是不可接受的颠簸（因为这意味着大量缓存的失效或者数据需要转移）。</li>
</ol>
<blockquote>
<p>传统求余做<a href="https://so.csdn.net/so/search?q=%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1&amp;spm=1001.2101.3001.7020">负载均衡</a>算法，缓存节点数由3个变成4个，缓存不命中率为75%。计算方法：穷举hash值为1-12的12个数字分别对3和4取模，然后比较发现只有前3个缓存节点对应结果和之前相同，所以有75%的节点缓存会失效，可能会引起缓存雪崩。</p>
</blockquote>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>工具</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>arthas</h1>


            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>git</h1>

<h1 id="命令">命令</h1>
<table>
<thead>
<tr>
<th>命令</th>
<th>参数</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>checkout</td>
<td>-b</td>
<td>检出一个新分支</td>
<td></td>
</tr>
<tr>
<td>checkout</td>
<td>-</td>
<td>切换到上一个分支</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>branch</td>
<td>-m</td>
<td>重命名分支</td>
<td>git branch -m 原始名称 新名称</td>
</tr>
<tr>
<td>branch</td>
<td>-u &ndash;set-upstream</td>
<td>设置当前分支对应的远程分支</td>
<td>git branch -u origin/dev</td>
</tr>
<tr>
<td>branch</td>
<td>&ndash;unset-upstream</td>
<td>反向操作</td>
<td>git branch &ndash;unset-upstream</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>push</td>
<td>-f</td>
<td>强制本地分支推送远程分支</td>
<td></td>
</tr>
<tr>
<td>push</td>
<td>-u  &ndash;set-upstream</td>
<td>push 并且 设置当前分支对应的远程分支</td>
<td>git branch &ndash;unset-upstream  origin [分支名]</td>
</tr>
</tbody>
</table>
<h2 id="rebase">rebase</h2>
<p>把一个分支整合到另一个分支的办法有两种：merge（合并） 和 rebase（衍合）。
rebase相当于在fetch之后，重新提交数据。
千万不要在在public分支操作rebase，例如develop，不要用rebase合并自己的feature分支。
<img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220415182416.png" alt=""></p>
<p>有一篇很好的文章讲merge和rebase
<a href="https://www.atlassian.com/git/tutorials/merging-vs-rebasing#the-golden-rule-of-rebasing">https://www.atlassian.com/git/tutorials/merging-vs-rebasing#the-golden-rule-of-rebasing</a></p>
<h1 id="git工作流程">git工作流程</h1>
<h2 id="git-flow">git flow</h2>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/1432234-d6d6f31dc555b855.png" alt=""></p>
<h1 id="配置">配置</h1>
<h2 id="ignore">ignore</h2>
<ol>
<li>注视</li>
<li>folder   同名的 folder 目录、src/folder 文件、src/utils/folder 文件都会被忽略，即：不会被提交到远程仓库中。</li>
<li>folder/ 只忽略文件夹</li>
<li>!  表示取反，不忽略xxx</li>
<li>通配符
星号“*” ：匹配多个字符；
双星号“**” ：匹配多个字符；
问号“?”：匹配除 ‘/’外的任意一个字符；
方括号“[xxxx]”：匹配多个列表中的字符；</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>idea</h1>

<p>编译大项目gc over limit
调整堆大小
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221009182507.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>iredis</h1>

<p>redis 命令行客户端 <a href="https://gitee.com/mirrors/iredis#using-dsn">https://gitee.com/mirrors/iredis#using-dsn</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>jmeter</h1>

<h2 id="bean-shell">bean shell</h2>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>markdown</h1>

<h2 id="绘图mermaid">绘图mermaid</h2>
<h3 id="时序图">时序图</h3>

<div class="mermaid" align="center">sequenceDiagram
    participant mobile
	participant ucenter
	participant mysql
	loop 
    mobile ->>+ ucenter:userCardRemote.queryCardByNo
    end</div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>maven</h1>

<h2 id="资料">资料</h2>
<p>官网 ：https://maven.apache.org/
官方仓库浏览：https://mvnrepository.com/、https://search.maven.org/</p>
<h2 id="功能">功能</h2>
<p>编译、打包、测试、依赖管理等</p>
<h2 id="仓库">仓库</h2>
<p>通常情况下企业内仓储依赖是</p>

<div class="mermaid" align="center">graph LR
本地仓库A & 本地仓库B & 本地仓库C --> 企业私服Nexus-->阿里云Nexus-->中央仓库</div><p><img src="https://maven.apache.org/repository/maven-repositories.png" alt="依赖图">
其中repository Manager 企业内会用nexus等</p>
<h2 id="文件规范">文件规范</h2>
<p>java 源文件：src/main/java<br>
测试用例目录：src/test/java<br>
输出文件： target/<br>
配置文件： src/main/resources/<br>
web：src/main/webapp<br>
包含/WEB-INF/web.xml<br>
pom 增加</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>
</span></span></code></pre></div><h2 id="settings文件">settings文件</h2>
<p>settings文件有两处配置，总配置和用户</p>
<ul>
<li>The Maven install: <code>${maven.home}/conf/settings.xml</code></li>
<li>A user&rsquo;s install: <code>${user.home}/.m2/settings.xml</code></li>
</ul>
<h3 id="servers">Servers</h3>
<p>配置账号密码 sshkey等</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">1.  `<span class="nt">&lt;servers&gt;</span>`
</span></span><span class="line"><span class="cl">2.  `<span class="nt">&lt;server&gt;</span>`
</span></span><span class="line"><span class="cl">3.  `<span class="nt">&lt;id&gt;</span>server001<span class="nt">&lt;/id&gt;</span>`
</span></span><span class="line"><span class="cl">4.  `<span class="nt">&lt;username&gt;</span>my_login<span class="nt">&lt;/username&gt;</span>`
</span></span><span class="line"><span class="cl">5.  `<span class="nt">&lt;password&gt;</span>my_password<span class="nt">&lt;/password&gt;</span>`
</span></span><span class="line"><span class="cl">6.  `<span class="nt">&lt;privateKey&gt;</span>${user.home}/.ssh/id_dsa<span class="nt">&lt;/privateKey&gt;</span>`
</span></span><span class="line"><span class="cl">7.  `<span class="nt">&lt;passphrase&gt;</span>some_passphrase<span class="nt">&lt;/passphrase&gt;</span>`
</span></span><span class="line"><span class="cl">8.  `<span class="nt">&lt;filePermissions&gt;</span>664<span class="nt">&lt;/filePermissions&gt;</span>`
</span></span><span class="line"><span class="cl">9.  `<span class="nt">&lt;directoryPermissions&gt;</span>775<span class="nt">&lt;/directoryPermissions&gt;</span>`
</span></span><span class="line"><span class="cl">10.  `<span class="nt">&lt;configuration&gt;&lt;/configuration&gt;</span>`
</span></span><span class="line"><span class="cl">11.  `<span class="nt">&lt;/server&gt;</span>`
</span></span><span class="line"><span class="cl">12.  `<span class="nt">&lt;/servers&gt;</span>`
</span></span></code></pre></div><h3 id="mirrors">Mirrors</h3>
<p>镜像：对repository的代理，默认的repository的id:<strong>central</strong>，所以一般mirrorOf会配置central,也可以是*，会对所有的repository替换。<br>
虽然 mirrors 可以配置多个子节点，但是它只会使用其中的一个节点，即 默认情况下配置多个 mirror 的情况下，只有第一个生效，只有当前一个 mirror 无法连接的时候，才会去找后一个；而我们想要的效果是：当a.jar在第一个 mirror 中不存在的时候，maven会去第二个 mirror 中查询下载，但是maven不会这样做！</p>
<pre tabindex="0"><code>1.  `&lt;mirrors&gt;`
2.  `&lt;mirror&gt;`
3.  `&lt;id&gt;planetmirror.com&lt;/id&gt;`
4.  `&lt;name&gt;PlanetMirror Australia&lt;/name&gt;`
5.  `&lt;url&gt;http://downloads.planetmirror.com/pub/maven2&lt;/url&gt;`
6.  `&lt;mirrorOf&gt;central&lt;/mirrorOf&gt;`
7.  `&lt;/mirror&gt;`
8.  `&lt;/mirrors&gt;`
</code></pre><h2 id="pom文件">POM文件</h2>
<h3 id="pom介绍">POM介绍</h3>
<p>pom project object model
完整官方文档：https://maven.apache.org/pom.html</p>
<h3 id="基础例子">基础例子</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">  <span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- maven 模型版本--&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 分组编号一般是公司域名--&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="c">&lt;!-- 工件编号一般是项目模块--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;artifactId&gt;</span>my-project.xxx<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;/project&gt;</span>
</span></span></code></pre></div><p>maven 约定大于配置
好处：</p>
<ol>
<li>省去配置</li>
<li>规范开发规范</li>
</ol>
<h3 id="package">package:</h3>
<p>package同时会执行compile</p>
<h3 id="test">test</h3>
<p>Test开头的类名和test开头的方法名才会被执行<br>
如果引入junit 包，上一条就失效</p>
<h2 id="项目依赖">项目依赖</h2>
<p>项目依赖是指maven通过以来传播、依赖优先、可选依赖、排除依赖、依赖范围等特性来管理项目ClassPath。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220813224337.png" alt=""></p>
<h3 id="依赖传播">依赖传播</h3>
<p>我们的项目通常会依赖第三方组件，第三方组建又会依赖其他组件遇到这种情况Maven会将依赖网络中的所有节点都会加入ClassPath。</p>
<h3 id="依赖优先">依赖优先</h3>
<ol>
<li>就近原则,链路短的优先</li>
</ol>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220813230537.png" alt=""></p>
<ol start="2">
<li>相同路径下配置在前的优先<br>但是一个pom文件下，后面的优先（并不规范，一个pom文件里不应该写两个一样的依赖）</li>
</ol>
<h3 id="可选依赖">可选依赖</h3>
<p>如果不希望依赖的包传递引用包，可以打断依赖传递</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
</span></span></code></pre></div><h3 id="排除依赖">排除依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 排除依赖 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/exclustions&gt;</span>
</span></span></code></pre></div><h3 id="依赖范围">依赖范围</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;scope&gt;&lt;/scope&gt;</span>
</span></span></code></pre></div><p>可选的范围</p>
<ol>
<li>complie（默认），编译和打包都会依赖</li>
<li>provided：编译时依赖，打包不会依赖。ex: servlet-api.jar(tomcat 存在),lombok</li>
<li>runtime:运行时范围，打包时依赖，编译时不依赖。mysql-connector-java.jar<br>官方解释：this scope indicates that the dependency is not required for compilation, but is for execution. It is in the runtime and test classpaths, but not the compile classpath.</li>
<li>test:测试类依赖</li>
<li>system:类似provided，可指定本地位置</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>操作系统</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>linux</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>linux工具</h1>

<h2 id="figlet-字符画制作工具">figlet 字符画制作工具</h2>
<p>figlet -w yuvenhol~</p>
<pre tabindex="0"><code> __   __         __     __                 _               _   /\/|
 \ \ / /  _   _  \ \   / /   ___   _ __   | |__     ___   | | |/\/ 
  \ V /  | | | |  \ \ / /   / _ \ | &#39;_ \  | &#39;_ \   / _ \  | |      
   | |   | |_| |   \ V /   |  __/ | | | | | | | | | (_) | | |      
   |_|    \__,_|    \_/     \___| |_| |_| |_| |_|  \___/  |_|      
                                                                   
</code></pre><h2 id="alias">alias</h2>
<p>alias[别名]=[指令名称]
删除unalias 别名</p>
<h2 id="nohup">nohup</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">nohup <span class="nb">command</span> &gt; myout.file 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span></code></pre></div><p>2表示异常输出 1表示标准输出 2&gt;&amp;1 异常输出打到标准输出里。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>linux目录</h1>

<table>
<thead>
<tr>
<th style="text-align:left">目录</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">/bin</td>
<td>bin 是 Binaries (二进制文件) 的缩写, 这个目录存放着最经常使用的命令。</td>
</tr>
<tr>
<td style="text-align:left">/sbin</td>
<td>s 就是 Super User 的意思，是 Superuser Binaries (超级用户的二进制文件) 的缩写，这里存放的是系统管理员使用的系统管理程序。</td>
</tr>
<tr>
<td style="text-align:left">/etc</td>
<td>存放系统管理和配置文件</td>
</tr>
<tr>
<td style="text-align:left">/opt</td>
<td>额外安装的可选应用程序包所放置的位置。</td>
</tr>
<tr>
<td style="text-align:left">/proc</td>
<td>虚拟文件系统目录，是系统内存的映射，可以查看正在运行程序的状态。</td>
</tr>
<tr>
<td style="text-align:left">/boot</td>
<td>这里存放的是启动 Linux 时使用的一些核心文件，包括一些连接文件以及镜像文件。</td>
</tr>
<tr>
<td style="text-align:left">/root</td>
<td>该目录为系统管理员，也称作超级权限者的用户主目录。</td>
</tr>
<tr>
<td style="text-align:left">/dev</td>
<td>dev 是 Device(设备) 的缩写, 该目录下存放的是 Linux 的外部设备，在 Linux 中访问设备的方式和访问文件的方式是相同的。</td>
</tr>
<tr>
<td style="text-align:left">/lost+found</td>
<td>这个目录平时是空的，系统非正常关机而留下“无家可归”的文件（windows下叫什么.chk）就在这里</td>
</tr>
<tr>
<td style="text-align:left">/var</td>
<td>用于存放运行时需要改变数据的文件，也是某些大文件的溢出区</td>
</tr>
<tr>
<td style="text-align:left">/tmp</td>
<td>用于存放各种临时文件，是公用的临时文件存储点。</td>
</tr>
<tr>
<td style="text-align:left">/mnt</td>
<td>临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。</td>
</tr>
<tr>
<td style="text-align:left">/media</td>
<td>linux 系统会自动识别一些设备，例如U盘、光驱等等，当识别后，Linux 会把识别的设备挂载到这个目录下。</td>
</tr>
<tr>
<td style="text-align:left">/home</td>
<td>存放所有用户文件的根目录，是用户主目录的基点</td>
</tr>
<tr>
<td style="text-align:left">/usr</td>
<td>用于存放系统应用程序，比较重要的目录。这是最庞大的目录，要用到的应用程序和文件几乎都在这个目录。</td>
</tr>
<tr>
<td style="text-align:left">/usr/local</td>
<td>本地系统管理员软件安装目录（安装系统级的应用）</td>
</tr>
<tr>
<td style="text-align:left">/usr/doc</td>
<td>linux文档</td>
</tr>
<tr>
<td style="text-align:left">/usr/man</td>
<td>帮助文档</td>
</tr>
<tr>
<td style="text-align:left">/usr/lib</td>
<td>常用的动态链接库和软件包的配置文件</td>
</tr>
<tr>
<td style="text-align:left">/usr/sbin</td>
<td>超级用户的一些管理程序</td>
</tr>
<tr>
<td style="text-align:left">/usr/include</td>
<td>linux下开发和编译应用程序所需要的头文件</td>
</tr>
<tr>
<td style="text-align:left">/usr/src</td>
<td>源代码，linux内核的源代码就放在/usr/src/linux里</td>
</tr>
<tr>
<td style="text-align:left">usr/local/bin</td>
<td>本地增加的命令</td>
</tr>
<tr>
<td style="text-align:left">/usr/local/lib</td>
<td>本地增加的库</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
</tr>
</tbody>
</table>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>shell</h1>

<p>-c 表示后面的参数将会作为字符串读入作为执行的命令。
ex：</p>
<ul>
<li><code>/bin/bash -c ls</code></li>
<li><code>/bin/bash ls</code></li>
</ul>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221115135920.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>SSH</h1>

<h1 id="不同host指定使用不同密钥">不同host指定使用不同密钥</h1>
<p>在.ssh/下创建一个config文件</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Host hostA
</span></span><span class="line"><span class="cl">    HostName www.abc.com
</span></span><span class="line"><span class="cl">    Port 1234
</span></span><span class="line"><span class="cl">    User test
</span></span><span class="line"><span class="cl">    IdentityFile ~\.ssh\id_rsa
</span></span><span class="line"><span class="cl">Host hostB
</span></span><span class="line"><span class="cl">    HostName 123.456.789.000
</span></span><span class="line"><span class="cl">    Port 5678
</span></span><span class="line"><span class="cl">    User root
</span></span><span class="line"><span class="cl">    IdentityFile ~\.ssh\id_rsa
</span></span></code></pre></div><h1 id="给linux实例添加新增ssh公钥">给linux实例添加新增SSH公钥</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># ssh public key to be added.</span>
</span></span><span class="line"><span class="cl"><span class="nv">sshPublicKey</span><span class="o">=</span><span class="s2">&#34;{{sshPublicKey}}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -p ~/.ssh <span class="o">&amp;&amp;</span> chmod <span class="m">700</span> ~/.ssh 
</span></span><span class="line"><span class="cl">touch ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$sshPublicKey</span> &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;operation success!&#34;</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>启动执行脚本</h1>

<p>/etc/</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>命令组合</h1>

<h3 id="统计某个目录下所有文件的字符数">统计某个目录下所有文件的字符数</h3>
<p>find . -type f|grep .md |tr \n \0|xargs -0 cat|wc -m</p>
<h3 id="统计日志中某个数值次数">统计日志中某个数值次数</h3>
<p>zcat request.log.2022-10-28.gz |grep uri=/mobile/wx/card/select |awk &lsquo;BEGIN{FS=&quot; &ldquo;} {print $2,$5}&rsquo;|awk -F &rsquo;time=&rsquo; &lsquo;{if($2 &gt; 500) print $1,$2}&rsquo;</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>如何区分terminal、tty、console、shell</h1>

<p>从词源上来说：
terminal是电线的末端、
shell是乌龟的壳
tty是teletype远程打字机的缩写
console是一种家具</p>
<p>简单来说在unix环境下：</p>
<ul>
<li>terminal = tty = 文本输入/输出环境</li>
<li>console = 物理终端</li>
<li>shell = 命令行解释器</li>
</ul>
<p>tty是一种特殊的设备文件，多数情况下tty和terminal是同义词，一些tty由内核代表硬件设备提供，ex：键盘输入。另一些的tty被称为伪tty，由终端仿真器提供。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>文件相关</h1>

<h2 id="touch">touch</h2>
<p>修改文件的创建和修改时间，现在常用于创建一个文件。</p>
<h2 id="find">find</h2>
<p>find path -name &ldquo;支持 * ？&rdquo; [-delete]</p>
<h2 id="grep">grep</h2>
<h2 id="ln">ln</h2>
<p>ln -s 软连接 ln 硬连接，软连接更常用，不存在文件时也可以创建软连接，类似于快捷方式。硬连接是指向一个文件实体的指针，文件夹不创建硬连接，不同文件系统或者硬件不能创建硬连接，硬连接可以多人共享文件，防止误删。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>文本相关</h1>

<blockquote>
<p>cat: 直接把文件一次性输出</p>
<p>more：在打开一个很大的文件的时，vim等工具会把整个文件加载到内存，但是有时我们只是简单的查看一下，此时可以用到more</p>
</blockquote>
<p>less：less是more是一个升级版，正所谓 <strong>less is more</strong></p>
<h1 id="less">less</h1>
<table>
<thead>
<tr>
<th>常用参数</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>-N</td>
<td>展示行号</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>space</td>
<td>下一页</td>
</tr>
<tr>
<td>b</td>
<td>上半页</td>
</tr>
<tr>
<td>u</td>
<td>上半页</td>
</tr>
<tr>
<td>d</td>
<td>下半页</td>
</tr>
</tbody>
</table>
<h1 id="tr">tr</h1>
<p>文本替换工具
ex：把换行符替换为null值</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">tr <span class="se">\\</span>n <span class="se">\\</span><span class="m">0</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>用户相关</h1>

<h1 id="删除用户">删除用户</h1>
<ol>
<li>先用命令 cat /etc/passwd 查看一下所有的用户 可以看到你需要删除的用户名</li>
<li>用命令 who 查询当前登录的用户</li>
<li>用命令 ps -u 用户名 查看该用户的pid</li>
<li>用命令 kill pid 杀掉他的sshd或者是shell进程</li>
<li>再用命令 userdel -r 用户名 删除用户</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>系统监控命令</h1>

<h1 id="系统资源">系统资源</h1>
<h2 id="top">top</h2>
<p>定义：display sorted information about processes</p>
<table>
<thead>
<tr>
<th>展示项目</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>Percentage of processor usage, broken into user, system, and idle components.  The time period for which these percentages are calculated depends on the event counting mode.</td>
</tr>
<tr>
<td>Disks</td>
<td>Number and total size of disk reads and writes.</td>
</tr>
<tr>
<td>LoadAvg</td>
<td>Load average over 1, 5, and 15 minutes.  The load average is the average number of jobs in the run queue.</td>
</tr>
<tr>
<td>MemRegions</td>
<td>Number and total size of memory regions, and total size of memory regions broken into private (broken into non-library and library) and shared components.</td>
</tr>
<tr>
<td>Networks</td>
<td>Number and total size of input and output network packets</td>
</tr>
<tr>
<td>PhysMem</td>
<td>Physical memory usage, broken into wired, active, inactive, used, and free components.</td>
</tr>
<tr>
<td>Procs</td>
<td>Total number of processes and number of processes in each process state.</td>
</tr>
<tr>
<td>SharedLibs</td>
<td>Resident sizes of code and data segments, and link editor memory usage.</td>
</tr>
<tr>
<td>Threads</td>
<td>Number of threads.</td>
</tr>
</tbody>
</table>
<h2 id="iotop-磁盘情况查看">iotop 磁盘情况查看</h2>
<h2 id="ulimit-查看系统资源限制">ulimit 查看系统资源限制</h2>
<p>-a 列出所有当前资源极限</p>
<p>-c 设置core文件的最大值.单位:blocks</p>
<p>-d 设置一个进程的数据段的最大值.单位:kbytes</p>
<p>-f Shell 创建文件的文件大小的最大值，单位：blocks</p>
<p>-h 指定设置某个给定资源的硬极限。如果用户拥有 root 用户权限，可以增大硬极限。任何用户均可减少硬极限</p>
<p>-l 可以锁住的物理内存的最大值</p>
<p>-m 可以使用的常驻内存的最大值,单位：kbytes</p>
<p>-n 每个进程可以同时打开的最大文件数</p>
<p>-p 设置管道的最大值，单位为block，1block=512bytes</p>
<p>-s 指定堆栈的最大值：单位：kbytes</p>
<p>-S 指定为给定的资源设置软极限。软极限可增大到硬极限的值。如果 -H 和 -S 标志均未指定，极限适用于以上二者</p>
<p>-t 指定每个进程所使用的秒数,单位：seconds</p>
<p>-u 可以运行的最大并发进程数</p>
<p>-v Shell可使用的最大的虚拟内存，单位：kbytes</p>
<h1 id="网络相关">网络相关</h1>
<h2 id="netstat">netstat</h2>
<p>netstat -atl</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>列出所有</td>
</tr>
<tr>
<td>-l</td>
<td>只查看listen端口</td>
</tr>
<tr>
<td>-v</td>
<td>增加详细程度，特别是通过添加一列来显示与每个打开的端口关联的进程ID(pid)</td>
</tr>
<tr>
<td>-p</td>
<td>Show the PID and name of the program to which each socket belongs.</td>
</tr>
<tr>
<td>-u</td>
<td>udp</td>
</tr>
<tr>
<td>-t</td>
<td>tcp</td>
</tr>
<tr>
<td>-</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="lsof">lsof</h2>
<p>mac下查看网络端口查看
lsof - list open files
在linux下一切皆文件，一个网络连接也是一个文件。
lsof -i 查看网络连接的文件
在mac系统下netstat是简化版的，用lsof 替代</p>
<h2 id="ifconfig">ifconfig</h2>
<p>lo0 :localhost
eth0:eth0是光纤以太网接口卡。学名FiberEthernetAdapter0</p>
<h2 id="export-环境变量相关操作">export 环境变量相关操作</h2>
<p>Linux export 命令用于设置或显示环境变量。</p>
<p>在 shell 中执行程序时，shell 会提供一组环境变量。export 可新增，修改或删除环境变量，供后续执行的程序使用。export 的效力仅限于该次登陆操作，如果在配置文件中添加可以持续有效。
export [-fnp][变量名称]=[变量设置值]</p>
<ul>
<li>-f 　代表[变量名称]中为函数名称。</li>
<li>-n 　删除指定的变量。变量实际上并未删除，只是不会输出到后续指令的执行环境中。</li>
<li>-p 　列出所有的shell赋予程序的环境变量。</li>
</ul>
<h3 id="例子">例子</h3>
<p>在.zprofile 里面
export WS=/Users/yuwenhao/Programs/work-space</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>零拷贝</h1>

<h1 id="什么是零拷贝">什么是零拷贝</h1>
<p>“零”：表示次数是0，它表示拷贝数据的次数是0</p>
<p>“拷贝”：指数据从一个存储区域转移到另一个存储区域</p>
<p>合起来，那零拷贝就是不需要将数据从一个存储区域复制到另一个存储区域。</p>
<blockquote>
<p>零拷贝是指计算机执行IO操作时，CPU不需要将数据从一个存储区域复制到另一个存储区域，进而减少上下文切换以及CPU的拷贝时间。它是一种IO操作优化技术。</p>
</blockquote>
<h1 id="传统io的执行流程">传统IO的执行流程</h1>
<p>比如想实现一个下载功能，服务端的任务就是：将服务器主机磁盘中的文件从已连接的socket中发出去，关键代码如下</p>
<p>while((n = read(diskfd, buf, BUF_SIZE)) &gt; 0)</p>
<p>write(sockfd, buf , n);</p>
<p>传统的IO流程包括read以及write的过程</p>
<p>read:将数据从磁盘读取到内核缓存区中，在拷贝到用户缓冲区</p>
<p>write:先将数据写入到socket缓冲区中，最后写入网卡设备</p>
<p>流程图如下
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211748331" alt="">
1.应用程序调用read函数，向操作系统发起IO调用，<em>上下文从用户态切换至内核态</em></p>
<p>2.DMA控制器把数据从磁盘中读取到内核缓冲区</p>
<p>3.CPU把内核缓冲区数据拷贝到用户应用缓冲区，<em>上下文从内核态切换至用户态</em>，此时read函数返回</p>
<p>4.用户应用进程通过write函数，发起IO调用，<em>上下文从用户态切换至内核态</em></p>
<p>5.CPU将缓冲区的数据拷贝到socket缓冲区</p>
<p>6.DMA控制器将数据从socket缓冲区拷贝到网卡设备，<em>上下文从内核态切换至用户态</em>，此时write函数返回</p>
<p>从流程图中可以看出传统的IO流程包括<em><strong>4次上下文的切换</strong></em>，<em>4次拷贝数据</em>(两次CPU拷贝以及两次DMA拷贝)</p>
<h1 id="前置知识">前置知识</h1>
<h2 id="内核空间和用户空间">内核空间和用户空间</h2>
<p>我们电脑上跑着的应用程序，其实是需要经过操作系统，才能做一些特殊操作，如磁盘文件读写、内存的读写等等。因为这些都是比较危险的操作，不可以由应用程序乱来，只能交给底层操作系统来。</p>
<p>因此，操作系统为每个进程都分配了内存空间，一部分是用户空间，一部分是内核空间。内核空间是操作系统内核访问的区域，是受保护的内存空间，而用户空间是用户应用程序访问的内存区域。 以32位操作系统为例，它会为每一个进程都分配了4G(2的32次方)的内存空间。</p>
<p>内核空间：主要提供进程调度、内存分配、连接硬件资源等功能</p>
<p>用户空间：提供给各个程序进程的空间，它不具有访问内核空间资源的权限，如果应用程序需要使用到内核空间的资源，则需要通过系统调用来完成。进程从用户空间切换到内核空间，完成相关操作后，再从内核空间切换回用户空间。</p>
<h2 id="用户态和内核态">用户态和内核态</h2>
<p>如果进程运行于内核空间，被称为进程的内核态。</p>
<p>如果进程运行于用户空间，被称为进程的用户态。</p>
<h2 id="什么是上下文切换">什么是上下文切换</h2>
<p>什么是上下文</p>
<blockquote>
<p>CPU 寄存器，是CPU内置的容量小、但速度极快的内存。而程序计数器，则是用来存储 CPU 正在执行的指令位置、或者即将执行的下一条指令位置。它们都是 CPU 在运行任何任务前，必须的依赖环境，因此叫做CPU上下文。</p>
</blockquote>
<p>什么是上下文切换</p>
<blockquote>
<p>它是指，先把前一个任务的CPU上下文（也就是CPU寄存器和程序计数器）保存起来，然后加载新任务的上下文到这些寄存器和程序计数器，最后再跳转到程序计数器所指的新位置，运行新任务。</p>
</blockquote>
<p>一般我们说的上下文切换，就是指内核（操作系统的核心）在CPU上对进程或者线程进行切换。进程从用户态到内核态的转变，需要通过系统调用来完成。系统调用的过程，会发生CPU上下文的切换。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211749748" alt=""></p>
<h2 id="虚拟内存">虚拟内存</h2>
<p>现代操作系统使用虚拟内存，即虚拟地址取代物理地址，使用虚拟内存可以有2个好处：</p>
<p>1.虚拟内存空间可以远远大于物理内存空间</p>
<p>2.多个虚拟内存可以指向同一个物理地址</p>
<p>正是多个虚拟内存可以指向同一个物理地址，可以把内核空间和用户空间的虚拟地址映射到同一个物理地址，这样的话，就可以减少IO的数据拷贝次数，示意图如下
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211747896" alt=""></p>
<h2 id="dma技术">DMA技术</h2>
<p>DMA，英文全称是Direct Memory Access，即直接内存访问。DMA本质上是一块主板上独立的芯片，允许外设设备和内存存储器之间直接进行IO数据传输，其过程不需要CPU的参与。</p>
<p>简单的说它就是帮住CPU转发一下IO请求以及拷贝数据，那为什么需要它呢？其实主要是效率问题。它帮忙CPU做事情，这时候，CPU就可以闲下来去做别的事情，提高了CPU的利用效率。大白话解释就是，CPU老哥太忙太累啦，所以他找了个小弟（名叫DMA） ，替他完成一部分的拷贝工作，这样CPU老哥就能着手去做其他事情。</p>
<p>下面看下DMA具体是做了哪些工作</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211750952" alt="">
1.用户应用程序调read函数，向操作系统发起IO调用，进入阻塞状态等待数据返回</p>
<p>2.CPU接到指令后，对DMA控制器发起指令调度</p>
<p>3.DMA收到请求后，将请求发送给磁盘</p>
<p>4.磁盘将数据放入磁盘控制缓冲区并通知DMA</p>
<p>5.DMA将数据从磁盘控制器缓冲区拷贝到内核缓冲区</p>
<p>6.DMA向CPU发送数据读完的信号，CPU负责将数据从内核缓冲区拷贝到用户缓冲区</p>
<p>7.用户应用进程由内核态切回用户态，解除阻塞状态</p>
<h1 id="如何实现零拷贝">如何实现零拷贝</h1>
<p>零拷贝并不是没有拷贝数据，而是减少用户态、内核态的切换次数以及CPU拷贝次数；实现零拷贝主要有三种方式分别是</p>
<p>1.mmap + write</p>
<p>2.sendfile</p>
<p>3.带有DMA收集拷贝功能的sendfile</p>
<h2 id="mmap">mmap</h2>
<p>mmap的函数原型如下</p>
<p>void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);</p>
<p>addr:指定映射的虚拟内存地址</p>
<p>length:映射的长度</p>
<p>prot:映射内存的保护模式</p>
<p>flags:指定映射的类型</p>
<p>fd:进行映射的文件句柄</p>
<p>offset:文件偏移量</p>
<p>前面一小节，我们介绍了虚拟内存，可以把内核空间和用户空间的虚拟地址映射到同一个物理地址，从而减少数据拷贝次数！mmap就是用了虚拟内存这个特点，它将内核中的读缓冲区与用户空间的缓冲区进行映射，所有的IO都在内核中完成。mmap+write实现的零拷贝流程如下：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211757594" alt=""></p>
<p>1.用户进程通过调用mmap方法向操作系统内核发起IO调用，<em>上下文从用户态切换至内核态</em></p>
<p>2.CPU利用DMA控制器，将数据从硬盘拷贝到内核缓冲区</p>
<p>3.<em>上下文从内核态切换回用户态</em>，mmap方法返回</p>
<p>4.用户进程通过调用write方法向操作系统内核再次发起IO调用，<em>上下文从用户态切换至内核态</em></p>
<p>5.CPU将内核缓冲区的数据拷贝到socket缓冲区</p>
<p>6.CPU利用DMA控制器，将数据从socket缓冲器拷贝到网卡，<em>上下文从内核态切换至用户态</em>，write方法返回</p>
<p>可以发现，mmap+write实现的零拷贝其中发生了4次上线文切换以及3次拷贝(2次DMA拷贝+1次cpu拷贝)</p>
<h2 id="sendfile">sendfile</h2>
<p>sendfile是Linux2.1版本后内核引入 的一个系统调用函数，原型如下</p>
<p>ssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count);</p>
<p>out_fd:为待写入内容的文件描述符</p>
<p>in_fd:为待读出内容的文件描述符</p>
<p>offset:文件偏移量</p>
<p>count:指定在fdout和fdin之间传输的字节数</p>
<p>sendfile表示在两个文件描述符之间传输数据，它是在操作系统内核中操作的，避免了数据从内核缓冲区和用户缓冲区之间的拷贝操作，因此可以使用它来实现零拷贝。sendfile实现的零拷贝流程如下：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211759899" alt="">
1.用户进程发起sendfile系统调用，<em>上下文从用户态切换至内核态</em></p>
<p>2.DMA控制器将数据从硬盘拷贝到内核缓冲区</p>
<p>3.CPU将读缓冲区中的数据拷贝到socket缓冲区</p>
<p>4.DMA控制器异步把数据从socket缓冲器拷贝到网卡</p>
<p>5.<em>上下文从内核态切换至用户态</em>，sendfile函数返回</p>
<p>可以发现，sendfile实现的零拷贝仅仅发生了2次上下文切换以及3次拷贝(2次DMA拷贝+1次CPU拷贝)</p>
<p><em>sendfile +DMA scatter/gather实现的零拷贝</em></p>
<p>linux2.4版本后，对sendfile做了优化升级，引入SG-DMA技术，其实就是对DMA拷贝加入了scatter/gather操作，它可以直接从内核空间缓冲区中将数据读取到网卡，这样的话还可以省去CPU拷贝。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/202212211759197" alt="">
1.用户进程发起sendfile系统调用，<em>上下文从用户态切换至内核态</em></p>
<p>2.DMA控制器将数据从磁盘拷贝到内核缓冲器</p>
<p>3.CPU把内核缓冲区中的文件描述符信息（包括内核缓冲区的内存地址和偏移量）直接发送到socket缓冲区</p>
<p>4.DMA控制器根据文件描述符信息直接把数据从内核缓冲区拷贝到网卡</p>
<p>5.<em>上下文切换至用户态</em>，sendfile返回</p>
<p>可以发现sendfile + DMA scatter/gather实现的零拷贝发生了2次上下文切换以及2次数据拷贝，这就是真正的零拷贝技术，全程没有通过CPU来搬运数据，所有的数据都是通过DMA进行传输的。</p>
<h1 id="java提供的零拷贝方式">java提供的零拷贝方式</h1>
<h2 id="mmap-1">mmap</h2>
<p>Java NIO有一个MappedByteBuffer的类可以用来实现内存映射。它的底层是调用的linux内核的mmap的API</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MmapTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">FileChannel</span> <span class="n">readChannel</span> <span class="o">=</span> <span class="n">FileChannel</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;./jay.txt&#34;</span><span class="o">),</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">READ</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MappedByteBuffer</span> <span class="n">data</span> <span class="o">=</span> <span class="n">readChannel</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">FileChannel</span><span class="o">.</span><span class="na">MapMode</span><span class="o">.</span><span class="na">READ_ONLY</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">1024</span> <span class="o">*</span> <span class="n">1024</span> <span class="o">*</span> <span class="n">40</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">FileChannel</span> <span class="n">writeChannel</span> <span class="o">=</span> <span class="n">FileChannel</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;./siting.txt&#34;</span><span class="o">),</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">WRITE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//数据传输
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">writeChannel</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">readChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">writeChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="sendfile-1">sendfile</h2>
<p>FileChannel的transferTo()/transferFrom()，底层就是sendfile() 系统调用函数。<a href="https://so.csdn.net/so/search?q=Kafka&amp;spm=1001.2101.3001.7020">Kafka</a> 这个开源项目就用到它，平时面试的时候，回答面试官为什么这么快，就可以提到零拷贝sendfile这个点</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SendFileTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">FileChannel</span> <span class="n">readChannel</span> <span class="o">=</span> <span class="n">FileChannel</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;./jay.txt&#34;</span><span class="o">),</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">READ</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">long</span> <span class="n">len</span> <span class="o">=</span> <span class="n">readChannel</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">long</span> <span class="n">position</span> <span class="o">=</span> <span class="n">readChannel</span><span class="o">.</span><span class="na">position</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">FileChannel</span> <span class="n">writeChannel</span> <span class="o">=</span> <span class="n">FileChannel</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;./siting.txt&#34;</span><span class="o">),</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">WRITE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//数据传输
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">readChannel</span><span class="o">.</span><span class="na">transferTo</span><span class="o">(</span><span class="n">position</span><span class="o">,</span> <span class="n">len</span><span class="o">,</span> <span class="n">writeChannel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">readChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">writeChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>操作系统</h1>

<p><a href="https://www.yuque.com/books/share/227872c0-1f19-4c83-960e-5e13e39343c8/fi6mb2">https://www.yuque.com/books/share/227872c0-1f19-4c83-960e-5e13e39343c8/fi6mb2</a></p>
<p>为了防止出现内存地址碰撞，操作系统引入了虚拟内存，进程持有的虚拟地址会通过 CPU 芯片中的内存管理单元（MMU）的映射关系，来转换变成物理地址，然后再通过物理地址访问内存。</p>
<p>互斥与同步：
互斥：不能同时执行
同步：要求按照顺序执行</p>
<p>系统调用：
<a href="http://c.biancheng.net/view/1195.html">http://c.biancheng.net/view/1195.html</a></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>数据库</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>mysql</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>三大范式</h1>

<p>1、字段意义不可分割，不能是数组等集合或者表达多个意义。
2、每个字段都依赖主键
3、依赖不可传递，比如 A-&gt;B-&gt;C 不行的，必须A-&gt;C,B-&gt;C。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>预处理</h1>

<h2 id="mysql-prepare-语句简介">MySQL PREPARE 语句简介</h2>
<p>在MySQL 4.1版之前，查询以文本格式发送到MySQL服务器。反过来，MySQL使用文本协议将数据返回给客户端。MySQL必须  完全 解析查询并将结果集转换为字符串，然后再将其返回给客户端。</p>
<p>文本协议具有严重的性能影响。为了解决这个问题，MySQL从4.1版开始添加了一个名为prepared的新功能。</p>
<p>准备好的语句利用<a href="https://dev.mysql.com/doc/internals/en/client-server-protocol.html" title="MySQL客户端/服务器协议">客户端/服务器二进制协议</a>。它将包含占位符（？）的查询传递给MySQL服务器，如下例所示：</p>
<p>SELECT *
FROM products
WHERE productCode = ?;</p>
<p>当MySQL使用不同的<code>productcode</code>值执行此查询时，它不必完全解析查询。因此，这有助于MySQL更快地执行查询，尤其是当MySQL多次执行查询时。因为预准备语句使用占位符（？），这有助于避免SQL注入的许多变体，从而使您的应用程序更安全。</p>
<hr>
<h2 id="mysql-prepare-语句用法">MySQL PREPARE 语句用法</h2>
<p>为了使用MySQL预处理语句，您需要使用其他三个MySQL语句，如下所示：</p>
<ul>
<li>PREPARE - 准备要执行的语句。</li>
<li>EXECUTE - 执行由PREPARE语句准备的预准备语句。</li>
<li>DEALLOCATE PREPARE - 发布准备好的声明。</li>
</ul>
<p>下图说明了如何使用预准备语句：</p>
<p><img src="http://www.begtut.com/wp-content/uploads/2019/08/MySQL-Prepared-Statement.png" alt="" title="MySQL准备好的声明"></p>
<hr>
<h2 id="mysql编写了语句实例">MySQL编写了语句实例</h2>
<p>让我们看一下使用MySQL预处理语句的示例。</p>
<p>PREPARE stmt1 FROM &lsquo;SELECT productCode, productName
FROM products
WHERE productCode = ?&rsquo;;</p>
<p>SET @pc = &lsquo;S10_1678&rsquo;;
EXECUTE stmt1 USING @pc;</p>
<p>DEALLOCATE PREPARE stmt1;</p>
<p>首先，我们使用<code>PREPARE</code>语句准备执行语句。我们使用  <a href="https://www.begtut.com/mysql/mysql-select-statement-query-data.html" title="MySQL SELECT语句">SELECT</a>语句根据指定的产品代码查询<code>products</code>表中的产品数据  。我们使用问号（？）作为产品代码的占位符。</p>
<p>接下来，我们声明了一个产品代码变量  <code>@pc</code>并将其值设置为<code>S10_1678</code>。</p>
<p>然后，我们使用<code>EXECUTE</code>语句用产品代码变量执行预准备语句<code>@pc</code>。</p>
<p>最后，我们用它  <code>DEALLOCATE PREPARE</code>来发布准备好的声明。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>事务</h1>

<h1 id="事务的概念">事务的概念</h1>
<p>事务的意义就是为了保证系统中所有数据的都是符合预期的，且相互关联的数据之间不会产生矛盾，即数据状态的<strong>一致性</strong>。</p>
<p>经典数据库理论中，要达成这个目标，需要三方面共同努力来保障。</p>
<ul>
<li><strong>原子性</strong>（<strong>A</strong>tomic）：在同一项业务处理过程中，事务保证了对多个数据的修改，要么同时成功，要么同时被撤销。</li>
<li><strong>隔离性</strong>（<strong>I</strong>solation）：在不同的业务处理过程中，事务保证了各自业务正在读、写的数据互相独立，不会彼此影响。</li>
<li><strong>持久性</strong>（<strong>D</strong>urability）：事务应当保证所有成功被提交的数据修改都能够正确地被持久化，不丢失数据。
事务的四大特性ACID，纯属凑数😓</li>
</ul>
<p>目前事务的概念已经不在局限于数据库方面了，延伸到所有涉及到保证一致性的场景，包括但不限于缓存、消息队列、分布式存储等。</p>
<p>在使用单一数据源的情况下，使用A.I.D保证事务的做法比较容易，事务由数据源控制，被称作局部事务（也叫本地事务），一致性被称为“内部一致性”。
在使用多数据源的情况下，甚至多个服务多个数据源，这时要保证一致性被称为&quot;外部一致性&quot;。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>全局事务</h1>

<p>全局事务（Global Transaction）
全局事务仍然追求ACID的强一致性，适用于在使用多个数据源时。</p>
<h1 id="2pc">2PC</h1>
<p>伪代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">buyBook</span><span class="o">(</span><span class="n">PaymentBill</span> <span class="n">bill</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">userTransaction</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">warehouseTransaction</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">businessTransaction</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">userAccountService</span><span class="o">.</span><span class="na">pay</span><span class="o">(</span><span class="n">bill</span><span class="o">.</span><span class="na">getMoney</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">warehouseService</span><span class="o">.</span><span class="na">deliver</span><span class="o">(</span><span class="n">bill</span><span class="o">.</span><span class="na">getItems</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">businessAccountService</span><span class="o">.</span><span class="na">receipt</span><span class="o">(</span><span class="n">bill</span><span class="o">.</span><span class="na">getMoney</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">userTransaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">warehouseTransaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">businessTransaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">userTransaction</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">warehouseTransaction</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">businessTransaction</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220919145040.png" alt=""></p>
<ul>
<li><strong>准备阶段</strong>：又叫作投票阶段，在这一阶段，协调者询问事务的所有参与者是否准备好提交，参与者如果已经准备好提交则回复 Prepared，否则回复 Non-Prepared。这里所说的准备操作跟人类语言中通常理解的准备并不相同，对于数据库来说，准备操作是在重做日志中记录全部事务提交操作所要做的内容，它与本地事务中真正提交的区别只是暂不写入最后一条 Commit Record 而已，这意味着在做完数据持久化后并不立即释放隔离性，即仍继续持有锁，维持数据对其他非事务内观察者的隔离状态。</li>
<li><strong>提交阶段</strong>：又叫作执行阶段，协调者如果在上一阶段收到所有事务参与者回复的 Prepared 消息，则先自己在本地持久化事务状态为 Commit，在此操作完成后向所有参与者发送 Commit 指令，所有参与者立即执行提交操作；否则，任意一个参与者回复了 Non-Prepared 消息，或任意一个参与者超时未回复，协调者将自己的事务状态持久化为 Abort 之后，向所有参与者发送 Abort 指令，参与者立即执行回滚操作。对于数据库来说，这个阶段的提交操作应是很轻量的，仅仅是持久化一条 Commit Record 而已，通常能够快速完成，只有收到 Abort 指令时，才需要根据回滚日志清理已提交的数据，这可能是相对重负载的操作。</li>
</ul>
<p>以上这两个过程被称为“<a href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4">两段式提交</a>”（2 Phase Commit，2PC）协议，而它能够成功保证一致性还需要一些其他前提条件。</p>
<ul>
<li>必须假设网络在提交阶段的短时间内是可靠的，即提交阶段不会丢失消息。同时也假设网络通信在全过程都不会出现误差，即可以丢失消息，但不会传递错误的消息，XA 的设计目标并不是解决诸如<a href="https://en.wikipedia.org/wiki/Byzantine_fault">拜占庭将军</a>一类的问题。两段式提交中投票阶段失败了可以补救（回滚），而提交阶段失败了无法补救（不再改变提交或回滚的结果，只能等崩溃的节点重新恢复），因而此阶段耗时应尽可能短，这也是为了尽量控制网络风险的考虑。</li>
<li>必须假设因为网络分区、机器崩溃或者其他原因而导致失联的节点最终能够恢复，不会永久性地处于失联状态。由于在准备阶段已经写入了完整的重做日志，所以当失联机器一旦恢复，就能够从日志中找出已准备妥当但并未提交的事务数据，并向协调者查询该事务的状态，确定下一步应该进行提交还是回滚操作。</li>
</ul>
<h2 id="存在的问题">存在的问题</h2>
<ul>
<li><strong>单点问题</strong>：协调者在两段提交中具有举足轻重的作用，协调者等待参与者回复时可以有超时机制，允许参与者宕机，但参与者等待协调者指令时无法做超时处理。一旦宕机的不是其中某个参与者，而是协调者的话，所有参与者都会受到影响。如果协调者一直没有恢复，没有正常发送 Commit 或者 Rollback 的指令，那所有参与者都必须一直等待。</li>
<li><strong>性能问题</strong>：两段提交过程中，所有参与者相当于被绑定成为一个统一调度的整体，期间要经过两次远程服务调用，三次数据持久化（准备阶段写重做日志，协调者做状态持久化，提交阶段在日志写入 Commit Record），整个过程将持续到参与者集群中最慢的那一个处理操作结束为止，这决定了两段式提交的性能通常都较差。</li>
<li><strong>一致性风险</strong>：前面已经提到，两段式提交的成立是有前提条件的，当网络稳定性和宕机恢复能力的假设不成立时，仍可能出现一致性问题。宕机恢复能力这一点不必多谈，1985 年 Fischer、Lynch、Paterson 提出了“<a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)#Solvability_results_for_some_agreement_problems">FLP 不可能原理</a>”，证明了如果宕机最后不能恢复，那就不存在任何一种分布式协议可以正确地达成一致性结果。该原理在分布式中是与“CAP 不可兼得原理“齐名的理论。而网络稳定性带来的一致性风险是指：尽管提交阶段时间很短，但这仍是一段明确存在的危险期，如果协调者在发出准备指令后，根据收到各个参与者发回的信息确定事务状态是可以提交的，协调者会先持久化事务状态，并提交自己的事务，如果这时候网络忽然被断开，无法再通过网络向所有参与者发出 Commit 指令的话，就会导致部分数据（协调者的）已提交，但部分数据（参与者的）既未提交，也没有办法回滚，产生了数据不一致的问题。</li>
</ul>
<h1 id="3pc">3PC</h1>
<p>3PC是针对2PC的优化，分为 Can、Pre、Do 三个阶段。新增了一个Can（询问阶段），如果数据库状态不能保证可以顺利完成，则不锁定资源。三阶段也解决了单点问题，如果协调者超时默认会提交事务。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220919150514.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>本地事务</h1>

<p>[[事务]]</p>
<h1 id="本地事务-local-transaction">本地事务 Local Transaction</h1>
<p>单一数据源，依赖数据库实现一致性。</p>
<h2 id="数据库实现方案">数据库实现方案</h2>
<h3 id="原子性持久性">原子性&amp;持久性</h3>
<p>众所周知，数据必须要成功写入磁盘、磁带等持久化存储器后才能拥有持久性，只存储在内存中的数据，一旦遇到应用程序忽然崩溃，或者数据库、操作系统一侧的崩溃，甚至是机器突然断电宕机等情况就会丢失，后文我们将这些意外情况都统称为“崩溃”（Crash）。实现原子性和持久性的最大困难是“写入磁盘”这个操作并不是原子的，不仅有“写入”与“未写入”状态，还客观地存在着“正在写”的中间状态。正因为写入中间状态与崩溃都不可能消除，所以如果不做额外保障措施的话，将内存中的数据写入磁盘，并不能保证原子性与持久性。下面通过具体事例来说明。</p>
<ul>
<li><strong>未提交事务，写入后崩溃</strong>：程序还没修改完三个数据，但数据库已经将其中一个或两个数据的变动写入磁盘，此时出现崩溃，一旦重启之后，数据库必须要有办法得知崩溃前发生过一次不完整的购物操作，将已经修改过的数据从磁盘中恢复成没有改过的样子，以保证原子性。</li>
<li><strong>已提交事务，写入前崩溃</strong>：程序已经修改完三个数据，但数据库还未将全部三个数据的变动都写入到磁盘，此时出现崩溃，一旦重启之后，数据库必须要有办法得知崩溃前发生过一次完整的购物操作，将还没来得及写入磁盘的那部分数据重新写入，以保证持久性。</li>
<li></li>
</ul>
<p>为了能够顺利地完成崩溃恢复，在磁盘中写入数据就不能像程序修改内存中变量值那样，直接改变某表某行某列的某个值，而是必须将修改数据这个操作所需的全部信息，包括修改什么数据、数据物理上位于哪个内存页和磁盘块中、从什么值改成什么值，等等，以日志的形式——即仅进行顺序追加的文件写入的形式（这是最高效的写入方式）先记录到磁盘中。只有在日志记录全部都安全落盘，数据库在日志中看到代表事务成功提交的“提交记录”（Commit Record）后，才会根据日志上的信息对真正的数据进行修改，修改完成后，再在日志中加入一条“结束记录”（End Record）表示事务已完成持久化，这种事务实现方法被称为“Commit Logging”（提交日志）。</p>
<p>Commit Logging 保障数据持久性、原子性的原理：首先，日志一旦成功写入 Commit Record，那整个事务就是成功的，即使真正修改数据时崩溃了，重启后根据已经写入磁盘的日志信息恢复现场、继续修改数据即可，这保证了持久性；其次，如果日志没有成功写入 Commit Record 就发生崩溃，那整个事务就是失败的，系统重启后会看到一部分没有 Commit Record 的日志，那将这部分日志标记为回滚状态即可，整个事务就像完全没好有发生过一样，这保证了原子性。</p>
<p>commit logging 在提交之前不允许写入磁盘会占用个过多内存缓冲区，性能不高。针对这个问题提出了Write-Ahead Logging方案。
Write-Ahead Logging：
所谓“提前写入”（Write-Ahead），就是允许在事务提交之前，提前写入变动数据的意思。
Write-Ahead Logging 先将何时写入变动数据，按照事务提交时点为界，划分为 FORCE 和 STEAL 两类情况。</p>
<ul>
<li><strong>FORCE</strong>：当事务提交后，要求变动数据必须同时完成写入则称为 FORCE，如果不强制变动数据必须同时完成写入则称为 NO-FORCE。现实中绝大多数数据库采用的都是 NO-FORCE 策略，因为只要有了日志，变动数据随时可以持久化，从优化磁盘 I/O 性能考虑，没有必要强制数据写入立即进行。</li>
<li><strong>STEAL</strong>：在事务提交前，允许变动数据提前写入则称为 STEAL，不允许则称为 NO-STEAL。从优化磁盘 I/O 性能考虑，允许数据提前写入，有利于利用空闲 I/O 资源，也有利于节省数据库缓存区的内存。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220917100422.png" alt="">
write-Ahead logging 恢复</li>
<li><strong>分析阶段</strong>（Analysis）：该阶段从最后一次检查点（Checkpoint，可理解为在这个点之前所有应该持久化的变动都已安全落盘）开始扫描日志，找出所有没有 End Record 的事务，组成待恢复的事务集合，这个集合至少会包括 Transaction Table 和 Dirty Page Table 两个组成部分。</li>
<li><strong>重做阶段</strong>（Redo）：该阶段依据分析阶段中产生的待恢复的事务集合来重演历史（Repeat History），具体操作为：找出所有包含 Commit Record 的日志，将这些日志修改的数据写入磁盘，写入完成后在日志中增加一条 End Record，然后移除出待恢复事务集合。</li>
<li><strong>回滚阶段</strong>（Undo）：该阶段处理经过分析、重做阶段后剩余的恢复事务集合，此时剩下的都是需要回滚的事务，它们被称为 Loser，根据 Undo Log 中的信息，将已经提前写入磁盘的信息重新改写回去，以达到回滚这些 Loser 事务的目的。
<table>
<thead>
<tr>
<th>-</th>
<th>FORCE</th>
<th>STEAL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Commit Logging</td>
<td>redo log</td>
<td>x</td>
</tr>
<tr>
<td>Write-Ahead Loggin</td>
<td>redo log</td>
<td>undo log</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h1 id="隔离性">隔离性：</h1>
<p>隔离性是保证，不同事务之间读和写之间不影响。这天生和并发有关，这时需要解决并发的重要手段：锁。
数据库为了隔离性一般会提供三种锁：</p>
<ul>
<li>写锁 -排它锁-exclusiveLock-XLock：如果数据加了写锁，只有持有写锁的事务才能对数据进行写操作，数据加锁时，其他事务不能写入也不能加读锁。</li>
<li>读锁-共享锁-ShareLock-SLock:多个事务可以对同一数据添加读锁，添加以后其他事务不能对其写入数据，但仍然可以对读取。对于持有读锁的事务，如果只有自己持有读锁那么允许升级为写锁，写入数据。</li>
<li>范围锁（RangeLock）：对于某个范围直接加排它锁，这个范围内的数据不能写入，和一组排它锁不一样，在这个范围不可新增和删除数据。
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>存在问题</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>读取未提交</td>
<td>脏读+之后</td>
<td style="text-align:left">会读到其他事务未提交的事务</td>
</tr>
<tr>
<td>读取已提交</td>
<td>不可重复读+之后</td>
<td style="text-align:left">对同一行数据的两次查询得到了不同的结果。</td>
</tr>
<tr>
<td>可重复读</td>
<td>幻读&amp;write skew</td>
<td style="text-align:left">两个完全相同的范围查询得到了不同的结果集。</td>
</tr>
<tr>
<td>串行化</td>
<td></td>
<td style="text-align:left">对读和写入的数据全部加上读锁、写锁、范围锁，可实现串行化，性能比较差，相当于一条一条执行。</td>
</tr>
<tr>
<td></td>
<td></td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>除了都以锁来实现外，以上四种隔离级别还有另一个共同特点，就是幻读、不可重复读、脏读等问题都是由于一个事务在读数据过程中，受另外一个写数据的事务影响而破坏了隔离性，针对这种“一个事务读+另一个事务写”的隔离问题，近年来有一种名为“<a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control">多版本并发控制</a>”（Multi-Version Concurrency Control，MVCC）的无锁优化方案被主流的商业数据库广泛采用。MVCC 是一种读取优化策略，它的“无锁”是特指读取时不需要加锁。MVCC 的基本思路是对数据库的任何修改都不会直接覆盖之前的数据，而是产生一个新版副本与老版本共存，以此达到读取时可以完全不加锁的目的。在这句话中，“版本”是个关键词，你不妨将版本理解为数据库中每一行记录都存在两个看不见的字段：CREATE_VERSION 和 DELETE_VERSION，这两个字段记录的值都是事务 ID，事务 ID 是一个全局严格递增的数值，然后根据以下规则写入数据</p>
<ul>
<li>插入数据时：CREATE_VERSION 记录插入数据的事务 ID，DELETE_VERSION 为空。</li>
<li>删除数据时：DELETE_VERSION 记录删除数据的事务 ID，CREATE_VERSION 为空。</li>
<li>修改数据时：将修改数据视为“删除旧数据，插入新数据”的组合，即先将原有数据复制一份，原有数据的 DELETE_VERSION 记录修改数据的事务 ID，CREATE_VERSION 为空。复制出来的新数据的 CREATE_VERSION 记录修改数据的事务 ID，DELETE_VERSION 为空。</li>
</ul>
<p>此时，如有另外一个事务要读取这些发生了变化的数据，将根据隔离级别来决定到底应该读取哪个版本的数据。</p>
<ul>
<li>隔离级别是<code>可重复读</code>：总是读取 CREATE_VERSION 小于或等于当前事务 ID 的记录，在这个前提下，如果数据仍有多个版本，则取最新（事务 ID 最大）的。</li>
<li>隔离级别是<code>读已提交</code>：总是取最新的版本即可，即最近被 Commit 的那个版本的数据记录。</li>
</ul>
<p>另外两个隔离级别都没有必要用到 MVCC，因为<code>读未提交</code>直接修改原始数据即可，其他事务查看数据的时候立刻可以看到，根本无须版本字段。<code>可串行化</code>本来的语义就是要阻塞其他事务的读取操作，而 MVCC 是做读取时无锁优化的，自然就不会放到一起用。</p>
<p>MVCC 是只针对“读+写”场景的优化，如果是两个事务同时修改数据，即“写+写”的情况，那就没有多少优化的空间了，此时加锁几乎是唯一可行的解决方案，</p>
<p>MySQL：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220918231437.png" alt=""></p>
<p>PostgreSQL：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220918231445.png" alt=""></p>
<h2 id="关于-mysql-repeatable-read-isolation-常见的三个误区">关于 MySQL Repeatable Read Isolation 常见的三个误区</h2>
<p><a href="https://cloud.tencent.com/developer/article/1676633">https://cloud.tencent.com/developer/article/1676633</a></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>杂项</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>java日志</h1>

<h2 id="日志发展史">日志发展史</h2>
<h3 id="上古时代">上古时代</h3>
<p>jdk1.3之前 System.out.println(&quot;&quot;)
问题：
没有日志级别，上线以后会有很多无关的日志，而且只能在控制台看，不方便定位。</p>
<h3 id="发展流程">发展流程</h3>
<p>log4j-&gt;jul-&gt;jcl-&gt;slf4j-&gt;log4j2-&gt;logback</p>
<h3 id="log4j">log4j</h3>
<p>作者ceki</p>
<p>从控制台写到文件
日志信息按天和文件大小划分
划分日志等级，按日志等级记录文件
高等级日志发送邮件
异步io
格式控制</p>
<p>log4j发布以后，活的很好的反响，作者想让sun公司被纳入jdk，sun公司不接受，最后被apatch收纳。</p>
<h3 id="jul">jul</h3>
<p>jdk官方日志库 jul  （java.util.logging）
log4j火了以后，jdk官方自己开发了一个库jul，但是并没有被所有人 认可</p>
<h3 id="jcl">JCL</h3>
<p>日志门面 jakarta（jdk内部的一个开发小组）Commons Logging
jcl不实现日志功能，但是整合整合日志库</p>
<p>依靠类加载器寻找日志库</p>
<h3 id="slf4j">slf4j</h3>
<p>ceki发现JCL不好用，apache也不着急开发日志门面，自己出去单独搞了slf4j</p>
<p>桥接器：slf4j 和日志框架直接 连接的工具
适配器：多个模块使用不同的日志门面和日志框架，可以别的日志框架转换到slf4j上</p>
<h3 id="log4j2">log4j2</h3>
<p>apache 重写log4j，性能升级</p>
<h3 id="logback">logback</h3>
<p>ceki 也知道log4j性能问题，开发了替代log4j的高性能产品</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>log4j漏洞</h1>

<h2 id="这次的史诗级漏洞是怎么回事呢">这次的史诗级漏洞是怎么回事呢？</h2>
<p>主角就是log4j2，黑客已经利用 Log4j 漏洞来接管受害者的计算机，以执行从加密货币挖矿、发送垃圾邮件、到通过大型僵尸网络发起分布式拒绝服务(DDoS)攻击的任何事情。</p>
<p>log4j2的强大之处在于，除了可以输出程序中的变量，它还提供了一个叫<strong>Lookup</strong>的东西，lookup相当于是一个接口，可以用来输出更多内容，lookup，顾名思义就是查找、搜索的意思，那在log4j2中，就是允许在输出日志的时候，通过某种方式去查找要输出的内容。</p>
<p><img src="https://pic2.zhimg.com/80/v2-448ae7b0beb7e42d179de1a373007b4d_1440w.jpg" alt=""></p>
<p>假如某一个Java程序中，将浏览器的类型记录到了日志中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">logger.info(userAgent);
</span></span></code></pre></div><p><code>User-Agent</code>就属于外界输入的信息，而不是自己程序里定义出来的。只要是外界输入的，就有可能存在恶意的内容，假如有人发来了一个HTTP请求，他的<code>User-Agent</code>是这样一个字符串：</p>
<blockquote>
<p>${jndi:ldap://127.0.0.1/exploit}</p>
</blockquote>
<p>接下来，log4j2将会对这行要输出的字符串进行解析，它发现了字符串中有 <strong>${</strong>，要单独处理，发现是JNDI扩展内容_（<strong>什么是JNDI？<strong>简单粗暴的理解下，它的作用类似于JDBC，JDBC（Java Data Base Connectivity,java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系数据库提供统一访问，JDBC为工具/数据库开发人员提供了一个</strong>标准的API</strong>，据此可以构建更高级的工具和接口，使数据库开发人员能够用纯 Java API 编写数据库应用程序。<strong>JNDI(Java Naming and Directory Interface)是一个应用程序设计的API</strong>，为开发人员提供了<strong>查找和访问各种命名和目录服务的通用、统一的接口</strong>，类似JDBC都是构建在抽象层上。）如图：_</p>
<p><img src="https://pic2.zhimg.com/80/v2-80ab1f91efc86ced9988b278d86ede71_1440w.jpg" alt=""></p>
<p>再对JNDI进一步解析，发现了是LDAP协议_（LDAP即Lightweight Directory Access Protocol（轻量级目录访问协议），目录是一个为查询、浏览和搜索而优化的专业分布式数据库，这个东西用在统一身份认证领域比较多，**简单理解就是：**一个类似于字典的数据源，你可以通过LDAP协议，传一个name进去，就能获取到数据。）_LDAP服务器在127.0.0.1，要查找的key是exploit，然后调用具体负责LDAP的模块去请求对应的数据。<strong>问题来了！<strong>JNDI支持一个叫命名引用的方式，也就是</strong>JNDI可以远程下载class文件来构建对象！！！<strong>下载后加载起来构建对象，咱就是一整个震惊住的那么一个大动作啊，如果远程下载的URL指向的是一个黑客的服务器，并且下载的class文件里面藏有恶意代码，那歇逼了，什么样的后果都可能出现，这是</strong>JNDI注入。</strong></p>
<h2 id="这次核弹漏洞造成的影响"><strong>这次“核弹”漏洞造成的影响</strong></h2>
<p>log4j2的使用面很广泛，现在Java技术栈在Web、后端开发、大数据等领域应用非常广泛，国内除了阿里巴巴、京东、美团等一大片以Java为主要技术栈的公司外，还有多如牛毛的中小企业选择Java。除此之外还有像kafka、elasticsearch、flink这样的大量中间件都是用Java语言开发的。它们大量使用了log4j2作为日志输出。如果输出的日志有外部输入混进来，那直接就是远程代码执行RCE，灭顶之灾！好吧这些是大佬们的遭遇和分析，至少目前为止对很多人，至少我这种菜鸟没有产生什么大的影响&hellip;</p>
<h2 id="有关解决和修复">有关解决和修复</h2>
<p>方式一：禁用lookup或JNDI服务</p>
<p>罪魁祸首就是lookup和JNDI，那么直接修改配置文件log4j2.formatMsgNoLookups=True或禁用JNDI服务，不过一般产生问题的服务都是线上已经在跑的服务，禁用的时候要注意评估一下是否允许。</p>
<p>方式二：升级新版本</p>
<p>新版的log4j2已经修复了这个问题，升级即可解决。修复后的log4j2在JNDI lookup中增加了很多的限制：</p>
<blockquote>
<p>1.默认不再支持二次跳转（也就是命名引用）的方式获取对象<br>
2.只有在log4j2.allowedLdapClasses列表中指定的class才能获取。<br>
3.只有远程地址是本地地址或者在log4j2.allowedLdapHosts列表中指定的地址才能获取</p>
</blockquote>
<p>这样处理等于是去掉了通过打印日志去远程加载class的方式。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>slf4j</h1>

<h3 id="几篇还不错的文章">几篇还不错的文章：</h3>
<p><a href="https://www.cnblogs.com/suger43894/p/9543685.html">SLF4J和Logback和Log4j和Logging的区别与联系</a></p>
<p><a href="https://juejin.cn/post/6844903833257115655">java日志体系</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>URL和URI</h1>

<h1 id="简介">简介</h1>
<p>统一资源标志符URI就是在某一规则下能把一个资源独一无二地标识出来。 拿人做例子，假设这个世界上所有人的名字都不能重复，那么名字就是URI的一个实例，通过名字这个字符串就可以标识出唯一的一个人。 现实当中名字当然是会重复的，所以身份证号才是URI，通过身份证号能让我们能且仅能确定一个人。 那统一资源定位符URL是什么呢。也拿人做例子然后跟HTTP的URL做类比，就可以有：</p>
<p>动物住址协议://地球/中国/浙江省/杭州市/西湖区/某大学/14号宿舍楼/525号寝/张三.人</p>
<p>可以看到，这个字符串同样标识出了唯一的一个人，起到了URI的作用，所以URL是URI的子集。URL是以描述人的位置来唯一确定一个人的。 在上文我们用身份证号也可以唯一确定一个人。对于这个在杭州的张三，我们也可以用：</p>
<p>身份证号：<a href="tel:123456789">123456789</a></p>
<p>来标识他。 所以不论是用定位的方式还是用编号的方式，我们都可以唯一确定一个人，都是URl的一种实现，而URL就是用定位的方式实现的URI。</p>
<h1 id="url">URL</h1>
<p>URL：（全称：Uniform Resource Locator） 统一资源定位符。</p>
<p>它是对可以从互联网上得到的资源的位置和访问方法的一种简洁的表示，是互联网上标准资源的地址</p>
<p>URL 的常见定义格式为</p>
<p>scheme://host[:port#]/path/…/[;url-params][?query-string][#anchor]</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">scheme</span> <span class="c1">//有我们很熟悉的http、https、ftp以及著名的ed2k，迅雷的thunder等。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">host</span>   <span class="c1">//HTTP服务器的IP地址或者域名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">port</span><span class="err">#</span>  <span class="c1">//HTTP服务器的默认端口是80，这种情况下端口号可以省略。如果使用了别的端口，必须指明，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">例如tomcat的默认端口是8080</span>  <span class="n">http</span><span class="o">:</span><span class="c1">//localhost:8080/
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">path</span>   <span class="c1">//访问资源的路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">url</span><span class="o">-</span><span class="n">params</span>  <span class="c1">//所带参数 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">query</span><span class="o">-</span><span class="n">string</span>    <span class="c1">//发送给http服务器的数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">anchor</span> <span class="c1">//锚点定位
</span></span></span></code></pre></div><p>URL的格式一般由下列三部分组成:</p>
<ol>
<li>协议(或称为服务方式);</li>
<li>存有该资源所在的服务器的名称或IP地址(包括端口号);</li>
<li>主机资源的具体地址。</li>
</ol>
<h2 id="一个简单的url">一个简单的url</h2>
<h3 id="1--协议">1 — 协议</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">常见的协议</span>
</span></span><span class="line"><span class="cl"><span class="n">http</span>     <span class="n">超文本传输协议资源</span>
</span></span><span class="line"><span class="cl"><span class="n">https</span>    <span class="n">用安全套接字层传送的超文本传输协议</span>
</span></span><span class="line"><span class="cl"><span class="n">ftp</span>      <span class="n">文件传输协议</span>
</span></span><span class="line"><span class="cl"><span class="n">mailto</span>   <span class="n">电子邮件地址</span>
</span></span></code></pre></div><h3 id="2-服务器名称或ip">2 —服务器名称或IP</h3>
<p>端口:相当于一种数据的传输通道。用于接受某些数据，然后传输给相应的服务，而电脑将这些数据处理后，再将相应的回复通过开启的端口传给对方。</p>
<p>端口的作用：因为 IP 地址与网络服务的关系是一对多的关系。所以实际上因特网上是通过 IP 地址加上端口号来区分不同的服务的。</p>
<p>端口是通过端口号来标记的，端口号只有整数，范围是从0 到65535。</p>
<h3 id="3--主机资源具体地址">3 — 主机资源具体地址</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">例如</span><span class="err">：</span>  <span class="o">/</span><span class="n">webProject</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="na">html</span> 
</span></span></code></pre></div><p>一般的URL为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nl">URL:</span>  <span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:8080/webProject/index.html 
</span></span></span></code></pre></div><h1 id="uri">URI</h1>
<p>URI：（全称：Uniform Resource Identifier） 统一资源标识符，它是一个字符串<strong>用来标示抽象或物理资源</strong></p>
<p>Web上可用的每种资源（ HTML文档、图像、音频、视频片段、程序等）都由一个通用资源标识符（Uniform Resource Identifier, 简称”URI”）进行定位。</p>
<p>URI的格式也由三部分组成:</p>
<ol>
<li>访问资源的命名机制。</li>
<li>存放资源的主机名。</li>
<li>资源自身的名称，由路径表示。</li>
</ol>
<h1 id="联系与区别">联系与区别</h1>
<p>URI ：Uniform Resource Identifier，统一资源标识符； URL：Uniform Resource Locator，统一资源定位符； URN：Uniform Resource Name，统一资源名称。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221221161748.png" alt="image.png"></p>
<p>URI 属于 URL 更高层次的抽象，一种字符串文本标准。</p>
<p>就是说，URI 属于父类，而 URL 属于 URI 的子类。URL 是 URI 的一个子集</p>
<p>URI 表示请求服务器的路径，定义这么一个资源。而 URL 同时说明要如何访问这个资源（<a href="http:">http://）。</a>./)</p>
<p>URI可以分为URL,URN，或同时具备locators 和names特性的一个东西。URN作用就好像一个人的名字，URL就像一个人的地址。换句话说：URN确定了东西的身份，URL提供了找到它的方式。”</p>
<h1 id="总结">总结</h1>
<p>URL是一种具体的URI，它不仅唯一标识资源，而且还提供了定位该资源的信息。</p>
<p>URI是一种语义上的抽象概念，可以是绝对的，也可以是相对的，而URL则必须提供足够的信息来定位。</p>
<p>URI：统一资源标识 URL：统一资源定位 URN：统一资源名称</p>
<p>例如： <a href="http://www.baidu.com/">www.baidu.com</a>是URL. <a href="http://www.baidu.com/index.html">www.baidu.com/index.html</a> 是URL 同时也是URI。 所以，URL 就是 URI 的 定位。</p>
<p>但 URI 不一定是 URL。 因为 URI有一类子集是 URN，它是命名资源 但不指定如何定位资源。 如： mailto 需要 加上 相应的结构参数，才能进行 统一资源定位。 如： mailto: <a href="mailto:xxxxx@qq.com">xxxxx@qq.com</a></p>
<p>因此，三者之间的关系是： URI 一定是 URL URN + URL 就是 URI。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>XSS跨站脚本攻击</h1>

<p>因为我们完全信任了用户输入，但有些别有用心的用户会像这样的输入</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221116193207.png" alt=""></p>
<p>这样无论是谁访问这个页面的时候控制台都会输出“Hey you are a fool fish!”，如果这只是个恶意的小玩笑，有些人做的事情就不可爱了，有些用户会利用这个漏洞窃取用户信息、诱骗人打开恶意网站或者下载恶意程序等，看个最简单的例子</p>
<p>作者：乔治大叔<br>
链接：https://www.jianshu.com/p/033cb2fa5098<br>
来源：简书<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>yaml</h1>

<h2 id="yaml-是什么">YAML 是什么？</h2>
<p><strong>YAML</strong> 是一种可读性高，以数据为中心的数据序列化格式。可以表达 <strong>对象（键值对）</strong>，<strong>数组</strong>，<strong>标量</strong> 这几种数据形式 能够被多种编程语言和脚本语言解析。</p>
<blockquote>
<p>什么是<strong>序列化</strong>？<br>
<strong>序列化</strong>指的是将<strong>自定义</strong>的对象或者其他数据进行<strong>持久化</strong>，从而<strong>方便</strong>进行<strong>传输和存储</strong>。一般情况下，能够序列化的数据一定能够通过反序列化恢复。</p>
</blockquote>
<h2 id="yaml-语法与格式">YAML 语法与格式</h2>
<h3 id="基本语法">基本语法</h3>
<ul>
<li>以 <code>k: v</code> 的形式来表示键值对的关系，<strong>冒号后面必须有一个空格</strong></li>
<li><code>#</code> 表示注释</li>
<li>对大小写敏感</li>
<li>通过缩进来表示层级关系，<strong>缩排中空格的数目不重要，只要相同阶层的元素左侧对齐就可以了</strong></li>
<li>缩进只能使用空格，不能使用 <code>tab</code> 缩进键</li>
<li><strong>字符串可以不用双引号</strong></li>
</ul>
<h3 id="格式">格式</h3>
<p><strong>对象和键值对</strong></p>
<p>通过 <code>k: v</code> 的方式表示对象或者键值对，冒号后必须要加一个空格：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">Astron</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Sex</span><span class="p">:</span><span class="w"> </span><span class="l">female</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">School</span><span class="p">:</span><span class="w"> </span><span class="l">TJU</span><span class="w">
</span></span></span></code></pre></div><p>通过缩进来表示对象的多个属性：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">People</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">Astron</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">Sex</span><span class="p">:</span><span class="w"> </span><span class="l">female</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">School</span><span class="p">:</span><span class="w"> </span><span class="l">TJU</span><span class="w">
</span></span></span></code></pre></div><p>也可以写成</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">people</span><span class="p">:</span><span class="w"> </span>{<span class="nt">name: Astron, sex</span><span class="p">:</span><span class="w"> </span><span class="l">female}</span><span class="w">
</span></span></span></code></pre></div><p><strong>数组</strong></p>
<p>数组（或者列表）中的<strong>元素采用 <code>-</code> 表示</strong>，以 <code>-</code> 开头的行表示构成一个数组</p>
<p>eg1：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="l">A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">C</span><span class="w">
</span></span></span></code></pre></div><p>eg2:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">people</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">yyy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">zzz</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">www</span><span class="w">
</span></span></span></code></pre></div><p>行内表示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">people</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">yyy, zzz, www]</span><span class="w">
</span></span></span></code></pre></div><p>eg3: 对象数组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">people</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">yyy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">age</span><span class="p">:</span><span class="w"> </span><span class="m">18</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">zzz</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">age</span><span class="p">:</span><span class="w"> </span><span class="m">19</span><span class="w">
</span></span></span></code></pre></div><p>使用流式表示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">people</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>{<span class="nt">name: yyy, age</span><span class="p">:</span><span class="w"> </span><span class="m">18</span>}<span class="p">,</span>{<span class="nt">name: zzz, age</span><span class="p">:</span><span class="w"> </span><span class="m">19</span>}<span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p><strong>标量</strong></p>
<p>标量是最基本的不可再分的值，包括：</p>
<ul>
<li>整数</li>
<li>浮点数</li>
<li>字符串</li>
<li>布尔值</li>
<li>Null</li>
<li>时间</li>
<li>日期</li>
</ul>
<p>eg:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">boolean</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="kc">true</span><span class="w"> </span><span class="c"># 大小写都可以</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">float</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="m">3.14</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="m">3.25e+5</span><span class="w"> </span><span class="c"># 科学计数法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">int</span><span class="p">:</span><span class="w"> </span><span class="m">12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">null</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">nodeName</span><span class="p">:</span><span class="w"> </span><span class="l">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">string</span><span class="p">:</span><span class="w"> </span><span class="m">123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="ld">2020-01-01</span><span class="w"> </span><span class="c"># 格式为 yyyy-MM-dd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">datetime</span><span class="p">:</span><span class="w"> </span><span class="ld">2020-01-10T15:02:08</span><span class="m">+08</span><span class="p">:</span><span class="m">00</span><span class="w"> </span><span class="c"># 日期和时间使用T连接，+表示时区</span><span class="w">
</span></span></span></code></pre></div><p><strong>引用</strong></p>
<p><code>&amp;</code> 用于建立锚点，<code>*</code> 用于引用锚点，<code>&lt;&lt;</code> 表示合并到当前数据</p>
<p>eg1:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">defaults</span><span class="p">:</span><span class="w"> </span><span class="cp">&amp;defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">adapter</span><span class="p">:</span><span class="w"> </span><span class="l">ppp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">qqq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">development</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">database</span><span class="p">:</span><span class="w"> </span><span class="l">mq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="cp">*defaults</span><span class="w">
</span></span></span></code></pre></div><p>相当于：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">defaults</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">adapter</span><span class="p">:</span><span class="w"> </span><span class="l">ppp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">qqq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">development</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">database</span><span class="p">:</span><span class="w"> </span><span class="l">mq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">adapter</span><span class="p">:</span><span class="w"> </span><span class="l">ppp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">qqq</span><span class="w">
</span></span></span></code></pre></div><p>eg2:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="cp">&amp;showell</span><span class="w"> </span><span class="l">steve</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">clark</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">eve</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="cp">*showell</span><span class="w">
</span></span></span></code></pre></div><p>相当于:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="l">steve</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">clark</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">eve</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="l">steve</span><span class="w">
</span></span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>大概念</h1>

<h1 id="机械同感">机械同感</h1>
<p>(mechanical sympathy)来自于赛车比赛，它反映了车手对赛车有一种内在的感觉，所以他们能够赛车达到最佳状态。然而多数程序员缺少这种对编程与硬件交互的感同身受的情感。要么是没有，要么就是以为自己有，实际上却是基于很久以前硬件工作方式而建立的概念。这说得实在是太多，作为一个程序员，在写程序时是否考虑过自己的代码能否正确地运行在底层硬件上，又是否考虑过怎样榨干硬件性能让自己的代码跑得飞快，又是否考虑过自己的代码能否被人钻了空子发生安全问题。我想这三方面也许是学习硬件工作原理的最主要因素，即让自己的代码：正确、高效、安全地在硬件上跑。简单来说就是</p>
<p>快准稳！</p>
<h1 id="5why分析法-----分析事故根本原因">5Why分析法 &mdash; 分析事故根本原因</h1>
<p><strong>角度一 “制造”，为什么会发生？</strong></p>
<ul>
<li>问题 1：为什么数据库的线程数会增加？
答：正在执行的SQL执行时间长。</li>
<li>问题 2：为什么正在执行的SQL执行时间长？
答：因为正在执行的SQL发生了死锁。</li>
<li>问题 3：为什么SQL会发生死锁？
答：同时删除相同的一批数据，而删除时出现乱序。</li>
<li>问题 4：为什么删除相同的一批数据？
答：代码逻辑问题，不需要重复删除。</li>
</ul>
<p>解决方案：更改代码逻辑，避免重复删除。</p>
<p><strong>角度二 “检验”，为什么没有发现？</strong></p>
<ul>
<li>问题 1：为什么代码上线几个月都没有发现？
答：未出现大量的死锁情况。</li>
<li>问题 2：为什么没有出现大量的死锁情况？
答：未出现这种造成大量并发的数据，测试用例也未覆盖。</li>
<li>问题 3：在小量并发数据的情况也可能发生死锁，为什么没有发现该逻辑会产生死锁？
答：未能及时从错误日志中发现问题。</li>
<li>问题 4：为什么未能及时从错误日志中发现问题？
答：错误日志中有较多无用的日志，扰乱了<a href="https://cloud.tencent.com/product/es?from=10680">日志分析</a>。</li>
</ul>
<p>解决方案：清理代码中无用的错误日志打印，及时检查错误日志，并解决问题。</p>
<h1 id="代码是用来给人看的顺便给机器执行">代码是用来给人看的，顺便给机器执行</h1>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>奇怪的小知识</h1>

<h2 id="0day漏洞">0day漏洞：</h2>
<p>漏洞已被发现还没有发布解决补丁。</p>
<h2 id="桥接">桥接：</h2>
<p>简单的说就是通过<a href="https://baike.baidu.com/item/%E7%BD%91%E6%A1%A5">网桥</a>可以把两个不同的物理<a href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">局域网</a>连接起来，是一种在<a href="https://baike.baidu.com/item/%E9%93%BE%E8%B7%AF%E5%B1%82">链路层</a>实现局域网互连的<a href="https://baike.baidu.com/item/%E5%AD%98%E5%82%A8%E8%BD%AC%E5%8F%91">存储转发</a>设备。<a href="https://baike.baidu.com/item/%E7%BD%91%E6%A1%A5">网桥</a>从一个<a href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">局域网</a>接收MAC帧，拆封、校对、校验之后 ，按另一个局域网的格式重新组装,发往它的<a href="https://baike.baidu.com/item/%E7%89%A9%E7%90%86%E5%B1%82">物理层</a>，通俗的说就是通过一台设备（可能不止一个）把几个网络串起来形成的连接，<a href="https://baike.baidu.com/item/%E6%AF%94%E5%A6%82">比如</a>图中就是一种通过桥接来实现无路由双机上网的连接方案。
<img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220128154012.png" alt=""></p>
<h2 id="虚拟机中的网络模式">虚拟机中的网络模式</h2>
<h3 id="vmware-桥接模式">VMware 桥接模式</h3>
<p>VMware桥接模式，也就是将虚拟机的虚拟网络适配器与主机的物理网络适配器进行交接，虚拟机中的虚拟网络适配器可通过主机中的物理网络适配器直接访问到外部网络(例如图中所示的局域网和Internet，下同)。简而言之，这就好像在上图所示的局域网中添加了一台新的、独立的计算机一样。因此，虚拟机也会占用局域网中的一个IP地址，并且可以和其他终端进行相互访问。桥接模式网络连接支持有线和无线主机网络适配器。如果你想把虚拟机当做一台完全独立的计算机看待，并且允许它和其他终端一样的进行网络通信，那么桥接模式通常是虚拟机访问网络的最简单途径。</p>
<h3 id="vmware-nat模式">VMware NAT模式</h3>
<p>NAT，是Network Address Translation的缩写，意即网络地址转换。NAT模式也是VMware创建虚拟机的默认网络连接模式。使用NAT模式网络连接时，VMware会在主机上建立单独的专用网络，用以在主机和虚拟机之间相互通信。虚拟机向外部网络发送的请求数据&quot;包裹&quot;，都会交由NAT网络适配器加上&quot;特殊标记&quot;并以主机的名义转发出去，外部网络返回的响应数据&quot;包裹&quot;，也是先由主机接收，然后交由NAT网络适配器根据&quot;特殊标记&quot;进行识别并转发给对应的虚拟机，因此，虚拟机在外部网络中不必具有自己的IP地址。从外部网络来看，虚拟机和主机在共享一个IP地址，默认情况下，外部网络终端也无法访问到虚拟机。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>好用的网站</h1>

<p>在线流程图
<a href="https://mermaid.live/">https://mermaid.live/</a></p>
<p>正则可视化
<a href="https://tooltt.com/regulex/">https://tooltt.com/regulex/</a></p>
<p>python官方学习文档
docs.python.org</p>
<p>朗文词典
<a href="https://www.ldoceonline.com/">https://www.ldoceonline.com/</a></p>
<p>壁纸网站
<a href="https://wallhaven.cc/">https://wallhaven.cc/</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>微信授权登录</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/%E5%BE%AE%E4%BF%A1%E9%9D%99%E9%BB%98%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95.jpg" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>高效开发</h1>


            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>硬件</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>DMA</h1>

<p><strong>直接内存访问</strong>（<strong>D</strong>irect <strong>M</strong>emory <strong>A</strong>ccess，<strong>DMA</strong>）是<a href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6" title="计算机科学">计算机科学</a>中的一种内存访问技术。它允许某些<a href="https://zh.wikipedia.org/wiki/%E9%9B%BB%E8%85%A6" title="电脑">电脑</a>内部的硬件子系统（电脑外设），可以独立地直接读写系统<a href="https://zh.wikipedia.org/wiki/%E8%A8%98%E6%86%B6%E9%AB%94" title="内存">内存</a>，而不需<a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%A4%AE%E8%99%95%E7%90%86%E5%99%A8" title="中央处理器">中央处理器</a>（CPU）介入处理 。在同等程度的处理器负担下，DMA是一种快速的数据传送方式。很多硬件的系统会使用DMA，包含<a href="https://zh.wikipedia.org/wiki/%E7%A1%AC%E7%A2%9F" title="硬盘">硬盘</a>控制器、<a href="https://zh.wikipedia.org/wiki/%E7%B9%AA%E5%9C%96%E9%A1%AF%E7%A4%BA%E5%8D%A1">绘图显卡</a>、<a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%8D%A1" title="网络卡">网卡</a>和<a href="https://zh.wikipedia.org/wiki/%E5%A3%B0%E5%8D%A1" title="声卡">声卡</a>。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>单工、半双工、全双工</h1>

<p>描述的是数据流、信息流方向</p>
<p>单工：
只支持数据在一个方向上传输，只有一方能接受或者发送。（广播模式）
半双工：
可以双向通讯，但是不能同时传输。（对讲机模式）
全双工（双工）duplex：
可以同时双方都接受和发送消息。（电话模式）</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>南北桥</h1>

<p>曾经，北桥芯片和南桥芯片都是主板芯片组中最重要的组成部分。传统来说，靠上方的叫北桥，靠下方的叫南桥。北桥负责与CPU通信，并且连接高速设备（内存/显卡），并且与南桥通信；南桥负责与低速设备（硬盘/USB）通信，时钟/BIOS/系统管理/旧式设备控制，并且与北桥通信。</p>
<p>“桥”的意思是指通信，桥两边匹配的是不同的速度。</p>
<p>连接关系如下：</p>
<p>CPU——北桥——内存</p>
<p>CPU——北桥——显卡</p>
<p>CPU——北桥——南桥——硬盘</p>
<p>CPU——北桥——南桥——网卡</p>
<p>CPU——北桥——南桥——PS/2键鼠</p>
<p>CPU——北桥——南桥——USB设备</p>
<p>如今北桥被集成到CPU内，io控制模块，南桥成为了PCIE-hub</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>算法&amp;数据结构</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>leetcode经典100题</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>1.两数之和</h1>

<h1 id="题目">题目</h1>
<p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 <strong>和为目标值</strong> <em><code>target</code></em>  的那 <strong>两个</strong> 整数，并返回它们的数组下标。</p>
<p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素在答案里不能重复出现。</p>
<p>你可以按任意顺序返回答案。</p>
<p><strong>示例 1：</strong></p>
<pre tabindex="0"><code>输入：nums = [2,7,11,15], target = 9
输出：[0,1]
解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。
</code></pre><p><strong>示例 2：</strong></p>
<pre tabindex="0"><code>输入：nums = [3,2,4], target = 6
输出：[1,2]
</code></pre><p><strong>示例 3：</strong></p>
<pre tabindex="0"><code>输入：nums = [3,3], target = 6
输出：[0,1]
</code></pre><p><strong>提示：</strong></p>
<ul>
<li><code>2 &lt;= nums.length &lt;= 104</code></li>
<li><code>-109 &lt;= nums[i] &lt;= 109</code></li>
<li><code>-109 &lt;= target &lt;= 109</code></li>
<li><strong>只会存在一个有效答案</strong></li>
</ul>
<h1 id="题解">题解</h1>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>136.只出现一次的数字</h1>

<p>#bit-manipulation</p>
<h1 id="题目">题目</h1>
<p>给定一个<strong>非空</strong>整数数组，除了某个元素只出现一次以外，其余每个元素均出现两次。找出那个只出现了一次的元素。</p>
<p><strong>说明：</strong></p>
<p>你的算法应该具有线性时间复杂度。 你可以不使用额外空间来实现吗？</p>
<p><strong>示例 1:</strong></p>
<pre tabindex="0"><code>输入: [2,2,1]
输出: 1
</code></pre><p><strong>示例 2:</strong></p>
<pre tabindex="0"><code>输入: [4,1,2,1,2]
输出: 4
</code></pre><h1 id="题解">题解</h1>
<p>这道题有很多解法，暴力双循环、hashmap、但是要实现时间O(n) 空间O(1)，还得是位运算，这里用的是异或。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221025192223.png" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">singleNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>    
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">=</span><span class="n">num</span><span class="o">^</span><span class="n">result</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>20.有效的括号</h1>

<h1 id="题目">题目</h1>
<p>给定一个只包括 <code>'('</code>，<code>')'</code>，<code>'{'</code>，<code>'}'</code>，<code>'['</code>，<code>']'</code> 的字符串 <code>s</code> ，判断字符串是否有效。</p>
<p>有效字符串需满足：</p>
<ol>
<li>左括号必须用相同类型的右括号闭合。</li>
<li>左括号必须以正确的顺序闭合。</li>
<li>每个右括号都有一个对应的相同类型的左括号。</li>
</ol>
<p><strong>示例 1：</strong></p>
<pre tabindex="0"><code>输入：s = &#34;()&#34;
输出：true
</code></pre><p><strong>示例 2：</strong></p>
<pre tabindex="0"><code>输入：s = &#34;()[]{}&#34;
输出：true
</code></pre><p><strong>示例 3：</strong></p>
<pre tabindex="0"><code>输入：s = &#34;(]&#34;
输出：false
</code></pre><p><strong>提示：</strong></p>
<ul>
<li><code>1 &lt;= s.length &lt;= 104</code></li>
<li><code>s</code> 仅由括号 <code>'()[]{}'</code> 组成</li>
</ul>
<h1 id="题解">题解</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">isValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1"># 首先括号以键值对的形式存在，想到用dict存储，简化判断</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;{&#34;</span><span class="p">:</span> <span class="s2">&#34;}&#34;</span><span class="p">,</span> <span class="s2">&#34;[&#34;</span><span class="p">:</span> <span class="s2">&#34;]&#34;</span><span class="p">,</span> <span class="s2">&#34;(&#34;</span><span class="p">:</span> <span class="s2">&#34;)&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1"># 这里用一个栈的思想，保存成对括号bracket的入和出</span>
</span></span><span class="line"><span class="cl">		<span class="c1"># 这里数组里放一个字符</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;?&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>21.合并两个有序链表</h1>

<p>将两个升序链表合并为一个新的 <strong>升序</strong> 链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 </p>
<p><strong>示例 1：</strong>
<img src="https://assets.leetcode.com/uploads/2020/10/03/merge_ex1.jpg" alt=""></p>
<p><strong>输入：</strong> l1 = [1,2,4], l2 = [1,3,4]
<strong>输出：</strong> [1,1,2,3,4,4]</p>
<p><strong>示例 2：</strong></p>
<p><strong>输入：</strong> l1 = [], l2 = []
<strong>输出：</strong>[]</p>
<p><strong>示例 3：</strong></p>
<p>**输入：**l1 = [], l2 = [0]
<strong>输出：</strong>[0]</p>
<p><strong>提示：</strong></p>
<ul>
<li>两个链表的节点数目范围是 <code>[0, 50]</code></li>
<li><code>-100 &lt;= Node.val &lt;= 100</code></li>
<li><code>l1</code> 和 <code>l2</code> 均按 <strong>非递减顺序</strong> 排列</li>
</ul>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/%E6%88%AA%E5%B1%8F2022-10-23%2020.12.40.png" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">mergeTwoLists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListNode</span><span class="p">],</span> <span class="n">list2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListNode</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListNode</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre_header</span><span class="o">=</span><span class="n">ListNode</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span> <span class="o">=</span> <span class="n">pre_header</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">list1</span> <span class="ow">and</span> <span class="n">list2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">list1</span><span class="o">.</span><span class="n">val</span> <span class="o">&lt;=</span> <span class="n">list2</span><span class="o">.</span><span class="n">val</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">pre</span><span class="o">.</span><span class="n">next</span><span class="o">=</span><span class="n">list1</span>
</span></span><span class="line"><span class="cl">                <span class="n">list1</span><span class="o">=</span><span class="n">list1</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">pre</span><span class="o">.</span><span class="n">next</span><span class="o">=</span><span class="n">list2</span>
</span></span><span class="line"><span class="cl">                <span class="n">list2</span><span class="o">=</span><span class="n">list2</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">            <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">list1</span> <span class="k">if</span> <span class="n">list1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">list2</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">pre_header</span><span class="o">.</span><span class="n">next</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>22.括号生成</h1>

<p>#backtrack
[[回溯（DFS）]]</p>
<h1 id="题目">题目</h1>
<p>数字 n 代表生成括号的对数，请你设计一个函数，用于能够生成所有可能的并且 有效的 括号组合。</p>
<p>示例 1：</p>
<p>输入：n = 3
输出：[&quot;((()))&quot;,&quot;(()())&quot;,&quot;(())()&quot;,&quot;()(())&quot;,&quot;()()()&quot;]
示例 2：</p>
<p>输入：n = 1
输出：[&quot;()&quot;]</p>
<p>提示：</p>
<p>1 &lt;= n &lt;= 8</p>
<h1 id="题解">题解</h1>
<h2 id="回溯法">回溯法</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">generateParenthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">backtrack</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 退出条件</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># 条件选择</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">left</span><span class="o">&lt;</span><span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;(&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">backtrack</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">left</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#恢复</span>
</span></span><span class="line"><span class="cl">                <span class="n">path</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">right</span><span class="o">&lt;</span><span class="n">left</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">backtrack</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">path</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">backtrack</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">        
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>26.删除有序数组中的重复项</h1>

<p>#双指针</p>
<h1 id="题目">题目：</h1>
<p>给你一个 升序排列 的数组 nums ，请你 原地 删除重复出现的元素，使每个元素 只出现一次 ，返回删除后数组的新长度。元素的 相对顺序 应该保持 一致 。</p>
<p>由于在某些语言中不能改变数组的长度，所以必须将结果放在数组nums的第一部分。更规范地说，如果在删除重复项之后有 k 个元素，那么 nums 的前 k 个元素应该保存最终结果。</p>
<p>将最终结果插入 nums 的前 k 个位置后返回 k 。</p>
<p>不要使用额外的空间，你必须在 原地 修改输入数组 并在使用 O(1) 额外空间的条件下完成。</p>
<p><strong>示例 2：</strong></p>
<pre tabindex="0"><code>输入：nums = [0,0,1,1,1,2,2,3,3,4]
输出：5, nums = [0,1,2,3,4]
解释：函数应该返回新的长度 5 ， 并且原数组 nums 的前五个元素被修改为 0, 1, 2, 3, 4 。不需要考虑数组中超出新长度后面的元素。
</code></pre><h1 id="题解">题解：</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @lc app=leetcode.cn id=26 lang=python3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [26] 删除有序数组中的重复项</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># @lc code=start</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">removeDuplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 快慢指针</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">ol</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">==</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">nums</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">temp</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">l</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>300. 最长递增子序列</h1>

<p>#动态规划</p>
<h1 id="题目">题目</h1>
<p>给你一个整数数组 nums ，找到其中最长严格递增子序列的长度。</p>
<p>子序列 是由数组派生而来的序列，删除（或不删除）数组中的元素而不改变其余元素的顺序。例如，[3,6,2,7] 是数组 [0,3,1,6,2,2,7] 的子序列。</p>
<p>示例 1：</p>
<p>输入：nums = [10,9,2,5,3,7,101,18]
输出：4
解释：最长递增子序列是 [2,3,7,101]，因此长度为 4 。
示例 2：</p>
<p>输入：nums = [0,1,0,3,2,3]
输出：4
示例 3：</p>
<p>输入：nums = [7,7,7,7,7,7,7]
输出：1</p>
<p>提示：</p>
<p>1 &lt;= nums.length &lt;= 2500
-104 &lt;= nums[i] &lt;= 104</p>
<h1 id="题解">题解</h1>
<h2 id="自己的第一反应是错误的">自己的第一反应是错误的</h2>
<p>我第一反应最长的增长应该是连续的ex:[3,1,2,5]。
实际上可能中间会穿插ex:[1,5,2,3]。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	    <span class="nb">max</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">setMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">=</span><span class="nb">max</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">lengthOfLIS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">max_value</span><span class="o">=-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">max_length</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="n">max_value</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">max_value</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="n">max_length</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">setMax</span><span class="p">(</span><span class="n">max_length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span>
</span></span></code></pre></div><p>所以暴力循环的时间复杂度可能是n^3，这太恐怖了</p>
<h2 id="动态规划">动态规划</h2>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>70.爬楼梯</h1>

<p>#动态规划</p>
<h1 id="题目">题目</h1>
<p>假设你正在爬楼梯。需要 <code>n</code> 阶你才能到达楼顶。</p>
<p>每次你可以爬 <code>1</code> 或 <code>2</code> 个台阶。你有多少种不同的方法可以爬到楼顶呢？</p>
<p><strong>示例 1：</strong></p>
<pre tabindex="0"><code>输入：n = 2
输出：2
解释：有两种方法可以爬到楼顶。
1. 1 阶 + 1 阶
2. 2 阶
</code></pre><p><strong>示例 2：</strong></p>
<pre tabindex="0"><code>输入：n = 3
输出：3
解释：有三种方法可以爬到楼顶。
1. 1 阶 + 1 阶 + 1 阶
2. 1 阶 + 2 阶
3. 2 阶 + 1 阶
</code></pre><p><strong>提示：</strong></p>
<ul>
<li><code>1 &lt;= n &lt;= 45</code></li>
</ul>
<h1 id="题解">题解</h1>
<p>f(n)=f(n-1)+f(n-2)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">climbStairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="c1"># 这道题使用递归会超过最大调用深度，所以比dp数组的形式解决</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 数组下标</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>经典算法目录</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221121131751.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>LRU</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006134854.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>动态规划</h1>

<p>动态规划问题的一般形式就是求最值。动态规划其实是运筹学的一种最优化方法，只不过在计算机问题上应用比较多，比如说让你求最长递增子序列呀，最小编辑距离呀等等。</p>
<p>既然是要求最值，核心问题是什么呢？求解动态规划的核心问题是穷举。因为要求最值，肯定要把所有可行的答案穷举出来，然后在其中找最值呗。</p>
<p>动态规划这么简单，就是穷举就完事了？我看到的动态规划问题都很难啊！</p>
<p>首先，动态规划的穷举有点特别，因为这类问题存在「重叠子问题」，如果暴力穷举的话效率会极其低下，所以需要「备忘录」或者「DP table」来优化穷举过程，避免不必要的计算。</p>
<p>而且，动态规划问题一定会具备「最优子结构」，才能通过子问题的最值得到原问题的最值。</p>
<p>另外，虽然动态规划的核心思想就是穷举求最值，但是问题可以千变万化，穷举所有可行解其实并不是一件容易的事，只有列出正确的「状态转移方程」，才能正确地穷举。</p>
<p>以上提到的重叠子问题、最优子结构、状态转移方程就是动态规划三要素。具体什么意思等会会举例详解，但是在实际的算法问题中，写出状态转移方程是最困难的，这也就是为什么很多朋友觉得动态规划问题困难的原因，我来提供我研究出来的一个思维框架，辅助你思考状态转移方程：</p>
<p>明确 base case -&gt; 明确「状态」-&gt; 明确「选择」 -&gt; 定义 dp 数组/函数的含义。</p>
<p>按上面的套路走，最后的结果就可以套这个框架：</p>
<h1 id="初始化-base-case">初始化 base case</h1>
<p>dp[0][0][&hellip;] = base</p>
<h1 id="进行状态转移">进行状态转移</h1>
<p>for 状态1 in 状态1的所有取值：</p>
<p>for 状态2 in 状态2的所有取值：</p>
<p>for &hellip;</p>
<p>dp[状态1][状态2][&hellip;] = 求最值(选择1，选择2&hellip;)</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>双向链表</h1>

<hr>
<h2 id="draft-false">title: &ldquo;链表反转&rdquo;
date: 2021-08-08T21:42:40+08:00
draft: false</h2>
<h1 id="链表反转">链表反转</h1>
<p>链表</p>
<p>1-&gt;2-&gt;3-&gt;4</p>
<p>翻转</p>
<p>4-&gt;3-&gt;2-&gt;1</p>
<p>主要难点是防止Next被替换，下一个节点无法访问</p>
<h2 id="方式1">方式1：</h2>
<p>使用临时变量保存Last和Next</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/%E6%88%AA%E5%B1%8F2022-07-02%2009.08.42.png" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="cm">/** * Definition for singly-linked list. * type ListNode struct { * Val int * Next *ListNode * } */</span> 
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">reverseList</span><span class="p">(</span><span class="nx">head</span> <span class="o">*</span><span class="nx">ListNode</span><span class="p">)</span> <span class="o">*</span><span class="nx">ListNode</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastNode</span><span class="p">,</span><span class="nx">nextNode</span> <span class="o">*</span><span class="nx">ListNode</span> 
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="nx">head</span><span class="o">!=</span><span class="kc">nil</span><span class="p">){</span> 
</span></span><span class="line"><span class="cl">		<span class="nx">nextNode</span><span class="p">=</span><span class="nx">head</span><span class="p">.</span><span class="nx">Next</span> 
</span></span><span class="line"><span class="cl">		<span class="nx">head</span><span class="p">.</span><span class="nx">Next</span><span class="p">=</span><span class="nx">lastNode</span> 
</span></span><span class="line"><span class="cl">		<span class="nx">lastNode</span><span class="p">=</span><span class="nx">head</span> 
</span></span><span class="line"><span class="cl">		<span class="nx">head</span><span class="p">=</span><span class="nx">nextNode</span> 
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="c1">//注意这里是返回前一个节点，因为head最后指向了nextNode是空的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">return</span> <span class="nx">lastNode</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="方式2递归">方式2：递归</h2>
<p>从最末尾开始递归交换 3-4-&gt;4-3，1，2，(4，3)-&gt;1,(4,3),2</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>双指针</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135109.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>回溯（DFS）</h1>

<p>回溯法是求解某些问题的全部或部分解的通用算法，特别是带有限制条件的问题。它通过不断的产生问题的完整解的片段并不断增长完整解的片段来获取该问题的完整解。当发现某个完整解的片段不能生成最后的完整解时，就会丢弃所有以该片段解为基础的完整解。</p>
<pre><code> 回溯法会首先列出完整解的片段的一个集合。这个集合原则上可以通过不同的方式最后给出给定的问题的所有解。这是通过不断地对该完整解的片段的集合中的片段解不断扩展而达到的。
</code></pre>
<p>回溯（backtrack），一般用于求所有可能解，需要遍历所有数据。
解决一个回溯问题，实际上就是一个决策树的遍历过程。你只需要思考 3 个问题：
1、路径：也就是已经做出的选择。
2、选择列表：也就是你当前可以做的选择。
3、结束条件：也就是到达决策树底层，无法再做选择的条件。
result = []
def backtrack(路径, 选择列表):
if 满足结束条件:
result.add(路径)
return</p>
<pre><code>for 选择 in 选择列表:
    做选择
    backtrack(路径, 选择列表)
    撤销选择
</code></pre>
<p>简单例子：
98 . 验证二叉搜索树
给你一个二叉树的根节点 root ，判断其是否是一个有效的二叉搜索树。</p>
<p>有效 二叉搜索树定义如下：</p>
<p>节点的左子树只包含 小于 当前节点的数。
节点的右子树只包含 大于 当前节点的数。
所有左子树和右子树自身必须也是二叉搜索树。</p>
<p>示例 1：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221024141631.png" alt=""></p>
<p>输入：root = [2,1,3]
输出：true
示例 2：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221024141755.png" alt=""></p>
<p>输入：root = [5,1,4,null,null,3,6]
输出：false
解释：根节点的值是 5 ，但是右子节点的值是 4 。</p>
<p>/**</p>
<ul>
<li>Definition for a binary tree node.</li>
<li>type TreeNode struct {</li>
<li>
<pre><code>Val int
</code></pre>
</li>
<li>
<pre><code>Left *TreeNode
</code></pre>
</li>
<li>
<pre><code>Right *TreeNode
</code></pre>
</li>
<li>}
*/</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-golang" data-lang="golang"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">isValidBST</span><span class="p">(</span><span class="nx">root</span> <span class="o">*</span><span class="nx">TreeNode</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">dst</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span><span class="nx">math</span><span class="p">.</span><span class="nx">MinInt64</span><span class="p">,</span><span class="nx">math</span><span class="p">.</span><span class="nx">MaxInt64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">dst</span><span class="p">(</span><span class="nx">root</span> <span class="o">*</span><span class="nx">TreeNode</span><span class="p">,</span><span class="nx">floor</span><span class="p">,</span><span class="nx">ceil</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">bool</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="nx">root</span><span class="o">==</span><span class="kc">nil</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Val</span><span class="o">&lt;=</span><span class="nx">floor</span> <span class="o">||</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Val</span><span class="o">&gt;=</span><span class="nx">ceil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nf">dst</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">Left</span><span class="p">,</span><span class="nx">floor</span><span class="p">,</span><span class="nx">root</span><span class="p">.</span><span class="nx">Val</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nf">dst</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">Right</span><span class="p">,</span><span class="nx">root</span><span class="p">.</span><span class="nx">Val</span><span class="p">,</span><span class="nx">ceil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>基本概念</h1>

<p>RAM（random-access machine）随机访问机</p>
<p>假定了一种通用的单处理器处理模型，认为底层执行一条指令时间都是常量。</p>
<p>指令不能太复杂（比如一条排序的指令），可以是场景的 算术指令、数据移动指令、控制指令。</p>
<p>分治法：</p>
<p>将原问题分解橙几个规模较小但类似的子问题，递归求解这些子问题，然后再合并这些子问题的解来建立原来的问题的解。</p>
<p>三步走：分解-&gt;解决-&gt;合并</p>
<p>分治可以降低时间复杂度，把大的问题化小可以使时间从，n^2 降低到nlogn，因为不在需要遍历全体数据求解。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220824155439.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>常见限流算法</h1>

<h2 id="计数器法">计数器法</h2>
<p>计数器法是限流算法里最简单也是最容易实现的一种算法。比如我们规定，对于A接口来说，我们1分钟的访问次数不能超过100个。那么我们可以这么做：在一开始的时候，我们可以设置一个计数器counter，每当一个请求过来的时候，counter就加1，如果counter的值大于100并且该请求与第一个 请求的间隔时间还在1分钟之内，那么说明请求数过多；如果该请求与第一个请求的间隔时间大于1分钟，且counter的值还在限流范围内，那么就重置 counter。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020141309.png" alt=""></p>
<h2 id="滑动时间窗口算法">滑动时间窗口算法</h2>
<p>滑动时间窗口，又称rolling window。为了解决计数器法统计精度太低的问题，引入了滑动窗口算法。下面这张图，很好地解释了滑动窗口算法：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020141326.png" alt=""></p>
<p>在上图中，整个红色的矩形框表示一个时间窗口，在我们的例子中，一个时间窗口就是一分钟。然后我们将时间窗口进行划分，比如图中，我们就将滑动窗口划成了6格，所以每格代表的是10秒钟。每过10秒钟，我们的时间窗口就会往右滑动一格。每一个格子都有自己独立的计数器counter，比如当一个请求 在0:35秒的时候到达，那么0:30~0:39对应的counter就会加1。</p>
<p>计数器算法其实就是滑动窗口算法。只是它没有对时间窗口做进一步地划分，所以只有1格。</p>
<p>由此可见，当滑动窗口的格子划分的越多，那么滑动窗口的滚动就越平滑，限流的统计就会越精确。</p>
<h2 id="漏桶算法">漏桶算法</h2>
<p>漏桶算法，又称leaky bucket。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020141343.png" alt=""></p>
<p>从图中我们可以看到，整个算法其实十分简单。首先，我们有一个固定容量的桶，有水流进来，也有水流出去。对于流进来的水来说，我们无法预计一共有多少水会流进来，也无法预计水流的速度。但是对于流出去的水来说，这个桶可以固定水流出的速率。而且，当桶满了之后，多余的水将会溢出。</p>
<p>我们将算法中的水换成实际应用中的请求，我们可以看到漏桶算法天生就限制了请求的速度。当使用了漏桶算法，我们可以保证接口会以一个常速速率来处理请求。所以漏桶算法天生不会出现临界问题。</p>
<h2 id="令牌桶算法">令牌桶算法</h2>
<p>令牌桶算法，又称token bucket。同样为了理解该算法，我们来看一下该算法的示意图：</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020141354.png" alt=""></p>
<p>从图中我们可以看到，令牌桶算法比漏桶算法稍显复杂。首先，我们有一个固定容量的桶，桶里存放着令牌（token）。桶一开始是空的，token以 一个固定的速率r往桶里填充，直到达到桶的容量，多余的令牌将会被丢弃。每当一个请求过来时，就会尝试从桶里移除一个令牌，如果没有令牌的话，请求无法通过。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>广度优先（BFS）</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135938.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>排序</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135848.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>数据结构</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135542.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>素数计算</h1>

<p>埃筛法
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135345.png" alt="">
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221006135438.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>类库&amp;框架</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>mybatis</h1>

<p>MyBatis是一个持久层的ORM框架，使用简单，学习成本较低。可以执行自己手 写的SQL语句，比较灵活。但是MyBatis的自动化程度不高，移植性也不高，有 时从一个数据库迁移到另外一个数据库的时候需要自己修改配置，所以称只为半 自动ORM框架</p>
<h2 id="jdbc方式">jdbc方式</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Connection</span> <span class="n">conn</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PreparedStatement</span> <span class="n">pstmt</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 1.加载驱动
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//Class.forName(&#34;com.mysql.jdbc.Driver&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 2.创建连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span> <span class="c1">// SPI ,mysql Driver Connector，的META-INF.services下会有 java.sql.Driver 的实现类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">getConnection</span><span class="o">(</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis_example&#34;</span><span class="o">,</span> <span class="s">&#34;root&#34;</span><span class="o">,</span> <span class="s">&#34;123456&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 开启事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// SQL语句 参数#{} ${} &lt;if&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">String</span> <span class="n">sql</span><span class="o">=</span><span class="s">&#34; select id,user_name,create_time from t_user where id=?;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 获得sql执行者 ：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 1. 执行预处理
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 执行查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ResultSet</span> <span class="n">rs</span><span class="o">=</span> <span class="n">pstmt</span><span class="o">.</span><span class="na">getResultSet</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//ResultSet rs= pstmt.executeQuery();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">user</span> <span class="o">=</span><span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;user_name&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="s">&#34;create_time&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 提交事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 回滚事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">finally</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 关闭资源
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="o">(</span><span class="n">conn</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="o">(</span><span class="n">pstmt</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pstmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="存在的问题">存在的问题</h3>
<ol>
<li>数据库连接创建，释放频繁造成西戎资源的浪费，从而影响系统性能，使 用数据库连接池可以解决问题。</li>
<li>sql语句在代码中硬编码，造成代码的不已维护，实际应用中sql的变化可 能较大，sql代码和java代码没有分离开来维护不方便。</li>
<li>使用preparedStatement向有占位符传递参数存在硬编码问题因为sql中 的where子句的条件不确定，同样是修改不方便</li>
<li>对结果集中解析存在硬编码问题，sql的变化导致解析代码的变化，系统维 护不方便。</li>
</ol>
<p>个人认为mybatis主要的功能就2点：
1、动态sql生成
2、ORM</p>
<h2 id="mybaits整体体系图">Mybaits整体体系图</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221021161015.png" alt=""></p>
<h2 id="使用">使用</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis‐config.xml&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">Reader</span> <span class="n">reader</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="o">{</span>  
</span></span><span class="line"><span class="cl"><span class="c1">//将XML配置文件构建为Configuration配置类  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">reader</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsReader</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl"><span class="c1">// 通过加载配置文件流构建一个SqlSessionFactory DefaultSqlSessionFactor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="n">SqlSessionFactory</span> <span class="n">sqlMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span>
</span></span><span class="line"><span class="cl"><span class="n">eader</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 数据源 执行器 DefaultSqlSession
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl"> <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlMapper</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="k">try</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="c1">// 执行查询 底层执行jdbc   
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//User user = (User)session.selectOne(&#34;com.tuling.mapper.selectById&#34;, 1);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectById</span><span class="o">(</span><span class="n">1L</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getUserName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span></code></pre></div><p>总结分为4步：</p>
<ul>
<li>从配置文件(通常是XML文件)得到SessionFactory;</li>
<li>从SessionFactory得到SqlSession;</li>
<li>通过SqlSession进行CRUD和事务的操作;</li>
<li>执行完相关操作之后关闭Session。</li>
</ul>
<h2 id="spring集成mybatis">spring集成mybatis</h2>
<p>官方文档
<a href="https://mybatis.org/spring/zh/index.html">https://mybatis.org/spring/zh/index.html</a></p>
<h3 id="方式-1-mapperscannerconfigurer">方式 1: MapperScannerConfigurer</h3>
<p>是mapper注入核心类，其实现了BeanDefinitionRegistryPostProcessor。
获取到配置以后，扫描mapper，通过MybatisMapperProxy生成代理对象，然后依靠<strong>MapperFactoryBean</strong>，把生成代理对象和mapper的name关联起来，然后注册beanDefination。</p>
<h3 id="方式2mapperscan">方式2:@MapperScan</h3>
<p>MapperScannerRegistrar，重写了spring 扫描bean的方法，配合<strong>MapperFactoryBean</strong>将代理后的mapper注入spring。</p>
<h2 id="mapper生成">mapper生成</h2>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>sentinel</h1>

<h2 id="简介">简介</h2>
<p><a href="https://sentinelguard.io/">Sentinel</a> 是面向分布式、多语言异构化服务架构的流量治理组件，主要以流量为切入点，从流量路由、流量控制、流量整形、熔断降级、系统自适应过载保护、热点流量防护等多个维度来帮助开发者保障微服务的稳定性。</p>
<h2 id="sentinel-基本概念">Sentinel 基本概念</h2>
<h3 id="资源">资源</h3>
<p>资源是 Sentinel 的关键概念。它可以是 Java 应用程序中的任何内容，例如，由应用程序提供的服务，或由应用程序调用的其它应用提供的服务，甚至可以是一段代码。在接下来的文档中，我们都会用资源来描述代码块。</p>
<p>只要通过 Sentinel API 定义的代码，就是资源，能够被 Sentinel 保护起来。大部分情况下，可以使用方法签名，URL，甚至服务名称作为资源名来标示资源。</p>
<h3 id="规则">规则</h3>
<p>围绕资源的实时状态设定的规则，可以包括流量控制规则、熔断降级规则以及系统保护规则。所有规则可以动态实时调整。</p>
<h2 id="sentinel-功能和设计理念">Sentinel 功能和设计理念</h2>
<h3 id="流量控制">流量控制</h3>
<p><img src="https://sentinelguard.io/docs/zh-cn/img/sentinel-flow-overview.jpg" alt="arch"></p>
<p>流量控制有以下几个角度:</p>
<ul>
<li>资源的调用关系，例如资源的调用链路，资源和资源之间的关系；</li>
<li>运行指标，例如 QPS、线程池、系统负载等；</li>
<li>控制的效果，例如直接限流、冷启动、排队等。</li>
</ul>
<p>Sentinel 的设计理念是让您自由选择控制的角度，并进行灵活组合，从而达到想要的效果。</p>
<h3 id="熔断降级">熔断降级</h3>
<h4 id="什么是熔断降级">什么是熔断降级</h4>
<p>除了流量控制以外，降低调用链路中的不稳定资源也是 Sentinel 的使命之一。由于调用关系的复杂性，如果调用链路中的某个资源出现了不稳定，最终会导致请求发生堆积。</p>
<p><img src="https://user-images.githubusercontent.com/9434884/62410811-cd871680-b61d-11e9-9df7-3ee41c618644.png" alt="image"></p>
<p>Sentinel 和 Hystrix 的原则是一致的: 当调用链路中某个资源出现不稳定，例如，表现为 timeout，异常比例升高的时候，则对这个资源的调用进行限制，并让请求快速失败，避免影响到其它的资源，最终产生雪崩的效果。</p>
<h4 id="熔断降级设计理念">熔断降级设计理念</h4>
<p>Sentinel 对这个问题采取了两种手段:</p>
<ul>
<li>通过并发线程数进行限制</li>
</ul>
<p>和资源池隔离的方法不同，Sentinel 通过限制资源并发线程的数量，来减少不稳定资源对其它资源的影响。这样不但没有线程切换的损耗，也不需要您预先分配线程池的大小。当某个资源出现不稳定的情况下，例如响应时间变长，对资源的直接影响就是会造成线程数的逐步堆积。当线程数在特定资源上堆积到一定的数量之后，对该资源的新请求就会被拒绝。堆积的线程完成任务后才开始继续接收请求。</p>
<ul>
<li>通过响应时间对资源进行降级</li>
</ul>
<p>除了对并发线程数进行控制以外，Sentinel 还可以通过响应时间来快速降级不稳定的资源。当依赖的资源出现响应时间过长后，所有对该资源的访问都会被直接拒绝，直到过了指定的时间窗口之后才重新恢复。</p>
<h3 id="系统负载保护">系统负载保护</h3>
<p>Sentinel 同时提供<a href="https://sentinelguard.io/zh-cn/docs/system-adaptive-protection.html">系统维度的自适应保护能力</a>。防止雪崩，是系统防护中重要的一环。当系统负载较高的时候，如果还持续让请求进入，可能会导致系统崩溃，无法响应。在集群环境下，网络负载均衡会把本应这台机器承载的流量转发到其它的机器上去。如果这个时候其它的机器也处在一个边缘状态的时候，这个增加的流量就会导致这台机器也崩溃，最后导致整个集群不可用。</p>
<p>针对这个情况，Sentinel 提供了对应的保护机制，让系统的入口流量和系统的负载达到一个平衡，保证系统在能力范围之内处理最多的请求。</p>
<h2 id="开源框架适配">开源框架适配</h2>
<ul>
<li>web servlet: CommonFilter</li>
<li>dubbo</li>
<li>http client</li>
<li>等等 <a href="https://sentinelguard.io/zh-cn/docs/open-source-framework-integrations.html">https://sentinelguard.io/zh-cn/docs/open-source-framework-integrations.html</a></li>
</ul>
<h2 id="控制台">控制台</h2>
<p>Sentinel 提供一个轻量级的开源控制台，它提供机器发现以及健康情况管理、监控（单机和集群），规则管理和推送的功能。这里，我们将会详细讲述如何通过简单的步骤就可以使用这些功能。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020103731.png" alt=""></p>
<h3 id="引入jar包">引入JAR包</h3>
<p>客户端需要引入 Transport 模块来与 Sentinel 控制台进行通信。您可以通过 <code>pom.xml</code> 引入 JAR 包:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.alibaba.csp<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>sentinel-transport-simple-http<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>x.y.z<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="配置启动参数">配置启动参数</h3>
<p>启动时加入 JVM 参数 <code>-Dcsp.sentinel.dashboard.server=consoleIp:port</code> 指定控制台地址和端口。若启动多个应用，则需要通过 <code>-Dcsp.sentinel.api.port=xxxx</code> 指定客户端监控 API 的端口（默认是 8719）。</p>
<p>除了修改 JVM 参数，也可以通过配置文件取得同样的效果。更详细的信息可以参考 <a href="https://sentinelguard.io/zh-cn/docs/startup-configuration.html">启动配置项</a>。</p>
<h3 id="触发客户端初始化">触发客户端初始化</h3>
<p><strong>确保客户端有访问量</strong>，Sentinel 会在<strong>客户端首次调用的时候</strong>进行初始化，开始向控制台发送心跳包。</p>
<h2 id="简单的demo">简单的demo</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SentinelDemoTest</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">    <span class="c1">// 配置规则.  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initFlowRules</span><span class="o">()</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">FlowRule</span><span class="o">&gt;</span> <span class="n">rules</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>  
</span></span><span class="line"><span class="cl">        <span class="n">FlowRule</span> <span class="n">rule</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowRule</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setResource</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setGrade</span><span class="o">(</span><span class="n">RuleConstant</span><span class="o">.</span><span class="na">FLOW_GRADE_QPS</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setCount</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rules</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rule</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">FlowRuleManager</span><span class="o">.</span><span class="na">loadRules</span><span class="o">(</span><span class="n">rules</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initDegradeRules</span><span class="o">()</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">DegradeRule</span><span class="o">&gt;</span> <span class="n">rules</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>  
</span></span><span class="line"><span class="cl">        <span class="n">DegradeRule</span> <span class="n">rule</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DegradeRule</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setResource</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setGrade</span><span class="o">(</span><span class="n">RuleConstant</span><span class="o">.</span><span class="na">DEGRADE_GRADE_EXCEPTION_COUNT</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setCount</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rule</span><span class="o">.</span><span class="na">setTimeWindow</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">rules</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rule</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">DegradeRuleManager</span><span class="o">.</span><span class="na">loadRules</span><span class="o">(</span><span class="n">rules</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 异常捕获式限流  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * try-with-resources 语句  
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>  
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>  
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">t1</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">initFlowRules</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">(</span><span class="n">Entry</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">SphU</span><span class="o">.</span><span class="na">entry</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">))</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 被保护的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;hello world&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">BlockException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 处理被流控的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;blocked!&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 异常捕获式限流  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * try finally 语句  
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>  
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>  
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">t1_1</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">initFlowRules</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="c1">// 配置规则.  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Entry</span> <span class="n">entry</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="n">SphU</span><span class="o">.</span><span class="na">entry</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 被保护的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;hello world&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 处理被流控的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;blocked!&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">BlockException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">entry</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                    <span class="n">entry</span><span class="o">.</span><span class="na">exit</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">                <span class="o">}</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 条件判断式限流  
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>  
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>  
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">t2</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="c1">// 配置规则.  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">initFlowRules</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">entryOk</span> <span class="o">=</span> <span class="n">SphO</span><span class="o">.</span><span class="na">entry</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">entryOk</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 被保护的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;hello world&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="c1">// 处理被流控的逻辑  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;blocked!&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">            <span class="n">SphO</span><span class="o">.</span><span class="na">exit</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="cm">/**  
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 降级  
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>  
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>  
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">t4</span><span class="o">()</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">initDegradeRules</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">Entry</span> <span class="n">entry</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>  
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="n">SphU</span><span class="o">.</span><span class="na">entry</span><span class="o">(</span><span class="s">&#34;HelloWorld&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;exception&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">BlockException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;degrade&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;pass&#34;</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">Tracer</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">entry</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
</span></span><span class="line"><span class="cl">                    <span class="n">entry</span><span class="o">.</span><span class="na">exit</span><span class="o">();</span>  
</span></span><span class="line"><span class="cl">                <span class="o">}</span>  
</span></span><span class="line"><span class="cl">            <span class="o">}</span>  
</span></span><span class="line"><span class="cl">        <span class="o">}</span>  
</span></span><span class="line"><span class="cl">    <span class="o">}</span>  
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="核心源码">核心源码</h2>
<p>在 Sentinel 里面，所有的资源都对应一个资源名称以及一个 Entry。Entry 可以通过对主流框架的适配自动创建，也可以通过注解的方式或调用 API 显式创建；每一个 Entry 创建的时候，同时也会创建一系列功能插槽（slot chain）。这些插槽有不同的职责，例如:</p>
<ul>
<li><code>NodeSelectorSlot</code> 1.负责收集资源的路径，并将这些资源的调用路径，以树状结构存储起来，用于根据调用路径来限流降级2.构造一个Node用于存储当前请求的统计数据；</li>
<li><code>ClusterBuilderSlot</code> 为了获得同一资源在不同上下文中的总统计信息，同一资源全局共享同一个ClusterNode。ClusterBuilderSlot主要负责构建这个ClusterNode；</li>
<li><code>StatisticSlot</code> 则用于记录、统计不同纬度的 runtime 指标监控信息；</li>
<li><code>FlowSlot</code> 则用于根据预设的限流规则以及前面 slot 统计的状态，来进行流量控制；</li>
<li><code>AuthoritySlot</code> 则根据配置的黑白名单和调用来源信息，来做黑白名单控制；</li>
<li><code>DegradeSlot</code> 则通过统计信息以及预设的规则，来做熔断降级；</li>
<li><code>SystemSlot</code> 则通过系统的状态，例如 load1 等，来控制总的入口流量；</li>
</ul>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221020095300.png" alt=""></p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/Sentinel%E9%99%90%E6%B5%81%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.jpg" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>胡诌八扯大道理</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>人生四问</h1>

<p>据说人生清楚这四个问题，就不再迷茫。</p>
<ol>
<li>我喜欢什么</li>
<li>我适合什么</li>
<li>我想成为怎样的人</li>
<li>我想过什么样的生活</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>人生大道理</h1>

<blockquote>
<p>迟来的深情不如狗叫 —— jukie</p>
</blockquote>
<blockquote>
<p>断臂求生——jukie</p>
</blockquote>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>高效人生</h1>

<h1 id="费曼学习法">费曼学习法</h1>
<h2 id="计划制定">计划制定</h2>
<p>决策时需要消耗很多意志力，最后通常只会选择最舒适的事。避免避免决策疲劳。</p>
<h3 id="前一天晚上想好第二天要干啥">前一天晚上想好第二天要干啥</h3>
<h3 id="不重要事情">不重要事情</h3>
<p>养成习惯在碎片化的时间完成不重要的事情，买东西、背单词、等在公交车上、午饭时等时间完成。</p>
<h3 id="核心任务化繁为简">核心任务化繁为简</h3>
<p>普通人集中精力完成任务大概6小时：</p>
<ul>
<li>3+2原则：3个大任务 1-2小时。2个小任务半小时</li>
<li>135原则：1个大任务、3个中任务、5个小任务。</li>
<li>自己设定，根据自己实际情况来，如果任务太多就适当减少。</li>
</ul>
<h3 id="分解任务更具有执行性">分解任务更具有执行性</h3>
<p>任务如果很大，那么这个任务通常很难启动，那就拆分任务，那么任务将更具有执行性。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>解决方案</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>DDD Domain-Driven Design</h1>

<h1 id="领域驱动设计">领域驱动设计</h1>
<blockquote>
<p><strong>Domain-driven design</strong> (<strong>DDD</strong>) is a major <a href="https://en.wikipedia.org/wiki/Software_design" title="Software design">software design</a> approach, focusing on modelling software to match a <a href="https://en.wikipedia.org/wiki/Domain_(software_engineering)" title="Domain (software engineering)">domain</a> according to input from that domain&rsquo;s experts. &mdash;wikipedia</p>
<p>领域驱动是一种软件设计方式，聚焦于软件模型和领域专家（十分了解具体业务的人）的输出相匹配。</p>
</blockquote>
<h2 id="解决的问题-系统老化">解决的问题-系统老化</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/uTools_1665071852424.png" alt=""></p>
<p>软件总是从简单发展到复杂，老化的原因主要是，真实世界和软件世界存在差异，并随着需求变更逐渐拉大。</p>
<h3 id="传统数据驱动设计存在的问题">传统数据驱动设计存在的问题</h3>
<p>传统MVC架构倾向于从数据库ER图开始进行设计。随着业务越来越多，变化越来越，事务脚本会越来越复杂，可能一个类里面有大量的逻辑。这时候系统将逐渐老化。
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221007134158.png" alt=""></p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221007134237.png" alt=""></p>
<h3 id="数据驱动到领域驱动">数据驱动到领域驱动</h3>
<p>Data Driven Design &ndash;&gt; Domain Driven Design</p>
<p>领域驱动设计是一种面向变化的一种设计，设计的核心模型从数据驱动的数据库表转移到领域模型。领域模型将由开发人员和领域专家共同设计，这样实际的模型将更贴近真实世界。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221014110834.png" alt=""></p>
<h2 id="优点">优点</h2>
<ul>
<li>代码更贴近真实世界，需求调整变更 更容易</li>
<li>逻辑更内聚，代码复用度更高，也更易于测试</li>
<li>业务逻辑不再需要背负技术债，根据业务场景变化开发即可</li>
</ul>
<h2 id="缺点">缺点</h2>
<p>DDD并非银弹</p>
<ol>
<li>概念多，学习成本高，难上手，新手往往不知所措。如果不熟悉DDD的思想，生硬地照搬ddd的规范，写出来的代码可能比传统的三层架构还糟糕，得不偿失。</li>
<li>实现一个功能写的代码量比传统的三层架构多</li>
<li>模型之间转换操作比较多，编码繁琐</li>
</ol>
<h2 id="概念">概念</h2>
<ul>
<li>*<strong>领域</strong>：某一类业务相关知识的集合，在一个领域下应使用统一语言对概念描述</li>
<li>*<strong>统一语言（UL）</strong>：从业务中提炼出来的概念术语，领域专家、产品、开发可以互相理解的沟通语言</li>
<li>*<strong>子域</strong>：一个子域是领域的一部分</li>
<li>*<strong>实体（Entity）</strong>：具有唯一标识，有状态（程序需要追踪其状态的变化），具有生命周期、mutable的领域对象</li>
<li>*<strong>值对象（valueObject）</strong>：没有唯一标识、无状态、无生命周期、可复用、immutable的领域对象，类似基本类型int、long、String</li>
<li>*<strong>聚合</strong>：一组具有关联关系领域对象，可包含实体和值对象</li>
<li>*<strong>聚合根</strong>：聚合的根，可以理解为可以代表整体概念的实体，操作子实体和值对象需要通过聚合根遍历，类似树形数据结构的根节点，这样可以保证数据的完整性</li>
<li>*<strong>领域事件</strong>：某个操作触发的事件，领域事件可以跟踪领域对象生命周期的状态变化过程。例如一个实体经过多次修改，每次产生一个实体修改事件，把所有实体修改事件按发生的顺序可以重建某个时间点的快照对象。领域事件也是同一个用例操作多个聚合的实现方式</li>
<li>*<strong>领域服务</strong>：同一个操作中需要操作到多个聚合根对象的逻辑需要抽到领域服务，或者同一个聚合中可以被多个用例复用的公共逻辑</li>
</ul>
<p>实体和值对象如何区别：
主要是通过有没有唯一标识确定，相同的对象在不同场景可能表现不同，比如用户的收货地址和订单的收货地址，用户的收货地址是实体，而订单的收货地址可能就是值对象，如果用户的收货地址改变，订单的收货地址是不会变的。</p>
<p>开发流程：</p>
<ol>
<li>首先对需要处理的业务问题进行总览。</li>
<li>然后领域对象(Entity)进行划分，明确每个领域对象的包含的信息和职责边界。
并进行跨对象，多对象的逻辑组织(Domain Service)</li>
<li>接着在上层应用中根据业务描述去编排Entity和Domain Service。</li>
<li>最后再做一些下水道工作，去对下层的数据访问，RPC调用去做一些具体实现。</li>
</ol>
<h1 id="cqrs-">CQRS ：</h1>
<p>按照领域建模固然很好，但是面对各种各样的查询条件和表单时，仅仅依赖领域对象和聚合来组织代码时，往往会显得很笨拙，但是如果我们放宽对查询的要求，可以在不破坏模型的情况下，尽可能的保证查询的效率和灵活性。这就引出了CQRS</p>
<p>CQRS全称Command Query Responsibility Segregation，即命令查询职责分离，顾名思义，将命令和查询分离。</p>
<p>查询，就是查询数据（CRUD中的R），不会对数据产生变化，因此它是<strong>幂等</strong>的,不用担心对系统产生影响，因此也可以针对查询添加<strong>缓存</strong>操作提升查询性能。</p>
<p>那命令是啥呢？这里命令则是<strong>对数据产生变化的操作</strong>的总称（CRUD中的CUD）。</p>
<p>大多数软件系统中，查询频率要远大于命令操作，这是将查询与命令分离的根本原因。</p>
<p>通过CQRS模式将读模型和写模型分离，使得我们可以优化读性能和写性能之外，还可以让我们的代码更加清晰简洁，更加体现出领域，更易维护。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221014143632.png" alt=""></p>
<blockquote>
<p>一些比较好的例子
CQRS：https://zhuanlan.zhihu.com/p/505023604
<a href="https://developer.aliyun.com/article/719251">https://developer.aliyun.com/article/719251</a>
<a href="https://juejin.cn/post/7131186996277411876">https://juejin.cn/post/7131186996277411876</a>
<a href="https://developer.aliyun.com/article/716908?spm=a2c6h.13262185.profile.62.3729653boxTzr3">https://developer.aliyun.com/article/716908?spm=a2c6h.13262185.profile.62.3729653boxTzr3</a></p>
</blockquote>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>分页数据丢失或者重复问题</h1>

<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221126161124.png" alt="">
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20221126161159.png" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>权限控制</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>ldap-轻量目录访问协议</h1>

<p>LDAP是轻量目录访问协议,英文全称是Lightweight Directory Access Protocol,一般都简称为LDAP.</p>
<p>现在市场上有关LDAP的产品已有很多,各大软件公司都在他们的产品中集成了LDAP服务,如Microsoft的<code>ActiveDirectory</code>、Lotus的<code>Domino Directory</code>、IBM的<code>WebSphere</code>中也集成了LDAP服务.LDAP的开源实现是<code>OpenLDAP</code>,它比商业产品一点也不差,而且源码开放.</p>
<p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.openldap.org%2F">OpenLDAP</a>是最常用的目录服务之一,它是一个由开源社区及志愿者开发和管理的一个开源项目,提供了目录服务的所有功能,包括目录搜索、身份认证、安全通道、过滤器等等.大多数的Linux发行版里面都带有OpenLDAP的安装包.<code>OpenLDAP</code>服务默认使用非加密的<code>TCP/IP</code>协议来接收服务的请求,并将查询结果传回到客户端.由于大多数目录服务都是用于系统的安全认证部分比如:用户登录和身份验证,所以它也支持使用基于 SSL/TLS 的加密协议来保证数据传送的保密性和完整性.<code>OpenLDAP</code>是使用<code>OpenSSL</code>来实现<code>SSL/TLS</code>加密通信的.</p>
<p>LDAP的信息模型是建立在”条目”(entries)的基础上.一个条目是一些属性的集合,并且具有一个全局唯一的”可区分名称”DN,一个条目可以通过DN来引用.每一个条目的属性具有一个类型和一个或者多个值.类型通常是容易记忆的名称,比如”cn”是通用名称(common name),或者”mail”是电子邮件地址.条目的值的语法取决于属性类型.比如,cn属性可能具有一个值”Babs Jensen” .一个mail属性可能包含”<a href="https://links.jianshu.com/go?to=mailto%3Abbs%40example.com">bbs@example.com</a>” .一个jpegphoto属性可能包含一幅JPEG(二进制)格式的图片.</p>
<p>LDAP常用关键字列表 LDAP通过属性objectClass来控制哪一个属性必须出现或允许出现在一个条目中,它的值决定了该条目必须遵守的模式规则.</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220608193750.png" alt=""></p>
<h3 id="entry">Entry</h3>
<p>条目,也叫记录项,是LDAP中最基本的颗粒,就像字典中的词条,或者是数据库中的记录.通常对LDAP的添加、删除、更改、检索都是以条目为基本对象的.</p>
<ul>
<li>dn:每一个条目都有一个唯一的标识名(distinguished Name,DN),如上述中一个 dn:”uid=mac,ou=People,dc=example,dc=cn”.通过DN的层次型语法结构,可以方便地表示出条目在LDAP树中的位置,通常用于检索.</li>
<li>rdn:一般指dn逗号最左边的部分,如cn=baby.它与RootDN不同,RootDN通常与RootPW同时出现,特指管理LDAP中信息的最高权限用户.</li>
<li>Base DN:LDAP目录树的最顶部就是根,也就是所谓的“Base DN”,如”dc=example,dc=com”.</li>
</ul>
<h3 id="schema">schema</h3>
<p>对象类(ObjectClass)、属性类型(AttributeType)、语法(Syntax)分别约定了条目、属性、值,他们之间的关系如下图所示.所以这些构成了模式(Schema)——对象类的集合.条目数据在导入时通常需要接受模式检查,它确保了目录中所有的条目数据结构都是一致的.</p>
<p>schema(一般在<code>/etc/ldap/schema/</code>目录)在导入时要注意前后顺序.</p>
<p>对于LDAP目录中保存的信息,可以使用<code>LDIF</code>(LDAP Interchange Format)格式来保存.这是一种标准文本文件格式,使用这种格式保存得的LDAP服务器数据库中的数据可方便读取和修改,这也是其他大多数服务配置文件所采取的格式.</p>
<h3 id="attribute">Attribute</h3>
<p>属性(Attribute)类似于程序设计中的变量,可以被赋值.在OpenLDAP中声明了许多常用的Attribute(用户也可自己定义Attribute).</p>
<p>每个条目都可以有很多属性(Attribute),比如常见的人都有姓名、地址、电话等属性.每个属性都有名称及对应的值,属性值可以有单个、多个,比如你有多个邮箱.</p>
<p>属性不是随便定义的,需要符合一定的规则,而这个规则可以通过schema制定.比如,如果一个entry没有包含在 inetorgperson 这个 schema 中的objectClass: inetOrgPerson,那么就不能为它指定employeeNumber属性,因为employeeNumber是在inetOrgPerson中定义的.</p>
<p>LDAP为人员组织机构中常见的对象都设计了属性(比如commonName,surname).下面有一些常用的别名:</p>
<p>属性</p>
<p>别名</p>
<p>语法</p>
<p>描述</p>
<p>值（举例）</p>
<p>commonName</p>
<p>cn</p>
<p>Directory String</p>
<p>姓名</p>
<p>sean</p>
<p>surname</p>
<p>sn</p>
<p>Directory String</p>
<p>姓</p>
<p>Chow</p>
<p>organizationalUnitName</p>
<p>ou</p>
<p>Directory String</p>
<p>单位（部门）名称</p>
<p>IT</p>
<p>organization</p>
<p>o</p>
<p>Directory String</p>
<p>组织（公司）名称</p>
<p>example</p>
<p>telephoneNumber</p>
<p>Telephone Number</p>
<p>电话号码</p>
<p>110</p>
<p>objectClass</p>
<p>内置熟悉</p>
<p>top</p>
<p>常见的Attribute含义如下:</p>
<ul>
<li>c:国家.</li>
<li>cn:common name,指一个对象的名字.如果指人,需要使用其全名.</li>
<li>dc:domain Component,常用来指一个域名的一部分.</li>
<li>givenName:指一个人的名字,不能用来指姓.</li>
<li>l:指一个地名,如一个城市或者其他地理区域的名字.</li>
<li>mail:电子信箱地址.</li>
<li>o:organizationName,指一个组织的名字.</li>
<li>ou:organizationalUnitName,指一个组织单元的名字.</li>
<li>sn:surname,指一个人的姓.</li>
<li>telephoneNumber:电话号码,应该带有所在的国家的代码.</li>
<li>uid:userid,通常指某个用户的登录名,与Linux系统中用户的uid不同.</li>
</ul>
<p>作者：华阳_3bcf<br>
链接：https://www.jianshu.com/p/3716b84c4c1d<br>
来源：简书<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220608193204.png" alt=""></p>
<p><a href="https://zhuanlan.zhihu.com/p/74512921">https://zhuanlan.zhihu.com/p/74512921</a></p>
<p><img src="https://pic1.zhimg.com/80/v2-a6a1e82cc41a9ca7bef54e49268f98c4_1440w.jpg" alt=""></p>
<p>在 LDAP 里， 一切都是<strong>等级化</strong>的，或者称之为<strong>层级化</strong>（hiearchical）。</p>
<p>一棵树有树干，树枝和树叶；树叶长在树枝上，树枝依附于树干。这就是一个简单的层级结构。LDAP 的结构同一棵树类似。假设 LDAP 里存储的是公司的信息，那么可以把<strong>公司</strong>（company）本身理解为树干，公司里面的各个部门，比如<strong>组</strong>（group），理解为树干，把<strong>用户</strong>（user）理解为树叶。这样的结构称之为<strong>目录信息树</strong>（DIrectory Information Tree，DIT）。</p>
<p><img src="https://pic1.zhimg.com/80/v2-6ab04198f971a70cd53100f17a6282e4_1440w.jpg" alt=""></p>

            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>类微博feed流</h1>

<h1 id="push模式">PUSH模式</h1>
<p>为每个订阅的用户推消息
缺点：大V推送的用户太多</p>
<h1 id="pull模式">PULL模式</h1>
<p>用户上线以后去拉去新消息
缺点：比较复杂，而且要多次查询再排序</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>限流</h1>


            <footer class="footline">
            </footer>
          </article>

          </section>
          <article class="default">
<h1>计算机基础</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
          <article class="default">
<h1>HTTP</h1>

<h2 id="cookie--session">Cookie &amp; Session</h2>
<h3 id="cookie的属性">cookie的属性</h3>
<p>HttpOnly:
如果您在cookie中设置了HttpOnly属性，那么通过js脚本将无法读取到cookie信息，这样能有效的防止[[XSS跨站脚本攻击]]
path：对应url的作用域，默认是当前路径 ex：/a/b 默认是/a
max-age：指定的是从文档被访问后的存活时间，这个时间是个相对值(比如:3600s),相对的是文档第一次被请求时服务器记录的Request_time(请求时间)
Expires：指定的时间可以是相对文件的最后访问时间(Atime)或者修改时间(MTime),而max-age相对对的是文档的请求时间(Atime)</p>
<h3 id="删除cookie">删除cookie</h3>
<p>把cookie的过期时间设为0或者过去</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>HTTPS</h1>

<h2 id="x509">X.509</h2>
<p>是证书的标准格式。
x509是一个证书格式，证书的版本信息包含有：<br>
证书的序列号，每个证书都有一个唯一的证书序列号；<br>
证书所使用的签名算法；<br>
证书的发行机构名称，命名规则一般采用X.500格式；<br>
证书的有效期，现在通用的证书一般采用UTC时间格式，它的计时范围为1950-2049;<br>
证书所有人的名称，命名规则一般采用X.500格式；<br>
证书所有人的公开密钥；<br>
证书发行者对证书的签名。</p>
<p>X.509文件格式<br>
Cer/crt用于保存证书，并以没有私钥的二进制数存储。<br>
pem和cer/crt区别是它以Ascii来表示，可以用于存放证书或者私钥。<br>
pfx/p12用于存放个人证书/私钥。通常包含保护密码，2进制方式。<br>
p10是证书请求。<br>
p7r是CA对证书请求的回复，只用于导入。<br>
p7b以树状展示证书链，同时支持单个证书，不含私钥。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>IO相关</h1>

<h1 id="tcp">TCP</h1>
<h2 id="建立连接">建立连接</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220823160032.png" alt=""></p>
<h2 id="断开连接">断开连接</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220823160058.png" alt=""></p>
<h2 id="报文内容">报文内容</h2>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220823160124.png" alt="">
SYN(synchronous建立联机)</p>
<p>ACK(acknowledgement 确认)</p>
<p>PSH(push传送)</p>
<p>FIN(finish结束)</p>
<p>RST(reset重置)</p>
<p>URG(urgent紧急)</p>
<p>每个请求都有一个顺序号
Sequence number(顺序号码)</p>
<h1 id="linux-io">linux IO</h1>
<h2 id="tcp网络通信整体流程">TCP网络通信整体流程</h2>
<h3 id="服务端准备连接流程">服务端准备连接流程</h3>
<h4 id="socket函数">SOCKET函数</h4>
<p>为了执行网络I/O，我们要做的第一件事情就是调用socket函数，指定期望的协议类型。该函数会创建一个通信的端点，并返回引用该端点的<code>文件描述符</code>，该文件描述符也称为<code>套接字描述符</code>(socket descriptor)，简称<code>sockfd</code>。</p>
<p><img src="https://cdn.itzhai.com/image-20201025142106320-a.png-itzhai" alt="image-20201025142106320"></p>
<h4 id="bind函数">BIND()函数</h4>
<p>bind()函数把一个本地协议地址赋予一个套接字。</p>
<p><img src="https://cdn.itzhai.com/image-20201025142232845-a.png-itzhai" alt="image-20201025142232845"></p>
<blockquote>
<p>如果一个TCP客户端或者服务器没有调用bind绑定端口，或者指定IP地址，那么内核就会为该套接字选择一个临时端口号。</p>
</blockquote>
<h4 id="listen函数">LISTEN()函数</h4>
<p>通过socket()函数创建了套接字之后，再执行listen()函数，会把套接字转换为一个<strong>被动套接字</strong>，<strong>指示内核应该接收指向该套接字的连接请求，并导致套接字从CLOSED状态转换到LISTEN状态。</strong></p>
<p><img src="https://cdn.itzhai.com/image-20201025142443289-a.png-itzhai" alt="image-20201025142443289"></p>
<p>在客户端请求服务器之后，服务器内核会把请求套接字放入到未完成队列中：
如下图：</p>
<p><img src="https://cdn.itzhai.com/image-20201025125747046-a.png-itzhai" alt="image-20201025125747046"></p>
<p>服务器接收到客户端SYN请求后，于是请求套接字进入未完成连接队列，等到服务端响应了ACK和SYN完成三次握手后，于是，套接字进入已完成连接队列。已完成连接队列中的套接字可以被服务器进程执行accept函数获取到。</p>
<h4 id="accept函数">ACCEPT()函数</h4>
<p>服务器一旦执行了socket()、bind()、listen()函数之后，就表示已经初始化好了监听套接字，并且把自己变为了被动套接字，等待客户端的请求。这个时候，我们需要继续调用accept()函数，让服务器进入<strong>阻塞等待</strong>获取客户端的已连接套接字。</p>
<p>当进程调用accept()时，已完成连接队列中的队头将返回给进程，或者如果队列为空，那么进程将被投入睡眠，直到TCP在该队列中放入一项才唤醒它。</p>
<p>在调用accept()之后，阻塞等待客户连接到达，然后获取一个已连接套接字：</p>
<p><img src="https://cdn.itzhai.com/image-20201025165112038-a.png-itzhai" alt="image-20201025165112038"></p>
<blockquote>
<p><strong>关于监听套接字和已连接套接字</strong></p>
<p>注意，这里要区分好服务端的监听套接字和已连接套接字，服务端调用socket()返回的是<code>监听套接字</code>，bind()和listen()函数入参也是监听套接字。</p>
<p>一旦有客户端请求过来了于是产生了一个<code>已连接套接字</code>，后续和客户端的交互是通过这个已连接套接字进行的。监听套接字只负责监听客户端请求并获取和客户端的已连接套接字。</p>
</blockquote>
<h3 id="客户端发起连接流程">客户端发起连接流程</h3>
<h4 id="connect函数">CONNECT()函数</h4>
<p>connect()函数由客户端调用，请求与服务端建立连接，这个函数会触发三次握手。大致流程如下：</p>
<p><img src="https://cdn.itzhai.com/image-20201025165149999-a.png-itzhai" alt="image-20201025165149999"></p>
<ul>
<li>客户端：
<ul>
<li>connect调用是的当前套接字从CLOSED状态进入SYN_SENT状态，如果节而受到了服务器的SYN+ACK响应，则转移到ESTABLISHED状态；</li>
<li>如果connect失败，则表示套接字不在可用，必须关闭，不能再次尝试调用connect函数；</li>
</ul>
</li>
<li>服务端：
<ul>
<li>每当接收到SYN时，TCP在未完成连接队列中创建一个新的条目，然后响应TCP三次握手的第二个分节；</li>
<li>每当收到三次握手的第三个分节的时候，就把条目从未完成队列移到已完成连接队列的队尾。此时，服务端accept调用将被唤醒并得到一个已连接套接字。</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：客户在调用connect函数之前，不是一定要调用bind函数，这个时候内核会确定源IP地址，并选择一个临时端口号作为源端口号。</p>
<p>所以大家在监控TCP连接的时候，可以发现请求客户端的端口都是没有什么规律的。因为这个端口号是临时端口号。</p>
</blockquote>
<p>当服务器队列满了，有新的客户端connect请求的SYN到达时怎么办？</p>
<p>这个时候，TCP会忽略这个SYN分节，也不会向客户端发送RST，好让客户TCP有机会重发SYN，以便在不久之后可以在这些队列中找到可用的空间。</p>
<p>如果直接响应RST，客户的connect()调用会立刻返回错误，导致应用进程必须要处理这种情况。</p>
<blockquote>
<p>因为从服务端的角度来看，经理一个RTT之后，TCP条目就会从未完成队列移动到已完成连接队列。所以，未完成连接队列中的任何一项的存留时间是一个RTT。</p>
</blockquote>
<p>一旦connect()成功之后，客户端和服务器就可以通过数据交换相关函数进行数据交换了。</p>
<h3 id="整体流程">整体流程</h3>
<p><img src="https://gitee.com/yuvenhol/blog-pic/raw/master/img/20220104203253.png" alt=""></p>
<h2 id="概念说明">概念说明</h2>
<p>　　1. 内核态（内核空间）和用户态（用户空间）的区别和联系？
　　　　用户空间是用户进程所在的内存区域，系统空间是操作系统所在的内存区域。
　　　　为了保证内核的安全，处于用户态的程序只能访问用户空间，而处于内核态的程序可以访问用户空间和内核空间。
　　2. 文件描述符fd
　　　　Linux将所有设备都当做文件来处理，文件描述符来标识每个文件对象。
　　　　当程序打开一个现有文件或者创建一个新文件时，内核向进程返回一个文件描述符。
　　3. 缓存IO
　　　　Linux的缓存IO机制中，操作系统会将IO的数据缓存在文件系统的页缓存中，也就是说，数据会先被拷贝到操作系统内核的缓冲区，然后才会从操作系统内核的缓冲区拷贝到应用程序的地址空间。</p>
<h3 id="涉及系统调用">涉及系统调用</h3>
<h4 id="recvfrom">recvfrom：</h4>
<p>从socket读取数据</p>
<h4 id="select">select：</h4>
<p>select() allow a program to monitor multiple file descriptors, waiting until one or more of the file descriptors become &ldquo;ready&rdquo; for some class of I/O operation
select 监控多个io操作的文件描述符，直到一个或者多个文件描述符编程ready状态</p>
<h4 id="poll">poll：</h4>
<p>与select类似，链表实现的，没有上限限制</p>
<h4 id="epoll">epoll：</h4>
<p>epoll就是event poll ，基于事件驱动
主要用到三个函数调用：
epoll_create：创建epoll对象
epoll_ctl：把文件描述符交给epoll对象监控
epoll_wait: waits for I/O events, blocking the calling thread if no events are currently available.</p>
<p><img src="https://s2.loli.net/2022/01/04/PmtbnMwKdvruHcF.png" alt=""></p>
<h2 id="io模型">IO模型</h2>
<p>　一般而言，一个输入操作，一般会经历如下处理过程：等待数据准备好，从内核复制到进程。这里的数据复制，一般是应用进程调用了某个IO方法之后，陷入系统调用，在内核态完成的。</p>
<p><img src="https://cdn.itzhai.com/image-20201028084848560-a.png-itzhai" alt="image-20201028084848560"></p>
<p>　　linux系统产生了下面五种网络模式的方案：</p>
<h3 id="阻塞式io模型">阻塞式I/O模型</h3>
<p><img src="https://cdn.itzhai.com/image-20201029085102627-a.png-itzhai" alt="image-20201029085102627"></p>
<p>如上图，在应用进程调用 recvfrom()之后，陷入内核态，直到数据报到达并且复制到应用进程缓冲区之后才返回到用户态。</p>
<p>或者在系统调用期间发生错误，也会立刻返回。</p>
<p>这种I/O称为阻塞I/O。</p>
<h3 id="非阻塞式io模型">非阻塞式I/O模型</h3>
<p><img src="https://cdn.itzhai.com/image-20201029085245393-a.png-itzhai" alt="image-20201029085245393"></p>
<p>如上图，当我们把套接字设置为非阻塞模式的时候，内核会这样处理I/O操作：当请求的I/O操作非得把本进程投入睡眠才能完成时，就不要投入睡眠，而是返回一个错误，在上面的例子中，调用recvfrom()之后，因为数据没有准备好，所以内核直接返回一个EWOULDBLOCK错误，直到数据准备好了，才复制数据到进程空间，并返回系统调用继续处理进程逻辑。</p>
<p>而<strong>应用进程会不断循环调用recvfrom()函数，这种处理方式我们称为<code>polling</code>(轮训)</strong>，持续到轮训内核，查看数据是否准备好。<strong>这种方式的缺点是会消耗大量的CPU时间</strong>。</p>
<p>注意：当recvfrom发起系统调用发现数据准备好了，将数据从内核复制到用户空间的时候，<strong>应用进程还是会被阻塞</strong>，只不过不会阻塞在等待数据准备好这个流程，从而减少了阻塞时间。</p>
<p>这种轮训对于单进程或者单线程的程序特别有用。</p>
<h3 id="io复用模型">I/O复用模型</h3>
<p>I/O复用(I/O multiplexing)，指的是通过一个支持同时感知多个描述符的函数系统调用，阻塞在这个系统调用上，等待某一个或者几个描述符准备就绪，就返回可读条件。常见的如select，poll，epoll系统调用可以实现此类功能功能。这种模型不用阻塞在真正的I/O系统调用上。</p>
<p>工作原理如下图所示：</p>
<p><img src="https://cdn.itzhai.com/image-20201029085514237-a.png-itzhai" alt="image-20201029085514237"></p>
<p>如上图，这种模型与非阻塞式I/O相比，把轮训判断数据是否准备好的处理方式替换为了通过select()系统调用的方式来实现。</p>
<p>**select()是实现I/O多路复用的经典系统调用函数。**select()可以同时等待多个套接字的变为可读，只要有任意一个套接字可读，那么就会立刻返回，处理已经准备好的套接字了。</p>
<blockquote>
<p>在多线中使用阻塞I/O，即每个文件描述符一个线程，与I/O复用模型很类似，每个线程可以自由调用阻塞式I/O系统调用。</p>
</blockquote>
<h3 id="信号驱动式io模型">信号驱动式I/O模型</h3>
<p>所谓信号驱动式I/O(signal-driven I/O)，就是指在描述符准备就绪的时候，让内核发送一个SIGIO信号通知应用进程进行后续的数据读取等处理。工作原理如下图所示：</p>
<p><img src="https://cdn.itzhai.com/image-20201101160607451-a.png-itzhai" alt="image-20201101160607451"></p>
<p>注册了SIGIO信号处理函数，开启了信号驱动式IO之后，就可以继续执行程序了，等到数据报准备好之后，内核会发送一个SIGIO信号给应用进程，然后应用进程在信号处理函数中调用recvfrom读取数据报。</p>
<p>这种模型在内核等待数据报达到期间进程不会被阻塞，可以继续执行。</p>
<h3 id="异步io模型">异步I/O模型</h3>
<p>可以发现，上面所有的I/O模型都会在某一个执行点阻塞，并不是真正的异步的。接下来我们就介绍下真正的异步I/O模型(asynchronous I/O)。如下图：</p>
<p><img src="https://cdn.itzhai.com/image-20201031102929395-a.png-itzhai" alt="image-20201031102929395"></p>
<p>通过异步处理函数如aio_read告知内核启动某个动作，并且让内核在整个操作完成之后再通知应用进程，内核会在把数据复制到用户空间缓冲区之后再进行通知。整个IO过程应用进程都不会被阻塞。</p>
<h3 id="五种io模型对比">五种I/O模型对比</h3>
<p>下面我们通过一个表格来总结下这五种I/O模型
下面是执行流程的对比图：</p>
<p><img src="https://cdn.itzhai.com/image-20201031111428511-a.png-itzhai" alt="image-20201031111428511"></p>
<p>可以很清晰的看到各种I/O模型的不同表现。</p>
<h1 id="io多路复用">IO多路复用</h1>
<p>「多路复用」原常用于通讯，多个线路通过复用器共用一个高速线路，以此来减少线路的使用。
所以「IO多路复用」，也是一个类似的概念，通过一个线程来实现多个io流的管理，但是这里只是管理，具体读写还是具体线程实现的。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>shell 的login shell与non-login shell</h1>

<p>bash有几种不同的运行模式，login shell与non-login shell,.interactive shell.与non-interactive shell(比如执行shel脚本)。这两种
分类方法是交叉的，也就是说一个login shell7可能是一个interactive shell,也可能是个non-interactive shell。.
在下列情况下，我们可以获得一个login shell:
1.登录系统时获得的J顶层shell,无论是通过本地终端登录，还是通过网络ssh登录。这种情况下获得的login shell是一个交互式shell。.
2.在终端下使用-login选项调用bash,可以获得一个交互式login shell。.
3.在脚本中使用-login选项调用bash(比如在shell脚本第一行做如下指定：#！/bin/bash&ndash;login),此时得到一个非交互式的login
shell。
4.使用&quot;su-“切换到指定用户时，获得此用户的login shell。如果不使用”.&quot;，则获得non-login shell。
login shell与non-login shell的主要区别在于它们启动时会读取不同的配置文件，从而导致环境不一样。
login shell的行为：
login shell,启动时首先读取/etc/profile:全局配置，然后依次查找~/.bash_profile、~/.bash_login、~/.profile三个配置文件，并且
读取第一个找到的并且可读的文件。login shell退出时读取并执行~/.bash_logout中的命令。
non-login shell的行为：
交互式的non-login shell)启动时读取~.bashrc资源文件。非交互式的non&ndash;login shell不读取上述所有配置文件，而是查找环境变量
BASH ENV,读取并执行BASH ENV指向的文件中的命令。
如果使用命令&quot;sh&quot;调用bash,bash会尽可能保持向后兼容。作为login shellF启动时，bash依次读取/etc/profile和~l.profile配置文件。作为
non-login shell/启动时，bash读取环境变量ENV指向的文件。
通常我们要定制一些配置时，将配置写在.bashrc中，然后在/.bash_profile中读取~/.bashrc,这样可以保证login shell和交互式non-login shell得到相同的配置。至于/etc/profile就不要轻易去改啦，毕竟会影响系统全局的配置。</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>TCP IP协议</h1>

<p>为啥是去中心化的：
阿帕网当初设计的时候为了防止苏联人攻击损坏一个节点，其他节点不可用，所以做成了去中心化的。
IEEE和ISO</p>
<p>OSI 七层模型是ISO提供的，都是学者相对学术
IEEE是 五工程师协会提出的，更加实际可实现</p>
<p>IP地址和MAC地址的区别</p>
<p>IP地址可以变动、mac地址是不变的，相同子网内寻址使用MAC地址，不同网络使用IP地址</p>
<p><img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220713144939.png" alt=""></p>
<p>SYN(synchronous建立联机)
ACK(acknowledgement 确认)
PSH(push传送)
FIN(finish结束)
RST(reset重置)
URG(urgent紧急)</p>
<p>Sequence number(顺序号码)</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1>时间</h1>

<h1 id="gmt时间">GMT时间：</h1>
<p>格林威治时间，以本初子午线为0时区，每个时区调整时区显示。</p>
<h1 id="utc时间">UTC时间：</h1>
<p>utc格式：UTC本地时间 = UTC标准时间 拼上 时间偏移量。
ex:若现在UTC时间是 10:30z（z表示偏移量=0，不可省略），则北京时间为 10:30 +0800、纽约时间为 10:30 -0500，分别表示同日下午6点半、同日上午五点半。</p>
<h1 id="iso8601标准时间格式">ISO8601标准时间格式：</h1>
<p>基于utc时间，前端时间为时区时间方便使用，后段时间为时区偏移量，方便辨别。
ex:2021-03-01T18:03:24.208+08:00
<img src="https://yuvenhol-1255563050.cos.ap-beijing.myqcloud.com/img/20220901215456.png" alt=""></p>
<h1 id="java中的时间">java中的时间</h1>
<p>可以用Instant代替 Date，LocalDateTime代替 Calendar，DateTimeFormatter 代替 SimpleDateFormat。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>
              </section>        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
          <style>
            #logo svg,
            #logo svg * {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              fill: #282828 !important;
              fill: var(--MENU-SECTIONS-BG-color) !important;
              opacity: .945;
            }
            a#logo {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              font-family: 'Work Sans', 'Helvetica', 'Tahoma', 'Geneva', 'Arial', sans-serif;
              font-size: 30px;
              font-weight: 300;
              margin-top: -13px;
              max-width: 60%;
              text-transform: uppercase;
              width: 226px;
              white-space: nowrap;
            }
            a#logo:hover {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
            }
            #logo svg {
              margin-bottom: -20px;
              margin-left: -23.5px;
              width: 40.5%;
            }
            @media only all and (max-width: 59.938em) {
              a#logo {
                font-size: 25px;
                margin-top: -3px;
              }
              #logo svg {
                margin-bottom: -12px;
                margin-left: -23px;
              }
            }
            @media all and (-ms-high-contrast:none) {
              /* IE11s understanding of positioning is weird at best */
              a#logo {
                margin-top: -58px;
              }
              #logo svg {
                margin-bottom: -62px;
              }
            }
          </style>
          <a id="logo" href="/">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64.044 64.044">
              <path d="M46.103 136.34c-.642-.394-1.222-2.242-1.98-2.358-.76-.117-1.353.506-1.618 1.519-.266 1.012-.446 4.188.173 5.538.213.435.482.787 1.03.845.547.057.967-.504 1.45-1.027.482-.523.437-.9 1.142-.612.705.289 1.051.4 1.586 1.229.535.828 1.085 4.043.868 5.598-.241 1.458-.531 2.8-.59 4.088.26.075.517.148.772.217 2.68.724 5.373 1.037 7.873.02.001-.028.01-.105.008-.11-.048-.165-.18-.41-.36-.698-.18-.29-.414-.645-.586-1.114a3.212 3.212 0 0 1-.125-1.735c.056-.21.153-.342.249-.475 1.237-1.193 2.932-1.373 4.244-1.384.557-.004 1.389.016 2.198.255.809.239 1.706.724 2.068 1.843.187.578.114 1.17-.043 1.623-.153.438-.369.783-.545 1.091-.178.31-.329.6-.401.821-.007.02-.003.071-.005.094 2.256 1.008 4.716.91 7.189.398.55-.114 1.11-.247 1.673-.377.344-1.085.678-2.145.852-3.208.124-.752.158-2.311-.078-3.538-.118-.613-.306-1.15-.52-1.489-.221-.349-.413-.501-.747-.538-.243-.027-.51.013-.796.098-.67.223-1.33.606-1.966.76l-.008.002-.109.032c-.556.152-1.233.158-1.797-.36-.556-.51-.89-1.367-1.117-2.596-.283-1.528-.075-3.279.89-4.518l.071-.09h.07c.65-.71 1.485-.802 2.16-.599.706.213 1.333.629 1.772.84.736.354 1.185.319 1.475.171.291-.148.5-.439.668-.955.332-1.017.301-2.819.022-4.106-.148-.684-.13-1.292-.13-1.883-1.558-.463-3.067-.982-4.574-1.208-1.128-.169-2.263-.173-3.298.164-.13.046-.256.095-.38.15-.373.164-.633.342-.805.52-.077.098-.081.105-.087.21-.004.068.031.289.13.571.1.282.256.634.467 1.03.279.524.448 1.063.431 1.618a2.12 2.12 0 0 1-.499 1.309 1.757 1.757 0 0 1-.62.51h-.002c-.515.291-1.107.404-1.723.464-.86.083-1.787.026-2.598-.097-.806-.123-1.47-.28-1.948-.555-.444-.256-.79-.547-1.037-.925a2.273 2.273 0 0 1-.356-1.301c.029-.837.403-1.437.625-1.897.111-.23.191-.433.236-.583.045-.15.044-.25.046-.24-.005-.029-.127-.355-1.015-.741-1.138-.495-2.322-.673-3.533-.668h-.015a9.711 9.711 0 0 0-.521.016h-.002c-1.163.057-2.35.308-3.541.569.383 1.531.79 2.753.818 4.502-.096 1.297.158 2.114-1.03 2.935-.85.588-1.508.729-2.15.335" style="fill:#282828;fill-opacity:1;stroke:none;stroke-width:1.03763;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" transform="translate(-40.698 -95.175)"/>
              <path d="M61.472 101.34v.002c-.3-.003-.603.01-.894.04-.544.055-1.39.165-1.778.306-1.238.364.13 2.344.41 2.913.28.569.285 2.03.14 2.134-.144.103-.375.261-.934.345-.56.084.03-.037-1.589.086-1.62.122-5.506.29-8.265.248-.022.26-.036.521-.097.808-.309 1.442-.63 3.163-.494 4.074.071.473.168.65.414.8.23.14.737.235 1.62-.004.834-.227 1.3-.442 1.887-.456.595-.016 1.555.472 1.965.717.411.245-.03-.008.002 0s.128.05.176.102c.049.053-.276-.523.104.199.379.721.72 3.256.002 4.68-.46.913-1.01 1.49-1.64 1.711-.63.22-1.229.067-1.734-.135-.881-.353-1.584-.7-2.205-.647-1.199 1.94-1.186 4.17-.6 6.602.097.397.212.814.327 1.23 2.68-.556 5.542-1.016 8.337.132 1.064.437 1.73 1.015 1.902 1.857.169.831-.193 1.508-.438 1.986-.122.238-.23.46-.307.642-.07.164-.096.28-.104.324.069.429.309.723.686.945.385.227.89.355 1.35.423.723.104 1.567.152 2.287.086.693-.064 1.032-.338 1.241-.544a2.447 2.447 0 0 0 .303-.437.175.175 0 0 0 .013-.035c-.004-.066-.037-.246-.195-.527-.46-.816-.87-1.595-.817-2.51.028-.476.218-.938.529-1.288.304-.343.698-.586 1.186-.79 1.442-.606 2.96-.609 4.372-.409 1.525.216 2.963.679 4.378 1.083.226-2.09.784-3.9.592-5.77-.058-.565-.287-1.333-.598-1.827-.32-.508-.59-.717-1.036-.642-.648.11-1.472.935-2.707 1.078-.791.092-1.494-.267-1.95-.86-.45-.583-.678-1.335-.78-2.101-.202-1.525.031-3.229.89-4.27.615-.747 1.45-.887 2.15-.74.687.145 1.307.492 1.857.745v-.002c.546.252 1.033.388 1.281.344a.547.547 0 0 0 .353-.188c.113-.124.242-.35.384-.75.604-1.712.206-3.68-.303-5.654-.667.145-1.336.293-2.018.413-1.341.236-2.73.392-4.136.273-.656-.055-1.695-.085-2.58-.476-.442-.195-.903-.514-1.157-1.093-.259-.591-.205-1.313.08-2.014.223-.64 1.082-2.178.692-2.585-.391-.407-1.651-.56-2.554-.571z" style="fill:#282828;fill-opacity:1;stroke:none;stroke-width:.992837;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" transform="translate(-40.698 -95.175)"/>
              <path d="M83.128 98.116c-.484 1.875-1.057 3.757-2.486 5.033-.638.57-1.13.666-1.483.548-.401-.134-.715-.506-1.058-.973-.338-.461-.655-.97-1.076-1.332-.192-.165-.404-.315-.683-.38-.279-.066-.599-.02-.9.102-.489.196-.89.58-1.28 1.047a6.1 6.1 0 0 0-.985 1.632c-.234.591-.356 1.174-.277 1.713.072.487.392.977.905 1.185.463.187.926.156 1.36.154.433 0 .843.01 1.242.147.55.189.79.736.822 1.368.034.66-.145 1.412-.393 1.988l-.008.021c-.74 1.705-1.946 2.893-3.004 4.349l-.664.915.979.099c.924.092 1.788.26 2.468.675.46.281 1.806 1.205 2.794 2.222.497.513.888 1.031 1.047 1.502.078.231.095.422.05.6a.93.93 0 0 1-.345.474c-.301.223-.606.395-.864.532l-.354.186c-.107.058-.189.087-.345.228a.637.637 0 0 1 .062-.045l-.064.041-.209.236-.103.343s.003.126.007.152c.003.017.003.007.004.015v.002c.016.195.061.307.133.476a4.1 4.1 0 0 0 .32.596 5.7 5.7 0 0 0 2.8 2.258c.284.108.908.321 1.548.36.33.02.59.015.912-.13h.002c.08-.037.228-.095.382-.281.153-.186.19-.355.212-.445l.019-.075.003-.078c.023-.585-.037-1.296.072-1.899.153-.657.435-.956 1.009-.909 2.771.239 4.74 1.955 6.693 3.83l.742.714.279-1.155c.55-2.29 1.093-4.464 2.928-5.977.692-.57 1.184-.642 1.527-.509.39.151.676.536.996.995.319.458.605.926 1.07 1.212.194.119.464.232.784.209.32-.024.638-.163.988-.384 1.022-.645 1.778-1.756 2.086-2.942.136-.522.102-.991-.046-1.301-.158-.334-.433-.553-.754-.707-.653-.314-1.468-.373-2.094-.486-.825-.15-1.22-.475-1.345-.878-.13-.417 0-.953.335-1.61.6-1.173 1.887-2.602 3.13-3.911l.498-.526-.449-.432c-1.545-1.49-3.163-3.01-5.252-3.715h-.002c-.473-.16-1.097-.413-1.73-.424h-.003c-.311-.004-.596.04-.883.24v.002c-.22.155-.483.537-.583.937l-.008.036-.006.038c-.116.773-.06 1.467-.217 1.995-.063.212-.198.418-.359.507-.202.111-.492.153-.976.072-.582-.097-1.978-.69-3.021-1.503-.523-.407-.934-.85-1.117-1.3a1.153 1.153 0 0 1-.083-.63c.03-.184.1-.477.308-.593.21-.116.941-.32 1.377-.642h.002c.192-.141.403-.367.518-.64.114-.275.127-.526.123-.774-.006-.142-.036-.192-.08-.3a8.417 8.417 0 0 0-3-3.027c-1.226-.725-2.585-1.135-3.927-1.539-.434-.12-.844-.111-1.02.466zm.912.947c1.186.364 2.357.718 3.345 1.303 1.035.612 1.864 1.488 2.507 2.528-.514.263-1.095.5-1.44.79-.345.29-.729.914-.815 1.434-.084.509 0 .968.155 1.347.301.74.85 1.276 1.44 1.735 1.18.92 2.554 1.545 3.47 1.698.604.1 1.186.088 1.739-.216.594-.327.935-.911 1.088-1.427.264-.884.193-1.664.262-2.17h.1c.3.006.926.206 1.417.371 1.646.554 3.044 1.773 4.431 3.089-1.102 1.174-2.222 2.423-2.888 3.73-.42.823-.73 1.789-.453 2.687.283.913 1.1 1.415 2.138 1.603.691.126 1.472.226 1.84.403.19.091.258.182.278.223.03.064.058.075-.023.387-.21.804-.761 1.598-1.413 2.01-.247.155-.365.183-.407.187-.042.003-.061.002-.172-.066-.144-.088-.455-.473-.772-.929-.317-.454-.714-1.07-1.452-1.356-.783-.304-1.776-.022-2.713.75-1.942 1.6-2.626 3.764-3.146 5.8-1.802-1.676-3.772-3.138-6.589-3.517h-.002c-.346-.095-1.013-.031-1.293.143-.735.501-1.005 1.132-1.168 2.007-.125.69-.082 1.216-.074 1.659-.055.006-.046.01-.104.006-.42-.026-1.035-.215-1.244-.295-.947-.361-1.774-1.006-2.314-1.857-.054-.085-.072-.132-.109-.2l.027-.016c.284-.15.656-.36 1.045-.648.44-.327.789-.798.93-1.35a2.4 2.4 0 0 0-.068-1.379c-.254-.751-.753-1.353-1.295-1.911-1.09-1.124-2.452-2.049-2.99-2.378-.609-.372-1.303-.44-1.981-.56.875-1.094 1.878-2.251 2.596-3.921.294-.823.543-1.907.513-2.658-.049-.97-.489-2.013-1.52-2.367-.579-.2-1.131-.204-1.58-.203-.45.002-.786-.006-.97-.08h-.002c-.264-.107-.236-.108-.268-.33-.025-.17.021-.553.183-.962a4.67 4.67 0 0 1 .725-1.192c.29-.348.617-.59.705-.626.142-.057.176-.05.22-.04.045.011.127.052.263.17.235.201.56.671.92 1.161.354.484.791 1.08 1.543 1.33.8.267 1.784-.052 2.671-.846 1.594-1.424 2.235-3.317 2.714-5.051zm11.705 7.023c-.02.014.042-.002.042 0l-.008.035c.05-.2-.028-.04-.034-.035zM79.472 122.45a.198.198 0 0 1 .005.023v.014c-.002-.01-.003-.03-.005-.037zm-.29.732-.006.01-.044.027c.016-.01.033-.024.05-.036z" style="color:#000;fill:#282828;stroke-width:1.02352;-inkscape-stroke:none" transform="translate(-40.698 -95.175)"/>
              <path d="M76.694 128.845c-.85-.012-1.668.253-2.434.67-.01.592-.015 1.17.109 1.772.323 1.573.422 3.553-.07 5.147-.247.804-.684 1.535-1.347 1.891-.663.356-1.467.296-2.362-.159-.522-.266-1.059-.62-1.487-.757-.223-.072-.392-.096-.522-.069-.13.027-.232.094-.362.27-.53.719-.681 1.823-.497 2.876.177 1.012.418 1.438.543 1.56.143.137.26.154.604.055.548-.158 1.523-.857 2.573-.972l.02-.002.5.058c.686.081 1.247.562 1.622 1.19.372.62.591 1.37.73 2.136.279 1.532.25 3.16.083 4.232-.14.91-.394 1.72-.632 2.53 1.719-.385 3.485-.692 5.307-.36 1.174.214 2.749.574 3.762 1.977l.088.122.046.159c.162.551.16 1.114.024 1.578-.13.45-.348.772-.533 1.023-.181.246-.336.444-.437.606-.102.16-.141.275-.145.336-.01.17 0 .197.07.315.057.1.186.242.39.366.408.246 1.106.414 1.843.45a7.842 7.842 0 0 0 2.174-.21 4.28 4.28 0 0 0 .822-.296c.218-.106.385-.242.377-.233l.029-.031c.025-.035.05-.072.05-.068 0-.004 0-.017-.003-.05a2.733 2.733 0 0 0-.21-.579c-.26-.548-.839-1.333-.822-2.46.01-.657.27-1.21.598-1.576.32-.357.696-.575 1.074-.736.759-.323 1.57-.418 2.054-.458 1.653-.136 3.252.296 4.755.765.457.142.905.29 1.352.434.325-2.258.902-4.247.598-6.217-.071-.46-.25-1.169-.486-1.684-.238-.518-.495-.762-.675-.779-.351-.032-.716.14-1.174.418-.457.277-1.005.665-1.695.742-.745.082-1.406-.291-1.84-.908-.428-.608-.653-1.394-.754-2.196-.203-1.596.016-3.377.794-4.493.568-.813 1.358-.984 2.024-.835.65.146 1.243.51 1.769.779.524.267.99.413 1.237.365a.527.527 0 0 0 .346-.2c.11-.132.235-.373.37-.798.612-1.918.27-3.894-.246-6.054-2.815-.851-5.49-1.534-8.089-.267a.727.727 0 0 0-.223.148c-.024.028-.018.021-.026.056.001-.003-.01.178.07.44.162.522.611 1.29.911 1.978l.004.009.029.063.024.084V133c.162.635.016 1.297-.274 1.727-.272.404-.618.636-.952.81-.675.353-1.399.484-1.724.533a5.888 5.888 0 0 1-3.973-.795c-.512-.311-.876-.594-1.133-1.02-.282-.466-.318-1.084-.172-1.557.252-.814.715-1.266.971-1.89a.663.663 0 0 0 .047-.14c.001-.013 0-.006-.007-.037a.761.761 0 0 0-.184-.268c-.264-.267-.865-.595-1.54-.826-1.356-.462-3.07-.659-3.583-.686-.062-.002-.121-.006-.178-.006z" style="fill:#282828;fill-opacity:1;stroke:none;stroke-width:.991342;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" transform="translate(-40.698 -95.175)"/>
            </svg>
            Relearn
          </a>
        </div>
        <div class="searchbox default-animation">
          <label for="search-by"><i class="fas fa-search"></i></label>
          <input data-search-input id="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1671729343" defer></script>
        <script src="/js/lunr.min.js?1671729343" defer></script>
        <script src="/js/lunr.stemmer.support.min.js?1671729343" defer></script>
        <script src="/js/lunr.multi.min.js?1671729343" defer></script>
        <script src="/js/lunr.en.min.js?1671729343" defer></script>
        <script src="/js/search.js?1671729343" defer></script>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics collapsible-menu">
          <li data-nav-id="/dockerk8s/" title="docker&amp;k8s" class="dd-item"><input type="checkbox" id="section-9e6e410ba0e302767b2ea4fda732470d" class="toggle"/><label for="section-9e6e410ba0e302767b2ea4fda732470d" ></label><a href="/dockerk8s/">docker&amp;k8s<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/dockerk8s/docker-compose/" title="docker compose" class="dd-item"><a href="/dockerk8s/docker-compose/">docker compose<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dockerk8s/docker%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="docker基础知识" class="dd-item"><a href="/dockerk8s/docker%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">docker基础知识<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dockerk8s/docker%E8%AE%BE%E7%BD%AE/" title="docker设置" class="dd-item"><a href="/dockerk8s/docker%E8%AE%BE%E7%BD%AE/">docker设置<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/excalidraw/" title="Excalidraw" class="dd-item"><a href="/excalidraw/">Excalidraw<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/golang/" title="golang" class="dd-item"><a href="/golang/">golang<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/interview/" title="interview" class="dd-item"><input type="checkbox" id="section-a64fd7a039e11bfc320164f9c76fa09b" class="toggle"/><label for="section-a64fd7a039e11bfc320164f9c76fa09b" ></label><a href="/interview/">interview<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/interview/%E7%AE%80%E5%8E%86/" title="简历" class="dd-item"><a href="/interview/%E7%AE%80%E5%8E%86/">简历<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/interview/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/" title="面试题整理" class="dd-item"><a href="/interview/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/">面试题整理<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/java/" title="java" class="dd-item"><input type="checkbox" id="section-518f725d76ef42edca45fe01865b4d20" class="toggle"/><label for="section-518f725d76ef42edca45fe01865b4d20" ></label><a href="/java/">java<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/java/classpath/" title="classpath" class="dd-item"><a href="/java/classpath/">classpath<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/java%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/" title="java的引用类型" class="dd-item"><a href="/java/java%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/">java的引用类型<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jsr/" title="JSR" class="dd-item"><a href="/java/jsr/">JSR<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/" title="jvm" class="dd-item alwaysopen"><input type="checkbox" id="section-8bb18590038df95f5ce669688bf7139d" class="toggle" checked/><label for="section-8bb18590038df95f5ce669688bf7139d" ></label><a href="/java/jvm/">jvm<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/java/jvm/gc%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" title="gc日志分析" class="dd-item"><a href="/java/jvm/gc%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/">gc日志分析<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/java%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0/" title="java启动参数" class="dd-item"><a href="/java/jvm/java%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0/">java启动参数<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/java%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%90%AF%E5%8A%A8/" title="java程序的启动" class="dd-item"><a href="/java/jvm/java%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%90%AF%E5%8A%A8/">java程序的启动<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/jvm%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90/" title="jvm内存分析：" class="dd-item"><a href="/java/jvm/jvm%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90/">jvm内存分析：<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/tlab%E6%A0%88%E4%B8%8A%E5%88%86%E9%85%8D/" title="TLAB&amp;栈上分配" class="dd-item"><a href="/java/jvm/tlab%E6%A0%88%E4%B8%8A%E5%88%86%E9%85%8D/">TLAB&amp;栈上分配<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/jvm/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="类加载" class="dd-item"><a href="/java/jvm/%E7%B1%BB%E5%8A%A0%E8%BD%BD/">类加载<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/java/lib/" title="lib" class="dd-item alwaysopen"><input type="checkbox" id="section-3d385f71e2cc44b77d754be95cf76a3f" class="toggle" checked/><label for="section-3d385f71e2cc44b77d754be95cf76a3f" ></label><a href="/java/lib/">lib<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/java/lib/cglib/" title="cglib" class="dd-item"><a href="/java/lib/cglib/">cglib<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/lib/hibernate-validator-%E6%A0%A1%E9%AA%8C%E5%99%A8/" title="hibernate-validator 校验器" class="dd-item"><a href="/java/lib/hibernate-validator-%E6%A0%A1%E9%AA%8C%E5%99%A8/">hibernate-validator 校验器<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/lib/mapstruct-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E7%9A%84bean%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/" title="MapStruct-类型安全的bean转换工具" class="dd-item"><a href="/java/lib/mapstruct-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E7%9A%84bean%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/">MapStruct-类型安全的bean转换工具<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/java/meta-inf%E5%92%8Cweb-info/" title="META-INF和WEB-INFO" class="dd-item"><a href="/java/meta-inf%E5%92%8Cweb-info/">META-INF和WEB-INFO<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/" title="内存结构" class="dd-item"><a href="/java/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/">内存结构<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" title="并发编程" class="dd-item alwaysopen"><input type="checkbox" id="section-2b723ede4bb374cbc0cbba9e311b6f2f" class="toggle" checked/><label for="section-2b723ede4bb374cbc0cbba9e311b6f2f" ></label><a href="/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">并发编程<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/futurecompletablefuture/" title="Future、CompletableFuture" class="dd-item"><a href="/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/futurecompletablefuture/">Future、CompletableFuture<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/java/%E6%B3%A8%E9%87%8A/" title="注释" class="dd-item"><a href="/java/%E6%B3%A8%E9%87%8A/">注释<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/office/" title="office" class="dd-item"><input type="checkbox" id="section-98530a8654fbed228aee60cd5d89d452" class="toggle"/><label for="section-98530a8654fbed228aee60cd5d89d452" ></label><a href="/office/">office<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/office/excel%E5%85%AC%E5%BC%8F/" title="excel公式" class="dd-item"><a href="/office/excel%E5%85%AC%E5%BC%8F/">excel公式<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/python/" title="python" class="dd-item"><input type="checkbox" id="section-c8861a2651b27ee3930a98ce392020d1" class="toggle"/><label for="section-c8861a2651b27ee3930a98ce392020d1" ></label><a href="/python/">python<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/python/python%E8%AF%AD%E6%B3%95%E7%9F%A5%E8%AF%86/" title="python语法知识" class="dd-item"><a href="/python/python%E8%AF%AD%E6%B3%95%E7%9F%A5%E8%AF%86/">python语法知识<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/python/%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86/" title="时间处理" class="dd-item"><a href="/python/%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86/">时间处理<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/python/%E7%BB%98%E5%9B%BE%E5%BA%93matplotlib/" title="绘图库matplotlib" class="dd-item"><a href="/python/%E7%BB%98%E5%9B%BE%E5%BA%93matplotlib/">绘图库matplotlib<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/spring/" title="spring" class="dd-item"><input type="checkbox" id="section-6be3a103036efc21a988ae839ac63e32" class="toggle"/><label for="section-6be3a103036efc21a988ae839ac63e32" ></label><a href="/spring/">spring<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/spring/configuration/" title="@Configuration" class="dd-item"><a href="/spring/configuration/">@Configuration<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/aop/" title="aop" class="dd-item alwaysopen"><input type="checkbox" id="section-3f940e089bb0d22138400443ef5737ed" class="toggle" checked/><label for="section-3f940e089bb0d22138400443ef5737ed" ></label><a href="/spring/aop/">aop<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/spring/aop/aop%E4%BD%BF%E7%94%A8/" title="AOP使用" class="dd-item"><a href="/spring/aop/aop%E4%BD%BF%E7%94%A8/">AOP使用<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/spring/mvc/" title="mvc" class="dd-item alwaysopen"><input type="checkbox" id="section-f7eab8a11f97ffd0873d29e8e6991aa8" class="toggle" checked/><label for="section-f7eab8a11f97ffd0873d29e8e6991aa8" ></label><a href="/spring/mvc/">mvc<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/spring/mvc/%E5%BC%82%E6%AD%A5%E6%A8%A1%E5%BC%8F/" title="异步模式" class="dd-item"><a href="/spring/mvc/%E5%BC%82%E6%AD%A5%E6%A8%A1%E5%BC%8F/">异步模式<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/spring/spring-bean/" title="spring bean" class="dd-item"><a href="/spring/spring-bean/">spring bean<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/spring-cache/" title="Spring cache" class="dd-item"><a href="/spring/spring-cache/">Spring cache<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/spring-context/" title="spring Context" class="dd-item"><a href="/spring/spring-context/">spring Context<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/spring-mvc/" title="spring mvc" class="dd-item"><a href="/spring/spring-mvc/">spring mvc<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/springboot/" title="springboot" class="dd-item alwaysopen"><input type="checkbox" id="section-d2c9d1492d2be5f58a95b0e575fe9ac4" class="toggle" checked/><label for="section-d2c9d1492d2be5f58a95b0e575fe9ac4" ></label><a href="/spring/springboot/">springboot<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/spring/springboot/%E4%B8%BA%E4%BB%80%E4%B9%88springboot%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C-jar-%E5%8C%85/" title="为什么SpringBoot可以直接运行 jar 包？" class="dd-item"><a href="/spring/springboot/%E4%B8%BA%E4%BB%80%E4%B9%88springboot%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C-jar-%E5%8C%85/">为什么SpringBoot可以直接运行 jar 包？<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/springboot/%E5%90%AF%E5%8A%A8/" title="启动" class="dd-item"><a href="/spring/springboot/%E5%90%AF%E5%8A%A8/">启动<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/springboot/%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE/" title="自动配置" class="dd-item"><a href="/spring/springboot/%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE/">自动配置<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/spring/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="单元测试" class="dd-item"><a href="/spring/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">单元测试<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/spring/%E6%9D%A1%E4%BB%B6%E5%8A%A0%E8%BD%BD/" title="条件加载" class="dd-item"><a href="/spring/%E6%9D%A1%E4%BB%B6%E5%8A%A0%E8%BD%BD/">条件加载<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/" title="中间件" class="dd-item"><input type="checkbox" id="section-cb147f28999e2af77c3c46e5203c4ebe" class="toggle"/><label for="section-cb147f28999e2af77c3c46e5203c4ebe" ></label><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/" title="kafka" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/">kafka<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/mysql/" title="mysql" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/mysql/">mysql<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/" title="redis" class="dd-item alwaysopen"><input type="checkbox" id="section-74f1b75570b4ee251a87b9e00cbf3144" class="toggle" checked/><label for="section-74f1b75570b4ee251a87b9e00cbf3144" ></label><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/">redis<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/redis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="redis基础知识" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/redis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">redis基础知识<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/" title="布隆过滤器" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/">布隆过滤器<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F/" title="缓存雪崩、缓存击穿、缓存穿透" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F/">缓存雪崩、缓存击穿、缓存穿透<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/" title="rocketmq" class="dd-item alwaysopen"><input type="checkbox" id="section-ce3034db624a906c4bed91371ab24f78" class="toggle" checked/><label for="section-ce3034db624a906c4bed91371ab24f78" ></label><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/">rocketmq<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/rocketmq%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" title="rocketmq基本概念" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/rocketmq%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">rocketmq基本概念<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/" title="RocketMQ" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/">RocketMQ<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%AE%9A%E4%B9%89/" title="中间件的定义" class="dd-item"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%AE%9A%E4%B9%89/">中间件的定义<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分布式" class="dd-item"><input type="checkbox" id="section-4c00b6b934bcc78dd785b986be43672c" class="toggle"/><label for="section-4c00b6b934bcc78dd785b986be43672c" ></label><a href="/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E5%88%86%E5%B8%83%E5%BC%8F/dubbo/" title="dubbo" class="dd-item"><a href="/%E5%88%86%E5%B8%83%E5%BC%8F/dubbo/">dubbo<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%88%86%E5%B8%83%E5%BC%8F/zookeeper/" title="zookeeper" class="dd-item"><a href="/%E5%88%86%E5%B8%83%E5%BC%8F/zookeeper/">zookeeper<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式事务" class="dd-item"><a href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/">分布式事务<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95/" title="分布式算法" class="dd-item"><a href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95/">分布式算法<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/" title="工具" class="dd-item"><input type="checkbox" id="section-70bdf8d87af46a79686d31378c1d7d85" class="toggle"/><label for="section-70bdf8d87af46a79686d31378c1d7d85" ></label><a href="/%E5%B7%A5%E5%85%B7/">工具<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/arthas/" title="arthas" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/arthas/">arthas<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/git/" title="git" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/git/">git<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/idea/" title="idea" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/idea/">idea<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/iredis/" title="iredis" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/iredis/">iredis<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/jmeter/" title="jmeter" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/jmeter/">jmeter<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/markdown/" title="markdown" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/markdown/">markdown<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E5%B7%A5%E5%85%B7/maven/" title="maven" class="dd-item"><a href="/%E5%B7%A5%E5%85%B7/maven/">maven<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统" class="dd-item"><input type="checkbox" id="section-be882d7838b29bb55035a73606bd5fad" class="toggle"/><label for="section-be882d7838b29bb55035a73606bd5fad" ></label><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/" title="linux" class="dd-item alwaysopen"><input type="checkbox" id="section-2b529531ed5b88a2a39fe109a71784e2" class="toggle" checked/><label for="section-2b529531ed5b88a2a39fe109a71784e2" ></label><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/">linux<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/linux%E5%B7%A5%E5%85%B7/" title="linux工具" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/linux%E5%B7%A5%E5%85%B7/">linux工具<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/linux%E7%9B%AE%E5%BD%95/" title="linux目录" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/linux%E7%9B%AE%E5%BD%95/">linux目录<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/shell/" title="shell" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/shell/">shell<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/ssh/" title="SSH" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/ssh/">SSH<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%90%AF%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC/" title="启动执行脚本" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%90%AF%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC/">启动执行脚本<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%91%BD%E4%BB%A4%E7%BB%84%E5%90%88/" title="命令组合" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%91%BD%E4%BB%A4%E7%BB%84%E5%90%88/">命令组合<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%A6%82%E4%BD%95%E5%8C%BA%E5%88%86terminalttyconsoleshell/" title="如何区分terminal、tty、console、shell" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E5%A6%82%E4%BD%95%E5%8C%BA%E5%88%86terminalttyconsoleshell/">如何区分terminal、tty、console、shell<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3/" title="文件相关" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3/">文件相关<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E6%96%87%E6%9C%AC%E7%9B%B8%E5%85%B3/" title="文本相关" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E6%96%87%E6%9C%AC%E7%9B%B8%E5%85%B3/">文本相关<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3/" title="用户相关" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3/">用户相关<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4/" title="系统监控命令" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4/">系统监控命令<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E9%9B%B6%E6%8B%B7%E8%B4%9D/" title="零拷贝" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/%E9%9B%B6%E6%8B%B7%E8%B4%9D/">零拷贝<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统" class="dd-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="数据库" class="dd-item"><input type="checkbox" id="section-53a8c433a58ab5235aeb30d0814c96c0" class="toggle"/><label for="section-53a8c433a58ab5235aeb30d0814c96c0" ></label><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" title="mysql" class="dd-item alwaysopen"><input type="checkbox" id="section-a2fa9ec52e816aafa503e80add11c1d3" class="toggle" checked/><label for="section-a2fa9ec52e816aafa503e80add11c1d3" ></label><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/">mysql<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F/" title="三大范式" class="dd-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F/">三大范式<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E9%A2%84%E5%A4%84%E7%90%86/" title="预处理" class="dd-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E9%A2%84%E5%A4%84%E7%90%86/">预处理<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E4%BA%8B%E5%8A%A1/" title="事务" class="dd-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E4%BA%8B%E5%8A%A1/">事务<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1/" title="全局事务" class="dd-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1/">全局事务<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1/" title="本地事务" class="dd-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1/">本地事务<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/" title="杂项" class="dd-item"><input type="checkbox" id="section-1fc5dd88192fdf757cc49ccd8acec8eb" class="toggle"/><label for="section-1fc5dd88192fdf757cc49ccd8acec8eb" ></label><a href="/%E6%9D%82%E9%A1%B9/">杂项<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/java%E6%97%A5%E5%BF%97/" title="java日志" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/java%E6%97%A5%E5%BF%97/">java日志<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/log4j%E6%BC%8F%E6%B4%9E/" title="log4j漏洞" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/log4j%E6%BC%8F%E6%B4%9E/">log4j漏洞<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/slf4j/" title="slf4j" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/slf4j/">slf4j<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/url%E5%92%8Curi/" title="URL和URI" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/url%E5%92%8Curi/">URL和URI<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/xss%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/" title="XSS跨站脚本攻击" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/xss%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/">XSS跨站脚本攻击<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/yaml/" title="yaml" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/yaml/">yaml<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/%E5%A4%A7%E6%A6%82%E5%BF%B5/" title="大概念" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/%E5%A4%A7%E6%A6%82%E5%BF%B5/">大概念<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B0%8F%E7%9F%A5%E8%AF%86/" title="奇怪的小知识" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B0%8F%E7%9F%A5%E8%AF%86/">奇怪的小知识<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/%E5%A5%BD%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/" title="好用的网站" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/%E5%A5%BD%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/">好用的网站<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/%E5%BE%AE%E4%BF%A1%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95/" title="微信授权登录" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/%E5%BE%AE%E4%BF%A1%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95/">微信授权登录<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E6%9D%82%E9%A1%B9/%E9%AB%98%E6%95%88%E5%BC%80%E5%8F%91/" title="高效开发" class="dd-item"><a href="/%E6%9D%82%E9%A1%B9/%E9%AB%98%E6%95%88%E5%BC%80%E5%8F%91/">高效开发<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E7%A1%AC%E4%BB%B6/" title="硬件" class="dd-item"><input type="checkbox" id="section-b8b348e07d2dcb672567e1108b1397e0" class="toggle"/><label for="section-b8b348e07d2dcb672567e1108b1397e0" ></label><a href="/%E7%A1%AC%E4%BB%B6/">硬件<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E7%A1%AC%E4%BB%B6/dma/" title="DMA" class="dd-item"><a href="/%E7%A1%AC%E4%BB%B6/dma/">DMA<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%A1%AC%E4%BB%B6/%E5%8D%95%E5%B7%A5%E5%8D%8A%E5%8F%8C%E5%B7%A5%E5%85%A8%E5%8F%8C%E5%B7%A5/" title="单工、半双工、全双工" class="dd-item"><a href="/%E7%A1%AC%E4%BB%B6/%E5%8D%95%E5%B7%A5%E5%8D%8A%E5%8F%8C%E5%B7%A5%E5%85%A8%E5%8F%8C%E5%B7%A5/">单工、半双工、全双工<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%A1%AC%E4%BB%B6/%E5%8D%97%E5%8C%97%E6%A1%A5/" title="南北桥" class="dd-item"><a href="/%E7%A1%AC%E4%BB%B6/%E5%8D%97%E5%8C%97%E6%A1%A5/">南北桥<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="算法&amp;数据结构" class="dd-item"><input type="checkbox" id="section-ea3f888852a9a69494bd4d6a8264138b" class="toggle"/><label for="section-ea3f888852a9a69494bd4d6a8264138b" ></label><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">算法&amp;数据结构<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/" title="leetcode经典100题" class="dd-item alwaysopen"><input type="checkbox" id="section-ec1de6d2a483991439da6caecd8592bc" class="toggle" checked/><label for="section-ec1de6d2a483991439da6caecd8592bc" ></label><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/">leetcode经典100题<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/1.%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/" title="1.两数之和" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/1.%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/">1.两数之和<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/136.%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97/" title="136.只出现一次的数字" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/136.%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97/">136.只出现一次的数字<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/20.%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7/" title="20.有效的括号" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/20.%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7/">20.有效的括号<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/21.%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8/" title="21.合并两个有序链表" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/21.%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8/">21.合并两个有序链表<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/22.%E6%8B%AC%E5%8F%B7%E7%94%9F%E6%88%90/" title="22.括号生成" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/22.%E6%8B%AC%E5%8F%B7%E7%94%9F%E6%88%90/">22.括号生成<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/26.%E5%88%A0%E9%99%A4%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/" title="26.删除有序数组中的重复项" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/26.%E5%88%A0%E9%99%A4%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/">26.删除有序数组中的重复项<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/300.-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/" title="300. 最长递增子序列" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/300.-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/">300. 最长递增子序列<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/70.%E7%88%AC%E6%A5%BC%E6%A2%AF/" title="70.爬楼梯" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/70.%E7%88%AC%E6%A5%BC%E6%A2%AF/">70.爬楼梯<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E7%9B%AE%E5%BD%95/" title="经典算法目录" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/leetcode%E7%BB%8F%E5%85%B8100%E9%A2%98/%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E7%9B%AE%E5%BD%95/">经典算法目录<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/lru/" title="LRU" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/lru/">LRU<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" title="动态规划" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8/" title="双向链表" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8/">双向链表<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8F%8C%E6%8C%87%E9%92%88/" title="双指针" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8F%8C%E6%8C%87%E9%92%88/">双指针<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%9E%E6%BA%AFdfs/" title="回溯（DFS）" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%9E%E6%BA%AFdfs/">回溯（DFS）<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" title="基本概念" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">基本概念<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B8%B8%E8%A7%81%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/" title="常见限流算法" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B8%B8%E8%A7%81%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/">常见限流算法<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88bfs/" title="广度优先（BFS）" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88bfs/">广度优先（BFS）<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F/" title="排序" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F/">排序<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B4%A0%E6%95%B0%E8%AE%A1%E7%AE%97/" title="素数计算" class="dd-item"><a href="/%E7%AE%97%E6%B3%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B4%A0%E6%95%B0%E8%AE%A1%E7%AE%97/">素数计算<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/" title="类库&amp;框架" class="dd-item"><input type="checkbox" id="section-9e39b3b4fefa7d842b69d6dfea148f3f" class="toggle"/><label for="section-9e39b3b4fefa7d842b69d6dfea148f3f" ></label><a href="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/">类库&amp;框架<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/mybatis/" title="mybatis" class="dd-item"><a href="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/mybatis/">mybatis<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/sentinel/" title="sentinel" class="dd-item"><a href="/%E7%B1%BB%E5%BA%93%E6%A1%86%E6%9E%B6/sentinel/">sentinel<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/" title="胡诌八扯大道理" class="dd-item"><input type="checkbox" id="section-ffb623bb597c059aaedef526016a8213" class="toggle"/><label for="section-ffb623bb597c059aaedef526016a8213" ></label><a href="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/">胡诌八扯大道理<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E4%BA%BA%E7%94%9F%E5%9B%9B%E9%97%AE/" title="人生四问" class="dd-item"><a href="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E4%BA%BA%E7%94%9F%E5%9B%9B%E9%97%AE/">人生四问<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E4%BA%BA%E7%94%9F%E5%A4%A7%E9%81%93%E7%90%86/" title="人生大道理" class="dd-item"><a href="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E4%BA%BA%E7%94%9F%E5%A4%A7%E9%81%93%E7%90%86/">人生大道理<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E9%AB%98%E6%95%88%E4%BA%BA%E7%94%9F/" title="高效人生" class="dd-item"><a href="/%E8%83%A1%E8%AF%8C%E5%85%AB%E6%89%AF%E5%A4%A7%E9%81%93%E7%90%86/%E9%AB%98%E6%95%88%E4%BA%BA%E7%94%9F/">高效人生<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="解决方案" class="dd-item"><input type="checkbox" id="section-a17bc74d6fddbc1ede8fbe5263306182" class="toggle"/><label for="section-a17bc74d6fddbc1ede8fbe5263306182" ></label><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">解决方案<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/ddd-domain-driven-design/" title="DDD Domain-Driven Design" class="dd-item"><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/ddd-domain-driven-design/">DDD Domain-Driven Design<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%88%86%E9%A1%B5%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E6%88%96%E8%80%85%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98/" title="分页数据丢失或者重复问题" class="dd-item"><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%88%86%E9%A1%B5%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E6%88%96%E8%80%85%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98/">分页数据丢失或者重复问题<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/" title="权限控制" class="dd-item alwaysopen"><input type="checkbox" id="section-70e62bcc9295a91257e2a24216fda309" class="toggle" checked/><label for="section-70e62bcc9295a91257e2a24216fda309" ></label><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">权限控制<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/ldap-%E8%BD%BB%E9%87%8F%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE/" title="ldap-轻量目录访问协议" class="dd-item"><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/ldap-%E8%BD%BB%E9%87%8F%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE/">ldap-轻量目录访问协议<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%B1%BB%E5%BE%AE%E5%8D%9Afeed%E6%B5%81/" title="类微博feed流" class="dd-item"><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%B1%BB%E5%BE%AE%E5%8D%9Afeed%E6%B5%81/">类微博feed流<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%99%90%E6%B5%81/" title="限流" class="dd-item"><a href="/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%99%90%E6%B5%81/">限流<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="计算机基础" class="dd-item"><input type="checkbox" id="section-66587d924bf701bc016810d7143bf85d" class="toggle"/><label for="section-66587d924bf701bc016810d7143bf85d" ></label><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/http/" title="HTTP" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/http/">HTTP<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/https/" title="HTTPS" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/https/">HTTPS<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/io%E7%9B%B8%E5%85%B3/" title="IO相关" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/io%E7%9B%B8%E5%85%B3/">IO相关<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/shell-%E7%9A%84login-shell%E4%B8%8Enon-login-shell/" title="shell 的login shell与non-login shell" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/shell-%E7%9A%84login-shell%E4%B8%8Enon-login-shell/">shell 的login shell与non-login shell<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/tcp-ip%E5%8D%8F%E8%AE%AE/" title="TCP IP协议" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/tcp-ip%E5%8D%8F%E8%AE%AE/">TCP IP协议<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%97%B6%E9%97%B4/" title="时间" class="dd-item"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%97%B6%E9%97%B4/">时间<i class="fas fa-check read-icon"></i></a></li></ul></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">More</div>
          <ul>
            <li><a class="padding" href="https://github.com/McShelby/hugo-theme-relearn"><i class='fab fa-fw fa-github'></i> GitHub repo</a></li>
            <li><a class="padding" href="/tags/"><i class='fas fa-fw fa-tags'></i> Tags</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"/>
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch">
              <a class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-language" onchange="location = baseUri + this.value;">
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch showVariantSwitch">
              <a class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="relearn-light" value="relearn-light" selected>Relearn Light</option>
                    <option id="relearn-dark" value="relearn-dark">Relearn Dark</option>
                    <option id="learn" value="learn">Learn</option>
                    <option id="neon" value="neon">Neon</option>
                    <option id="blue" value="blue">Blue</option>
                    <option id="green" value="green">Green</option>
                    <option id="red" value="red">Red</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><a class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Clear History</a></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
          <style>
            #footer {
              font-size: 13px;
              height: 100px;
              margin-left: auto;
              margin-right: auto;
              padding: 2rem 1rem;
              text-align: center;
              min-width: 230px;
              max-width: 300px;
            }
            #footer p {
              margin: 0;
            }
          </style>
          <a class="github-button" href="https://github.com/McShelby/hugo-theme-relearn/archive/main.zip" data-icon="octicon-cloud-download" aria-label="Download McShelby/hugo-theme-relearn on GitHub">Download</a>
          <a class="github-button" href="https://github.com/McShelby/hugo-theme-relearn" data-icon="octicon-star" data-show-count="true" aria-label="Star McShelby/hugo-theme-relearn on GitHub">Star</a>
          <a class="github-button" href="https://github.com/McShelby/hugo-theme-relearn/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork McShelby/hugo-theme-relearn on GitHub">Fork</a>
          <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          <script async src="/js/buttons.js?1671729343"></script>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1671729343" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1671729343" defer></script>
    <script src="/js/featherlight.min.js?1671729343" defer></script>
    <script src="/js/jquery.svg.pan.zoom.js?1671729343" defer></script>
    <script src="/js/mermaid.min.js?1671729343" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"securityLevel\": \"loose\" }");
    </script>
    <script src="/js/theme.js?1671729343" defer></script>
  </body>
</html>
